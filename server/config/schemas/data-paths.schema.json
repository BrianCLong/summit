{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OPA Data Path Tags",
  "type": "object",
  "properties": {
    "dataPaths": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1
          },
          "system": {
            "type": "string",
            "enum": ["maestro", "intelgraph", "companyos"]
          },
          "path": {
            "type": "string",
            "pattern": "^/v1/data/(maestro|intelgraph|companyos)/.+"
          },
          "description": {
            "type": "string",
            "minLength": 4
          },
          "tags": {
            "type": "array",
            "minItems": 2,
            "items": {
              "type": "string",
              "minLength": 1
            },
            "uniqueItems": true
          },
          "sources": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string",
              "minLength": 1
            },
            "uniqueItems": true
          }
        },
        "required": ["id", "system", "path", "tags"],
        "additionalProperties": false,
        "allOf": [
          {
            "if": {
              "properties": {"system": {"const": "maestro"}}
            },
            "then": {
              "properties": {
                "tags": {"contains": {"const": "maestro"}}
              }
            }
          },
          {
            "if": {
              "properties": {"system": {"const": "intelgraph"}}
            },
            "then": {
              "properties": {
                "tags": {"contains": {"const": "intelgraph"}}
              }
            }
          },
          {
            "if": {
              "properties": {"system": {"const": "companyos"}}
            },
            "then": {
              "properties": {
                "tags": {"contains": {"const": "companyos"}}
              }
            }
          }
        ]
      }
    }
  },
  "required": ["dataPaths"],
  "additionalProperties": false
}
