{
  "$id": "https://summit.dev/schemas/agent-budget-manifest",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Agent Budget Manifest",
  "description": "Deterministic resource budgets and risk ceilings for autonomous agents.",
  "type": "object",
  "required": [
    "$schema",
    "schemaVersion",
    "agentId",
    "owner",
    "description",
    "deterministicLimits",
    "risk",
    "telemetry"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://summit.dev/schemas/agent-budget-manifest.schema.json"
    },
    "schemaVersion": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },
    "agentId": {
      "type": "string",
      "pattern": "^[a-z0-9_-]+$"
    },
    "owner": {
      "type": "string",
      "minLength": 1
    },
    "description": {
      "type": "string",
      "minLength": 1
    },
    "deterministicLimits": {
      "type": "object",
      "required": [
        "maxTokens",
        "maxCallsPerRun",
        "maxWallClockMs",
        "maxConcurrentRuns",
        "maxDailyRuns",
        "maxNetworkKB"
      ],
      "properties": {
        "maxTokens": {
          "type": "integer",
          "minimum": 0
        },
        "maxCallsPerRun": {
          "type": "integer",
          "minimum": 1
        },
        "maxWallClockMs": {
          "type": "integer",
          "minimum": 1
        },
        "maxConcurrentRuns": {
          "type": "integer",
          "minimum": 1
        },
        "maxDailyRuns": {
          "type": "integer",
          "minimum": 1
        },
        "maxNetworkKB": {
          "type": "integer",
          "minimum": 0
        }
      },
      "additionalProperties": false
    },
    "risk": {
      "type": "object",
      "required": ["inherent", "controlBaseline", "residual", "riskTier", "riskCeiling"],
      "properties": {
        "inherent": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "controlBaseline": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "residual": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "riskTier": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"]
        },
        "riskCeiling": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10
        },
        "gates": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "telemetry": {
      "type": "object",
      "required": ["auditLogPath"],
      "properties": {
        "auditLogPath": {
          "type": "string",
          "minLength": 1
        },
        "emitBudgetEvents": {
          "type": "boolean"
        },
        "sampleRate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
