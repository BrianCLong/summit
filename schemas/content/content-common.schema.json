{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://summit.local/schemas/content/content-common.schema.json",
  "title": "Content Model Common Types",
  "type": "object",
  "$defs": {
    "id": {
      "type": "string",
      "minLength": 1,
      "pattern": "^[A-Za-z0-9._:-]+$"
    },
    "isoDateTime": {
      "type": "string",
      "format": "date-time"
    },
    "nonEmptyString": {
      "type": "string",
      "minLength": 1
    },
    "policyTag": {
      "type": "string",
      "minLength": 1
    },
    "securityLevel": {
      "type": "string",
      "enum": ["public", "internal", "confidential", "restricted", "export-controlled"]
    },
    "workItemRef": {
      "type": "object",
      "additionalProperties": false,
      "required": ["kind", "repo", "number", "state"],
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["issue", "pr", "workflow"]
        },
        "repo": {
          "type": "string",
          "minLength": 1
        },
        "number": {
          "type": "integer",
          "minimum": 1
        },
        "state": {
          "type": "string",
          "enum": ["open", "closed", "merged", "failed", "queued", "running", "blocked", "unknown"]
        }
      }
    },
    "sourceRef": {
      "type": "object",
      "additionalProperties": false,
      "required": ["kind", "uri"],
      "properties": {
        "kind": {
          "type": "string",
          "enum": ["url", "file", "issue", "dataset", "artifact"]
        },
        "uri": {
          "type": "string",
          "minLength": 1
        },
        "title": {
          "type": "string"
        },
        "checksum": {
          "type": "string"
        },
        "collected_at": {
          "$ref": "#/$defs/isoDateTime"
        }
      }
    },
    "evidenceRef": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "source", "captured_at"],
      "properties": {
        "id": {
          "$ref": "#/$defs/id"
        },
        "source": {
          "$ref": "#/$defs/sourceRef"
        },
        "snippet": {
          "type": "string"
        },
        "captured_at": {
          "$ref": "#/$defs/isoDateTime"
        }
      }
    }
  }
}
