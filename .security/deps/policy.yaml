policy:
  metadata:
    owner: "Security Engineering"
    updated: "2025-03-06"
    description: "Baseline dependency allow/deny controls for SBOM validation."

  disallowed_licenses:
    - AGPL-3.0-only
    - AGPL-3.0-or-later
    - SSPL-1.0
    - BUSL-1.1

  denylist:
    packages:
      - name: event-stream
        reason: "Malware and typosquat history; explicitly blocked."
      - name: ua-parser-js
        version_regex: "^0\\.7\\.29"
        reason: "Malware-tainted npm release (Oct 2021)."
    cves:
      - id: CVE-2024-3094
        package: xz
        version_regex: "^5\\.6\\.[01]"
        reason: "Backdoored xz/liblzma release; must not ship."
      - id: CVE-2024-11102
        package: glibc
        version_regex: "^2\\.39"
        reason: "Critical glibc resolver vulnerability."

  allow_overrides:
    - package: xz
      version_regex: "^5\\.6\\.[01]"
      cve: CVE-2024-3094
      justification: "Risk accepted while base image is rotated; mitigated by runtime sandboxing."
      ticket: "SEC-4321"
      expires: "2025-07-31T23:59:59Z"
    - package: glibc
      version_regex: "^2\\.39"
      cve: CVE-2024-11102
      justification: "Upstream patched packages are staged; temporary tolerance for non-exposed build toolchain."
      ticket: "SEC-4322"
      expires: "2025-06-30T23:59:59Z"
    - package: react
      version_regex: "^19\\.2\\.0"
      justification: "Risk accepted for a limited period while upstream remediation lands."
      ticket: "SEC-2025"
      expires: "2025-07-31T23:59:59Z"
