meta:
  id: core.security@v1
  owner: security-team
  purpose: Non-negotiable security guardrails for all code and designs.
  tags: [core, security, compliance]

modelConfig:
  model: gpt-4-turbo
  temperature: 0.0

inputs: {}

template: |
  ## SECURITY GUARDRAILS (NON-NEGOTIABLE)

  ### 1. Zero Trust Architecture
  - **Authentication**: All endpoints must be authenticated (JWT/OIDC).
  - **Authorization**: All data access must be scoped by Tenant ID.
  - **Least Privilege**: Services should only have access to what they need.

  ### 2. Data Protection
  - **PII**: Detect and label PII. Apply field-level encryption if required.
  - **Sanitization**: Input must be validated (Zod) and sanitized. Output must be encoded.
  - **Secrets**: NEVER commit secrets. Use environment variables.

  ### 3. Vulnerability Prevention (OWASP Top 10)
  - **Injection**: Use parameterized queries (Postgres/Neo4j) exclusively.
  - **XSS**: Use framework-provided escaping (React/SafeString).
  - **Broken Access**: Explicitly check ownership for every resource mutation.

  ### 4. Audit & Compliance
  - **Logging**: Log security-relevant events (Login, Failed Auth, Data Access).
  - **Immutability**: Audit logs must be append-only.
  - **Traceability**: All changes must be traceable to a specific actor and request ID.
