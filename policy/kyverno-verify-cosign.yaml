apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata: { name: verify-image-signatures }
spec:
  validationFailureAction: Enforce
  rules:
  - name: require-signed
    match: { resources: { kinds: ["Pod"], namespaces: ["companyos"] } }
    verifyImages:
    - imageReferences: ["ghcr.io/brianclong/summit/asset-inventory:*"]
      attestors:
      - entries:
        - keyless:
            issuer: "https://token.actions.githubusercontent.com"
            subject: "https://github.com/BrianCLong/summit/.github/workflows/asset-inventory.yml @refs/heads/main"
