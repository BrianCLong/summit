package goldenpath.cve

cve_budget := input.policy.cve_budget_limit or 0

allow if {
  not violation
}

violation if {
  finding := input.vulns.findings[_]
  finding.severity == "critical" or finding.severity == "high"
  count([x | x := input.vulns.findings[_]; x.severity == "critical" or x.severity == "high"]) > cve_budget
}
