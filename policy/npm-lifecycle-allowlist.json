{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "1.0.0",
  "description": "Allowlist for npm packages that require lifecycle scripts. Part of Shai-Hulud supply chain security.",
  "policy": {
    "default": "deny",
    "rationale": "Lifecycle scripts (preinstall, postinstall, etc.) are a common attack vector in supply chain attacks. All scripts are blocked by default via .npmrc ignore-scripts=true. Packages listed here are explicitly allowed after security review."
  },
  "reviewed_at": "2026-02-06",
  "reviewed_by": "security-team",
  "allowed_packages": [
    {
      "name": "esbuild",
      "reason": "Downloads platform-specific binary during postinstall",
      "scripts": ["postinstall"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "@esbuild/*",
      "reason": "Platform-specific esbuild binaries",
      "scripts": ["postinstall"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "sharp",
      "reason": "Native image processing library, downloads platform binary",
      "scripts": ["postinstall", "install"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "argon2",
      "reason": "Native cryptographic library for password hashing",
      "scripts": ["postinstall", "install"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "better-sqlite3",
      "reason": "Native SQLite bindings",
      "scripts": ["postinstall", "install"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "@playwright/test",
      "reason": "E2E testing framework, downloads browser binaries",
      "scripts": ["postinstall"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "playwright",
      "reason": "Browser automation, downloads browser binaries",
      "scripts": ["postinstall"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "husky",
      "reason": "Git hooks manager",
      "scripts": ["postinstall", "prepare"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "@swc/core",
      "reason": "Native Rust-based JavaScript compiler",
      "scripts": ["postinstall"],
      "risk_level": "low",
      "reviewed_at": "2026-02-06"
    },
    {
      "name": "node-gyp",
      "reason": "Native addon build tool",
      "scripts": ["install"],
      "risk_level": "medium",
      "reviewed_at": "2026-02-06",
      "notes": "Required for building native addons, review carefully when updating"
    }
  ],
  "blocked_patterns": [
    {
      "pattern": "**/preinstall.js",
      "reason": "preinstall scripts run before dependency verification"
    },
    {
      "pattern": "**/node_modules/.bin/*",
      "reason": "Executable scripts should not be dynamically generated"
    }
  ]
}
