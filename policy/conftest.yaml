# Conftest configuration for policy enforcement
# This file configures how Conftest runs the OPA policies

# Policy configuration
policy: policy/
output: table
combine: false
trace: false
strict: true

# Namespaces for different policy types
namespace:
  - dockerfile
  - kubernetes
  - supply_chain

# File patterns to validate
input:
  # Dockerfile validation
  - dockerfile: '**/Dockerfile*'
  - dockerfile: '**/*.dockerfile'

  # Kubernetes manifest validation
  - kubernetes: '**/*.yaml'
  - kubernetes: '**/*.yml'
  - kubernetes: 'k8s/**/*'
  - kubernetes: 'charts/**/templates/**'

  # Supply chain validation (SBOM, attestations)
  - supply_chain: '**/sbom-*.json'
  - supply_chain: '**/attestation-*.json'
  - supply_chain: '**/evidence-bundle.json'

# Exclusions
exclude:
  - 'test/**'
  - 'tests/**'
  - 'examples/**'
  - 'docs/**'
  - '.git/**'

# Fail on policy violations
fail-on-warn: false
