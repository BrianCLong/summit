import type {
  Adversary,
  Detection,
  TacticEvent,
  DefenseStrategy,
  SimulationScenario,
  Incident,
  Campaign,
  Alert,
  IOC,
  Playbook,
  ThreatIntelItem,
  SecurityMetric,
  RiskScore,
  MitreTechnique,
} from '../types';

// Mock Adversaries
export const mockAdversaries: Adversary[] = [
  {
    id: 'apt-29',
    name: 'APT29',
    aliases: ['Cozy Bear', 'The Dukes', 'YTTRIUM'],
    type: 'nation-state',
    threatLevel: 'critical',
    description: 'Russian state-sponsored threat group known for sophisticated cyber espionage operations.',
    originCountry: 'Russia',
    targetSectors: ['Government', 'Defense', 'Healthcare', 'Technology'],
    targetRegions: ['North America', 'Europe', 'Asia'],
    techniques: ['T1566.001', 'T1059.001', 'T1071.001', 'T1027', 'T1083', 'T1055'],
    malware: ['WellMess', 'WellMail', 'SoreFang'],
    tools: ['Cobalt Strike', 'Mimikatz', 'PsExec'],
    campaigns: ['SolarWinds', 'COVID-19 Research'],
    firstSeen: '2008-01-01',
    lastSeen: '2024-01-15',
    active: true,
    confidence: 95,
    references: ['https://attack.mitre.org/groups/G0016/'],
    tags: ['espionage', 'supply-chain', 'government'],
  },
  {
    id: 'fin7',
    name: 'FIN7',
    aliases: ['Carbanak', 'Carbon Spider', 'ANUNAK'],
    type: 'cybercrime',
    threatLevel: 'high',
    description: 'Financially motivated threat group targeting retail, restaurant, and hospitality sectors.',
    originCountry: 'Unknown',
    targetSectors: ['Retail', 'Hospitality', 'Finance'],
    targetRegions: ['North America', 'Europe'],
    techniques: ['T1566.001', 'T1059.003', 'T1021.001', 'T1486'],
    malware: ['Carbanak', 'Pillowmint', 'Diceloader'],
    tools: ['Cobalt Strike', 'Metasploit'],
    campaigns: ['Retail POS Campaign'],
    firstSeen: '2013-01-01',
    lastSeen: '2024-01-10',
    active: true,
    confidence: 90,
    references: [],
    tags: ['financial', 'pos-malware', 'ransomware'],
  },
  {
    id: 'lazarus',
    name: 'Lazarus Group',
    aliases: ['Hidden Cobra', 'ZINC', 'Guardians of Peace'],
    type: 'nation-state',
    threatLevel: 'critical',
    description: 'North Korean state-sponsored group known for both espionage and financially motivated attacks.',
    originCountry: 'North Korea',
    targetSectors: ['Finance', 'Cryptocurrency', 'Defense', 'Media'],
    targetRegions: ['Global'],
    techniques: ['T1566.002', 'T1059.005', 'T1486', 'T1567.002'],
    malware: ['HOPLIGHT', 'ELECTRICFISH', 'AppleJeus'],
    tools: ['Custom loaders', 'RATs'],
    campaigns: ['WannaCry', 'Sony Pictures', 'Bangladesh Bank'],
    firstSeen: '2009-01-01',
    lastSeen: '2024-01-12',
    active: true,
    confidence: 92,
    references: [],
    tags: ['financial', 'destructive', 'cryptocurrency'],
  },
];

// Mock Detections
export const mockDetections: Detection[] = [
  {
    id: 'det-001',
    name: 'Suspicious PowerShell Execution',
    description: 'PowerShell script with encoded commands detected executing from Office application.',
    severity: 'critical',
    status: 'investigating',
    technique: 'T1059.001',
    tactic: 'execution',
    adversary: 'APT29',
    source: 'EDR',
    timestamp: new Date(Date.now() - 3600000).toISOString(),
    affectedAssets: ['WORKSTATION-001', 'WORKSTATION-002'],
    indicators: ['powershell.exe', '-enc', 'base64payload'],
    evidence: [
      {
        id: 'ev-001',
        type: 'process',
        source: 'EDR',
        content: 'powershell.exe -enc aW52...',
        timestamp: new Date().toISOString(),
      },
    ],
    assignee: 'analyst1',
    notes: ['Initial triage complete', 'Escalated to incident'],
  },
  {
    id: 'det-002',
    name: 'Lateral Movement via PsExec',
    description: 'PsExec activity detected moving between systems.',
    severity: 'high',
    status: 'new',
    technique: 'T1021.002',
    tactic: 'lateral-movement',
    source: 'SIEM',
    timestamp: new Date(Date.now() - 7200000).toISOString(),
    affectedAssets: ['SERVER-DC01', 'SERVER-FS01'],
    indicators: ['psexec.exe', 'ADMIN$', 'IPC$'],
    evidence: [],
    notes: [],
  },
  {
    id: 'det-003',
    name: 'Credential Dumping Attempt',
    description: 'LSASS memory access detected, possible credential harvesting.',
    severity: 'critical',
    status: 'confirmed',
    technique: 'T1003.001',
    tactic: 'credential-access',
    adversary: 'FIN7',
    source: 'EDR',
    timestamp: new Date(Date.now() - 1800000).toISOString(),
    affectedAssets: ['WORKSTATION-003'],
    indicators: ['lsass.exe', 'mimikatz', 'sekurlsa'],
    evidence: [],
    notes: ['Confirmed malicious activity'],
  },
];

// Mock Tactic Events
export const mockTacticEvents: TacticEvent[] = [
  {
    id: 'evt-001',
    timestamp: new Date(Date.now() - 86400000).toISOString(),
    tactic: 'initial-access',
    technique: 'T1566.001',
    description: 'Spearphishing attachment opened by user',
    severity: 'high',
    adversary: 'APT29',
    campaign: 'SolarWinds',
    detected: true,
  },
  {
    id: 'evt-002',
    timestamp: new Date(Date.now() - 82800000).toISOString(),
    tactic: 'execution',
    technique: 'T1059.001',
    description: 'PowerShell payload executed',
    severity: 'critical',
    adversary: 'APT29',
    campaign: 'SolarWinds',
    detected: true,
  },
  {
    id: 'evt-003',
    timestamp: new Date(Date.now() - 79200000).toISOString(),
    tactic: 'persistence',
    technique: 'T1547.001',
    description: 'Registry run key added for persistence',
    severity: 'high',
    adversary: 'APT29',
    detected: false,
  },
  {
    id: 'evt-004',
    timestamp: new Date(Date.now() - 75600000).toISOString(),
    tactic: 'credential-access',
    technique: 'T1003.001',
    description: 'LSASS credentials dumped',
    severity: 'critical',
    detected: true,
  },
];

// Mock Defense Strategies
export const mockDefenseStrategies: DefenseStrategy[] = [
  {
    id: 'def-001',
    name: 'Endpoint Detection & Response',
    description: 'Deploy EDR solution across all endpoints for real-time threat detection.',
    category: 'detection',
    status: 'active',
    techniques: ['T1059.001', 'T1059.003', 'T1003.001', 'T1055'],
    controls: ['EDR Deployment', 'Behavioral Analysis', 'Memory Protection'],
    coverage: 85,
    effectiveness: 78,
    cost: 'high',
    priority: 1,
    implementedAt: '2023-01-15',
    reviewedAt: '2024-01-01',
  },
  {
    id: 'def-002',
    name: 'Email Security Gateway',
    description: 'Advanced email filtering to prevent phishing and malware delivery.',
    category: 'prevention',
    status: 'active',
    techniques: ['T1566.001', 'T1566.002'],
    controls: ['Spam Filter', 'Attachment Sandbox', 'URL Rewriting'],
    coverage: 92,
    effectiveness: 88,
    cost: 'medium',
    priority: 2,
    implementedAt: '2022-06-01',
    reviewedAt: '2023-12-15',
  },
  {
    id: 'def-003',
    name: 'Network Segmentation',
    description: 'Limit lateral movement through network isolation.',
    category: 'prevention',
    status: 'implementing',
    techniques: ['T1021.001', 'T1021.002', 'T1570'],
    controls: ['VLANs', 'Micro-segmentation', 'Zero Trust'],
    coverage: 60,
    effectiveness: 70,
    cost: 'high',
    priority: 3,
  },
];

// Mock Simulation Scenarios
export const mockSimulations: SimulationScenario[] = [
  {
    id: 'sim-001',
    name: 'APT29 Attack Simulation',
    description: 'Simulate APT29 attack chain from initial access to data exfiltration.',
    adversary: 'APT29',
    techniques: ['T1566.001', 'T1059.001', 'T1003.001', 'T1071.001'],
    objectives: ['Test email filtering', 'Validate EDR detection', 'Test DLP controls'],
    status: 'completed',
    startedAt: '2024-01-10T10:00:00Z',
    completedAt: '2024-01-10T14:30:00Z',
    results: {
      detected: 3,
      blocked: 1,
      evaded: 0,
      successRate: 100,
      avgDetectionTime: 45000,
      recommendations: ['Improve PowerShell logging', 'Enable AMSI'],
      findings: [
        { technique: 'T1566.001', result: 'blocked', details: 'Email gateway blocked attachment' },
        { technique: 'T1059.001', result: 'detected', detectionTime: 30000, details: 'EDR detected execution' },
        { technique: 'T1003.001', result: 'detected', detectionTime: 60000, details: 'Credential access blocked' },
      ],
    },
  },
  {
    id: 'sim-002',
    name: 'Ransomware Response Test',
    description: 'Test detection and response capabilities against ransomware.',
    techniques: ['T1486', 'T1490', 'T1489'],
    objectives: ['Validate backup integrity', 'Test incident response', 'Measure recovery time'],
    status: 'pending',
  },
];

// Mock Incidents
export const mockIncidents: Incident[] = [
  {
    id: 'inc-001',
    title: 'Suspected APT29 Intrusion',
    description: 'Multiple indicators suggest active APT29 intrusion attempt.',
    status: 'investigating',
    priority: 'p1',
    severity: 'critical',
    detections: ['det-001', 'det-003'],
    adversary: 'APT29',
    affectedAssets: ['WORKSTATION-001', 'WORKSTATION-002', 'WORKSTATION-003'],
    timeline: [
      {
        id: 'evt-i-001',
        timestamp: new Date(Date.now() - 7200000).toISOString(),
        type: 'detection',
        description: 'Initial detection triggered',
      },
      {
        id: 'evt-i-002',
        timestamp: new Date(Date.now() - 3600000).toISOString(),
        type: 'assignment',
        description: 'Incident assigned to IR team',
        actor: 'SOC Manager',
      },
    ],
    responseActions: [
      {
        id: 'act-001',
        name: 'Isolate affected workstations',
        description: 'Network isolation of compromised systems',
        type: 'containment',
        status: 'completed',
        automated: false,
        assignee: 'analyst1',
        completedAt: new Date(Date.now() - 1800000).toISOString(),
      },
      {
        id: 'act-002',
        name: 'Collect forensic artifacts',
        description: 'Memory and disk forensics',
        type: 'investigation',
        status: 'in-progress',
        automated: false,
        assignee: 'analyst2',
      },
    ],
    assignee: 'analyst1',
    team: ['analyst1', 'analyst2', 'ir-lead'],
    createdAt: new Date(Date.now() - 7200000).toISOString(),
    updatedAt: new Date(Date.now() - 1800000).toISOString(),
  },
];

// Mock Campaigns
export const mockCampaigns: Campaign[] = [
  {
    id: 'camp-001',
    name: 'Operation SolarFlare',
    description: 'Supply chain attack targeting software vendors.',
    adversary: 'APT29',
    status: 'active',
    objectives: ['Gain persistent access', 'Exfiltrate sensitive data'],
    targetSectors: ['Technology', 'Government'],
    targetRegions: ['North America', 'Europe'],
    techniques: ['T1195.002', 'T1059.001', 'T1071.001'],
    phases: [
      {
        id: 'phase-001',
        name: 'Initial Compromise',
        description: 'Supply chain infiltration',
        tactics: ['initial-access'],
        techniques: ['T1195.002'],
        startDate: '2023-12-01',
        status: 'completed',
      },
      {
        id: 'phase-002',
        name: 'Establish Foothold',
        description: 'Deploy backdoor and establish C2',
        tactics: ['execution', 'persistence', 'command-and-control'],
        techniques: ['T1059.001', 'T1547.001', 'T1071.001'],
        startDate: '2024-01-01',
        status: 'active',
      },
    ],
    iocs: [],
    incidents: ['inc-001'],
    firstSeen: '2023-12-01',
    lastSeen: '2024-01-15',
    confidence: 85,
  },
];

// Mock Alerts
export const mockAlerts: Alert[] = [
  {
    id: 'alert-001',
    title: 'Critical Detection: Credential Dumping',
    description: 'LSASS memory access detected on WORKSTATION-003',
    severity: 'critical',
    category: 'detection',
    status: 'new',
    source: 'EDR',
    timestamp: new Date(Date.now() - 1800000).toISOString(),
    relatedEntity: 'det-003',
    relatedEntityType: 'detection',
  },
  {
    id: 'alert-002',
    title: 'IOC Match: Known C2 Domain',
    description: 'Network connection to known APT29 C2 infrastructure',
    severity: 'high',
    category: 'ioc-match',
    status: 'acknowledged',
    source: 'Threat Intel',
    timestamp: new Date(Date.now() - 3600000).toISOString(),
    acknowledgedAt: new Date(Date.now() - 3000000).toISOString(),
  },
];

// Mock IOCs
export const mockIOCs: IOC[] = [
  {
    id: 'ioc-001',
    type: 'domain',
    value: 'malicious-c2.example.com',
    description: 'Known APT29 C2 domain',
    adversary: 'APT29',
    campaign: 'SolarWinds',
    confidence: 95,
    tlp: 'amber',
    firstSeen: '2024-01-01',
    lastSeen: '2024-01-15',
    hitCount: 3,
    whitelisted: false,
    tags: ['c2', 'apt29'],
    source: 'Threat Intel Feed',
  },
  {
    id: 'ioc-002',
    type: 'hash-sha256',
    value: 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855',
    description: 'WellMess malware hash',
    adversary: 'APT29',
    confidence: 100,
    tlp: 'red',
    firstSeen: '2023-06-01',
    lastSeen: '2024-01-10',
    hitCount: 0,
    whitelisted: false,
    tags: ['malware', 'wellmess'],
    source: 'CISA Advisory',
  },
  {
    id: 'ioc-003',
    type: 'ip',
    value: '192.168.1.100',
    description: 'Internal test server',
    confidence: 100,
    tlp: 'white',
    firstSeen: '2024-01-01',
    lastSeen: '2024-01-15',
    hitCount: 50,
    whitelisted: true,
    tags: ['internal', 'test'],
    source: 'Internal',
  },
];

// Mock Playbooks
export const mockPlaybooks: Playbook[] = [
  {
    id: 'pb-001',
    name: 'Phishing Response',
    description: 'Standard response procedure for phishing incidents.',
    category: 'incident-response',
    version: '2.1',
    steps: [
      {
        id: 'step-001',
        name: 'Identify affected users',
        description: 'Search email logs for recipients of phishing email',
        type: 'automated',
        order: 1,
        automated: true,
        action: 'email_log_search',
      },
      {
        id: 'step-002',
        name: 'Block sender',
        description: 'Add sender to email blocklist',
        type: 'automated',
        order: 2,
        automated: true,
        action: 'block_sender',
      },
      {
        id: 'step-003',
        name: 'User notification',
        description: 'Notify affected users about phishing attempt',
        type: 'notification',
        order: 3,
        automated: true,
      },
      {
        id: 'step-004',
        name: 'Credential reset decision',
        description: 'Determine if credential reset is needed',
        type: 'decision',
        order: 4,
        automated: false,
        nextStepOnSuccess: 'step-005',
        nextStepOnFailure: 'step-006',
      },
      {
        id: 'step-005',
        name: 'Force password reset',
        description: 'Reset passwords for users who clicked',
        type: 'automated',
        order: 5,
        automated: true,
      },
      {
        id: 'step-006',
        name: 'Close incident',
        description: 'Document and close the incident',
        type: 'manual',
        order: 6,
        automated: false,
      },
    ],
    estimatedDuration: 60,
    author: 'Security Team',
    createdAt: '2023-01-15',
    updatedAt: '2024-01-01',
    executionCount: 45,
    avgExecutionTime: 52,
    successRate: 94,
    tags: ['phishing', 'email', 'automated'],
  },
];

// Mock Threat Intel Items
export const mockThreatIntelItems: ThreatIntelItem[] = [
  {
    id: 'intel-001',
    title: 'APT29 Targets Healthcare Sector',
    description: 'New campaign targeting healthcare organizations with COVID-19 themed lures.',
    type: 'report',
    tlp: 'amber',
    source: 'CISA',
    publishedAt: new Date(Date.now() - 86400000).toISOString(),
    adversaries: ['APT29'],
    techniques: ['T1566.001', 'T1059.001'],
    iocs: ['malicious-c2.example.com'],
    confidence: 90,
    relevanceScore: 85,
    tags: ['apt29', 'healthcare', 'covid-19'],
    url: 'https://cisa.gov/advisory/aa21-001a',
  },
  {
    id: 'intel-002',
    title: 'New Ransomware Variant Identified',
    description: 'LockBit 3.0 variant with enhanced evasion capabilities.',
    type: 'advisory',
    tlp: 'green',
    source: 'FBI',
    publishedAt: new Date(Date.now() - 172800000).toISOString(),
    adversaries: [],
    techniques: ['T1486', 'T1490'],
    iocs: [],
    confidence: 95,
    relevanceScore: 70,
    tags: ['ransomware', 'lockbit'],
  },
];

// Mock Security Metrics
export const mockSecurityMetrics: SecurityMetric[] = [
  {
    id: 'metric-001',
    name: 'Mean Time to Detect (MTTD)',
    description: 'Average time from attack start to detection',
    category: 'detection',
    value: 45,
    unit: 'min',
    target: 30,
    threshold: { warning: 60, critical: 120 },
    trend: 'down',
    trendValue: -15,
    history: [
      { timestamp: new Date(Date.now() - 604800000).toISOString(), value: 55 },
      { timestamp: new Date(Date.now() - 518400000).toISOString(), value: 52 },
      { timestamp: new Date(Date.now() - 432000000).toISOString(), value: 48 },
      { timestamp: new Date(Date.now() - 345600000).toISOString(), value: 47 },
      { timestamp: new Date(Date.now() - 259200000).toISOString(), value: 46 },
      { timestamp: new Date(Date.now() - 172800000).toISOString(), value: 45 },
      { timestamp: new Date().toISOString(), value: 45 },
    ],
    status: 'warning',
  },
  {
    id: 'metric-002',
    name: 'Mean Time to Respond (MTTR)',
    description: 'Average time from detection to containment',
    category: 'response',
    value: 120,
    unit: 'min',
    target: 60,
    threshold: { warning: 180, critical: 360 },
    trend: 'stable',
    trendValue: 0,
    history: [],
    status: 'warning',
  },
  {
    id: 'metric-003',
    name: 'Phishing Block Rate',
    description: 'Percentage of phishing emails blocked',
    category: 'prevention',
    value: 98.5,
    unit: '%',
    target: 99,
    threshold: { warning: 95, critical: 90 },
    trend: 'up',
    trendValue: 2,
    history: [],
    status: 'good',
  },
  {
    id: 'metric-004',
    name: 'Patch Compliance',
    description: 'Percentage of systems with critical patches applied',
    category: 'compliance',
    value: 87,
    unit: '%',
    target: 95,
    threshold: { warning: 80, critical: 70 },
    trend: 'up',
    trendValue: 5,
    history: [],
    status: 'warning',
  },
];

// Mock Risk Score
export const mockRiskScore: RiskScore = {
  overall: 62,
  level: 'medium',
  breakdown: [
    {
      name: 'Threat Exposure',
      score: 70,
      weight: 30,
      factors: [
        { name: 'Active adversaries targeting sector', value: 3, impact: 'negative', description: '3 active APT groups' },
        { name: 'Recent detections', value: 5, impact: 'negative', description: '5 detections in 24h' },
      ],
    },
    {
      name: 'Vulnerability',
      score: 55,
      weight: 25,
      factors: [
        { name: 'Unpatched critical vulns', value: 12, impact: 'negative', description: '12 critical CVEs' },
        { name: 'Patch compliance', value: 87, impact: 'positive', description: '87% compliance' },
      ],
    },
    {
      name: 'Defense Coverage',
      score: 45,
      weight: 25,
      factors: [
        { name: 'EDR coverage', value: 95, impact: 'positive', description: '95% endpoint coverage' },
        { name: 'MFA adoption', value: 78, impact: 'neutral', description: '78% users with MFA' },
      ],
    },
    {
      name: 'Incident Response',
      score: 60,
      weight: 20,
      factors: [
        { name: 'MTTD', value: 45, impact: 'neutral', description: '45 min average' },
        { name: 'Open incidents', value: 2, impact: 'negative', description: '2 active incidents' },
      ],
    },
  ],
  previousScore: 58,
  trend: 'worsening',
  calculatedAt: new Date().toISOString(),
};

// Mock MITRE Techniques
export const mockTechniques: MitreTechnique[] = [
  {
    id: 'T1566.001',
    name: 'Spearphishing Attachment',
    tactic: 'initial-access',
    description: 'Adversaries may send spearphishing emails with a malicious attachment.',
    platforms: ['Windows', 'macOS', 'Linux'],
    dataSources: ['Email gateway', 'Process monitoring'],
    detectionMethods: ['Email scanning', 'Sandbox analysis'],
    mitigations: ['User training', 'Email filtering'],
  },
  {
    id: 'T1059.001',
    name: 'PowerShell',
    tactic: 'execution',
    description: 'Adversaries may abuse PowerShell commands and scripts for execution.',
    platforms: ['Windows'],
    dataSources: ['PowerShell logs', 'Process monitoring'],
    detectionMethods: ['Script block logging', 'Command line analysis'],
    mitigations: ['Constrained Language Mode', 'Application whitelisting'],
  },
  {
    id: 'T1003.001',
    name: 'LSASS Memory',
    tactic: 'credential-access',
    description: 'Adversaries may attempt to access credential material stored in LSASS.',
    platforms: ['Windows'],
    dataSources: ['Process access', 'Memory forensics'],
    detectionMethods: ['LSASS access monitoring', 'Credential Guard'],
    mitigations: ['Credential Guard', 'LSA Protection'],
  },
];

export default {
  adversaries: mockAdversaries,
  detections: mockDetections,
  tacticEvents: mockTacticEvents,
  defenseStrategies: mockDefenseStrategies,
  simulations: mockSimulations,
  incidents: mockIncidents,
  campaigns: mockCampaigns,
  alerts: mockAlerts,
  iocs: mockIOCs,
  playbooks: mockPlaybooks,
  threatIntelItems: mockThreatIntelItems,
  securityMetrics: mockSecurityMetrics,
  riskScore: mockRiskScore,
  techniques: mockTechniques,
};
