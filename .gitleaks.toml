# Gitleaks Configuration
# See https://github.com/gitleaks/gitleaks for documentation

title = "Summit/IntelGraph Gitleaks Configuration"

[allowlist]
  description = "Global allowlist"

  # Paths to exclude from scanning
  paths = [
    '''.*\.test\.ts$''',
    '''.*\.test\.js$''',
    '''.*\.spec\.ts$''',
    '''__tests__/.*''',
    '''setup/.*''',
    '''test/fixtures/.*''',
    '''examples/.*''',
    '''docs/.*''',
    '''\.orchestrator/patches/.*''',
    '''server/scripts/.*\.sh$''',
    '''helm/.*''',
    '''\.github/workflows/.*''',
    '''pnpm-lock\.yaml$''',
    '''package-lock\.json$''',
    '''yarn\.lock$''',
  ]

  # Regex patterns for content that's allowed (false positives)
  regexes = [
    # Example placeholder secrets
    '''(?i)example|placeholder|changeme|your[-_]?secret''',
  ]

[[rules]]
  id = "aws-access-key-id"
  description = "AWS Access Key ID"
  regex = '''\bAKIA[0-9A-Z]{16}\b'''
  tags = ["key", "aws"]

[[rules]]
  id = "github-token"
  description = "GitHub token"
  regex = '''\bgh[pousr]_[A-Za-z0-9_]{36,}\b'''
  tags = ["key", "github"]

[[rules]]
  id = "slack-bot-token"
  description = "Slack bot token"
  regex = '''\bxoxb-[0-9]{12}-[0-9]{12}-[A-Za-z0-9]{24}\b'''
  tags = ["key", "slack"]

[[rules]]
  id = "bearer-token"
  description = "Bearer token"
  regex = '''\bBearer\s+[A-Za-z0-9\-._~+\/]+=*'''
  tags = ["token"]
