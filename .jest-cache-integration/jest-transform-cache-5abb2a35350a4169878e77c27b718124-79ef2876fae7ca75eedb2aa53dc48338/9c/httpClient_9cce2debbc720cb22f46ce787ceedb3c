df399f730b6274c476a62acfc9d5ed90
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.http = http;
const supertest_1 = __importDefault(require("supertest"));
function http(app) {
    if (app)
        return (0, supertest_1.default)(app); // in-process app
    // Guard against accidental URL usage
    if (!app && !process.env.TEST_BASE_URL) {
        throw new Error('httpClient: provide app or set TEST_BASE_URL for external mode');
    }
    const base = process.env.TEST_BASE_URL; // external server (opt-in)
    if (!base)
        throw new Error('No app provided and TEST_BASE_URL is not set');
    return (0, supertest_1.default)(base);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3Rlc3RzL2ludGVncmF0aW9uL3V0aWxzL2h0dHBDbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQSxvQkFXQztBQWJELDBEQUFnQztBQUVoQyxTQUFnQixJQUFJLENBQUMsR0FBUztJQUM1QixJQUFJLEdBQUc7UUFBRSxPQUFPLElBQUEsbUJBQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUE4QixpQkFBaUI7SUFFNUUscUNBQXFDO0lBQ3JDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3ZDLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0VBQWdFLENBQUMsQ0FBQztJQUNwRixDQUFDO0lBRUQsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBb0IsMkJBQTJCO0lBQ3RGLElBQUksQ0FBQyxJQUFJO1FBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO0lBQzNFLE9BQU8sSUFBQSxtQkFBTyxFQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3Rlc3RzL2ludGVncmF0aW9uL3V0aWxzL2h0dHBDbGllbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcblxuZXhwb3J0IGZ1bmN0aW9uIGh0dHAoYXBwPzogYW55KSB7XG4gIGlmIChhcHApIHJldHVybiByZXF1ZXN0KGFwcCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4tcHJvY2VzcyBhcHBcbiAgXG4gIC8vIEd1YXJkIGFnYWluc3QgYWNjaWRlbnRhbCBVUkwgdXNhZ2VcbiAgaWYgKCFhcHAgJiYgIXByb2Nlc3MuZW52LlRFU1RfQkFTRV9VUkwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2h0dHBDbGllbnQ6IHByb3ZpZGUgYXBwIG9yIHNldCBURVNUX0JBU0VfVVJMIGZvciBleHRlcm5hbCBtb2RlJyk7XG4gIH1cbiAgXG4gIGNvbnN0IGJhc2UgPSBwcm9jZXNzLmVudi5URVNUX0JBU0VfVVJMOyAgICAgICAgICAgICAgICAgICAgLy8gZXh0ZXJuYWwgc2VydmVyIChvcHQtaW4pXG4gIGlmICghYmFzZSkgdGhyb3cgbmV3IEVycm9yKCdObyBhcHAgcHJvdmlkZWQgYW5kIFRFU1RfQkFTRV9VUkwgaXMgbm90IHNldCcpO1xuICByZXR1cm4gcmVxdWVzdChiYXNlKTtcbn0iXSwidmVyc2lvbiI6M30=