global:
  resolve_timeout: 5m

route:
  receiver: 'pagerduty'
  routes:
    - matchers:
        - severity = critical
      receiver: 'pagerduty'
    - matchers:
        - severity = warning
      receiver: 'pagerduty'

receivers:
  - name: 'pagerduty'
    pagerduty_configs:
      - routing_key: ${PAGERDUTY_ROUTING_KEY}
        description: 'Maestro Alert'
        severity: '{{ if eq .CommonLabels.severity "critical" }}critical{{ else }}warning{{ end }}'
        class: 'maestro'
        details:
          alertname: '{{ .CommonLabels.alertname }}'
          summary: '{{ .CommonAnnotations.summary }}'
          instance: '{{ .CommonLabels.instance }}'
          route: '{{ .CommonLabels.route }}'
