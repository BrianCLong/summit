# IntelGraph OIDC Configuration
# MIT License - Copyright (c) 2025 IntelGraph

# OIDC Provider Configuration
provider:
  issuer: "${OIDC_ISSUER:-https://auth.intelgraph.com}"
  authorization_endpoint: "${OIDC_AUTH_ENDPOINT:-https://auth.intelgraph.com/oauth/authorize}"
  token_endpoint: "${OIDC_TOKEN_ENDPOINT:-https://auth.intelgraph.com/oauth/token}"
  userinfo_endpoint: "${OIDC_USERINFO_ENDPOINT:-https://auth.intelgraph.com/userinfo}"
  jwks_uri: "${OIDC_JWKS_URI:-https://auth.intelgraph.com/.well-known/jwks.json}"
  end_session_endpoint: "${OIDC_LOGOUT_ENDPOINT:-https://auth.intelgraph.com/logout}"

# Client Configuration
client:
  id: "${OIDC_CLIENT_ID}"
  secret: "${OIDC_CLIENT_SECRET}"
  redirect_uri: "${OIDC_REDIRECT_URI:-https://app.intelgraph.com/auth/callback}"
  post_logout_redirect_uri: "${OIDC_POST_LOGOUT_URI:-https://app.intelgraph.com}"
  
# Scopes
scopes:
  - openid
  - profile
  - email
  - roles
  - tenant

# Token Configuration
tokens:
  access_token_lifetime: "${ACCESS_TOKEN_LIFETIME:-3600}" # 1 hour
  refresh_token_lifetime: "${REFRESH_TOKEN_LIFETIME:-604800}" # 1 week
  id_token_lifetime: "${ID_TOKEN_LIFETIME:-3600}" # 1 hour

# Claims Mapping
claims_mapping:
  user_id: "sub"
  email: "email"
  name: "name"
  tenant_id: "tenant_id"
  role: "role"
  permissions: "permissions"

# Security Settings
security:
  require_https: true
  enforce_pkce: true
  require_state: true
  require_nonce: true
  max_age: 86400 # 24 hours

# Session Configuration
session:
  cookie_name: "intelgraph_session"
  secure: true
  http_only: true
  same_site: "strict"
  max_age: 3600 # 1 hour