name: relevance-gate

permissions:
  contents: read
on: [workflow_dispatch]
jobs:
  eval:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: node relevance/eval/offline_eval.ts > eval.json
      - run: node -e "const m=require('./eval.json'); if(!require('./server/relevance/guardrail').guardrail(m)) process.exit(1)"