# OWASP ZAP Baseline Configuration for IntelGraph MLFP
# Security scanning configuration for web application

# Target application settings
target.url=http://localhost:4001
target.context=IntelGraph

# Authentication configuration
auth.method=form
auth.loginurl=http://localhost:4001/auth/login
auth.username=security-test@example.com
auth.password=securitytestpassword
auth.usernamefield=email
auth.passwordfield=password
auth.extrapostdata=
auth.excludeurls=

# Session management
session.method=cookie
session.cookiename=connect.sid

# Scan configuration
scan.delay=200
scan.threads=10
scan.maxduration=30
scan.maxruleid=
scan.progress=

# Include URLs (regex patterns)
include.urls=.*localhost:4001.*
include.urls=.*\/api\/.*
include.urls=.*\/graphql.*

# Exclude URLs from scanning
exclude.urls=.*logout.*
exclude.urls=.*\/static\/.*
exclude.urls=.*\/assets\/.*
exclude.urls=.*\.js$
exclude.urls=.*\.css$
exclude.urls=.*\.png$
exclude.urls=.*\.jpg$
exclude.urls=.*\.gif$
exclude.urls=.*\.ico$

# Security headers to check
headers.check=X-Frame-Options
headers.check=X-Content-Type-Options
headers.check=X-XSS-Protection
headers.check=Strict-Transport-Security
headers.check=Content-Security-Policy
headers.check=Referrer-Policy
headers.check=Permissions-Policy

# Custom scan rules
rules.enable=10003  # Reflected XSS
rules.enable=10004  # Stored XSS
rules.enable=10005  # SQL Injection
rules.enable=10006  # Path Traversal
rules.enable=10007  # Command Injection
rules.enable=10008  # LDAP Injection
rules.enable=10009  # XPATH Injection
rules.enable=10010  # XXE
rules.enable=10011  # CSRF
rules.enable=10012  # Session Fixation
rules.enable=10013  # Weak Authentication
rules.enable=10014  # Insecure Direct Object Reference
rules.enable=10015  # Security Misconfiguration
rules.enable=10016  # Sensitive Data Exposure
rules.enable=10017  # Missing Function Level Access Control
rules.enable=10018  # CSRF
rules.enable=10019  # Unvalidated Redirects and Forwards
rules.enable=10020  # Known Vulnerabilities

# Disable false positive prone rules
rules.disable=10021  # X-Forwarded-For Header (may cause false positives in dev)
rules.disable=10022  # Information Disclosure in error messages

# API specific security checks
api.definition.url=http://localhost:4001/api/openapi.json
api.definition.format=openapi
api.security.checks=true

# GraphQL specific security checks
graphql.endpoint=http://localhost:4001/graphql
graphql.introspection.check=true
graphql.query.depth.limit=10
graphql.query.complexity.limit=1000

# Report configuration
report.format=html,json,xml
report.directory=./zap-reports
report.filename.prefix=intelgraph-security-scan

# Alerting thresholds
alert.high.fail=true
alert.medium.warn=true
alert.low.ignore=false

# Custom attack patterns for intelligence analysis domain
attack.patterns=../,../../,../../../
attack.patterns=<script>,javascript:,vbscript:
attack.patterns=union select,select * from,' or '1'='1
attack.patterns=${jndi:ldap,${jndi:dns,${jndi:rmi
attack.patterns={{7*7}},${7*7},${{7*7}}

# Intelligence-specific payloads
intel.payloads=threat_actor,malware_family,ioc_value
intel.payloads=STIX-2.1,TAXII-2.1,JSON-LD
intel.payloads=CVE-,CWE-,CAPEC-

# File upload security tests
upload.extensions=.txt,.pdf,.doc,.xls,.png,.jpg
upload.malicious.files=true
upload.size.limits=true
upload.mime.validation=true

# Rate limiting tests
ratelimit.test=true
ratelimit.requests.per.second=100
ratelimit.burst.size=200

# Cookie security tests
cookie.secure=true
cookie.httponly=true
cookie.samesite=strict

# TLS/SSL security tests
tls.version.minimum=1.2
tls.cipher.strength.minimum=128
tls.certificate.validation=true

# Content Security Policy tests
csp.default.src='self'
csp.script.src='self' 'unsafe-inline'
csp.style.src='self' 'unsafe-inline'
csp.img.src='self' data: https:
csp.connect.src='self' wss:
csp.font.src='self'
csp.object.src='none'
csp.media.src='self'
csp.frame.src='none'