<!doctype html>
<html>
  <head>
    <title>Debug IntelGraph Client</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .error {
        color: red;
        background: #ffeaea;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid red;
      }
      .success {
        color: green;
        background: #eafaea;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid green;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        overflow: auto;
      }
    </style>
  </head>
  <body>
    <h1>IntelGraph Client Debug</h1>
    <div id="status"></div>

    <script>
      const statusDiv = document.getElementById('status');

      function addStatus(message, type = 'info') {
        const div = document.createElement('div');
        div.className = type;
        div.innerHTML = message;
        statusDiv.appendChild(div);
      }

      // Check if main page loads
      addStatus('Testing main page fetch...');

      fetch('http://localhost:3000/')
        .then((response) => {
          if (response.ok) {
            addStatus('‚úÖ Main page loads successfully', 'success');
            return response.text();
          } else {
            addStatus(`‚ùå Main page failed: ${response.status}`, 'error');
          }
        })
        .then((html) => {
          if (html) {
            if (html.includes('<div id="root">')) {
              addStatus('‚úÖ Root div found in HTML', 'success');
            } else {
              addStatus('‚ùå Root div not found in HTML', 'error');
            }
          }
        })
        .catch((err) => {
          addStatus(`‚ùå Failed to fetch main page: ${err.message}`, 'error');
        });

      // Check if main.jsx loads
      addStatus('Testing main.jsx fetch...');

      fetch('http://localhost:3000/src/main.jsx')
        .then((response) => {
          if (response.ok) {
            addStatus('‚úÖ main.jsx loads successfully', 'success');
            return response.text();
          } else {
            addStatus(`‚ùå main.jsx failed: ${response.status}`, 'error');
          }
        })
        .then((js) => {
          if (js) {
            if (js.includes('ReactDOM.createRoot')) {
              addStatus('‚úÖ ReactDOM.createRoot found in main.jsx', 'success');
            } else {
              addStatus(
                '‚ùå ReactDOM.createRoot not found in main.jsx',
                'error',
              );
            }
          }
        })
        .catch((err) => {
          addStatus(`‚ùå Failed to fetch main.jsx: ${err.message}`, 'error');
        });

      // Check backend API
      addStatus('Testing GraphQL API...');

      fetch('http://localhost:4000/graphql', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ query: '{ __typename }' }),
      })
        .then((response) => {
          if (response.ok) {
            addStatus('‚úÖ GraphQL API responds', 'success');
            return response.json();
          } else {
            addStatus(`‚ùå GraphQL API failed: ${response.status}`, 'error');
          }
        })
        .then((data) => {
          if (data && data.data && data.data.__typename === 'Query') {
            addStatus('‚úÖ GraphQL API returns valid data', 'success');
          } else {
            addStatus(
              `‚ùå GraphQL API returned invalid data: ${JSON.stringify(data)}`,
              'error',
            );
          }
        })
        .catch((err) => {
          addStatus(
            `‚ùå Failed to connect to GraphQL API: ${err.message}`,
            'error',
          );
        });

      // Monitor console errors
      const originalConsoleError = console.error;
      console.error = function (...args) {
        addStatus(`üö® Console Error: ${args.join(' ')}`, 'error');
        originalConsoleError.apply(console, args);
      };

      const originalConsoleWarn = console.warn;
      console.warn = function (...args) {
        addStatus(`‚ö†Ô∏è Console Warning: ${args.join(' ')}`, 'error');
        originalConsoleWarn.apply(console, args);
      };

      // Load the main React app to see what happens
      addStatus('Attempting to load React app...');

      const script = document.createElement('script');
      script.type = 'module';
      script.src = 'http://localhost:3000/src/main.jsx';
      script.onload = () => addStatus('‚úÖ main.jsx script loaded', 'success');
      script.onerror = (err) =>
        addStatus(`‚ùå main.jsx script failed to load: ${err}`, 'error');
      document.head.appendChild(script);

      // Check if React mounted after a delay
      setTimeout(() => {
        const root = document.getElementById('root');
        if (root && root.children.length > 0) {
          addStatus('‚úÖ React app mounted successfully!', 'success');
        } else {
          addStatus('‚ùå React app did not mount - root div is empty', 'error');
        }
      }, 3000);
    </script>

    <div id="root"></div>
  </body>
</html>
