name: CDN Parity Probe
on:
  schedule: [{ cron: '*/30 * * * *' }]
  workflow_dispatch:
jobs:
  probe:
    runs-on: ubuntu-latest
    steps:
      - run: |
          for u in "/" "/reference/"; do
            a=$(curl -s https://docs.example$u | shasum -a 256 | cut -d' ' -f1)
            b=$(curl -s https://backup.docs.example$u | shasum -a 256 | cut -d' ' -f1)
            echo "$u $a $b"
            [ "$a" = "$b" ] || { echo "::error ::Parity mismatch for $u"; exit 1; }
          done