name: k6-soak

on:
  schedule:
    - cron: '0 3 * * *' # daily at 03:00 UTC
  workflow_dispatch:

jobs:
  soak:
    runs-on: ubuntu-latest
    steps:
      - uses: grafana/k6-action@v0.2.0
        with:
          filename: ops/k6/soak_read_write.js
        env:
          API_URL: ${{ secrets.K6_API_URL }}
          APQ_HASH: ${{ secrets.K6_APQ_HASH }}
          TENANT_ID: ${{ secrets.K6_TENANT_ID }}
          USER: ${{ secrets.K6_USER }}
          PASS: ${{ secrets.K6_PASS }}
          WS_URL: ${{ secrets.K6_WS_URL }}
          JWT: ${{ secrets.K6_JWT }}

