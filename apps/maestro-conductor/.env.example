# Maestro Conductor vNext - Environment Configuration
# Copy this file to .env and customize for your environment

# =============================================================================
# ENVIRONMENT
# =============================================================================
NODE_ENV=development
ENVIRONMENT=development
LOG_LEVEL=info

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL=postgresql://maestro:maestro@localhost:5432/maestro
DB_HOST=localhost
DB_PORT=5432
DB_NAME=maestro
DB_USER=maestro
DB_PASSWORD=maestro

# Database connection pool
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_IDLE_TIMEOUT=30000

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# OPA POLICY ENGINE
# =============================================================================
OPA_ENDPOINT=http://localhost:8181
POLICY_BUNDLE_URL=
POLICY_REFRESH_INTERVAL=300000

# =============================================================================
# OBSERVABILITY & TELEMETRY
# =============================================================================
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=maestro-conductor
OTEL_SERVICE_VERSION=vnext
OTEL_RESOURCE_ATTRIBUTES=service.namespace=maestro,deployment.environment=development

# Prometheus metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# =============================================================================
# MODEL PROVIDERS
# =============================================================================

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_ORG_ID=
OPENAI_BASE_URL=https://api.openai.com/v1

# Anthropic Configuration
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_BASE_URL=https://api.anthropic.com

# Ollama Configuration (for local models)
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_ENABLED=true

# Azure OpenAI Configuration
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_VERSION=2024-02-01

# =============================================================================
# COST & BUDGET MANAGEMENT
# =============================================================================
DEFAULT_BUDGET_CENTS=50000
COST_ALERT_THRESHOLD=80
COST_CALCULATION_ENABLED=true
BUDGET_ENFORCEMENT_ENABLED=true

# =============================================================================
# SECURITY & AUTHENTICATION
# =============================================================================

# Provenance signing (generate with: openssl genpkey -algorithm Ed25519)
PROVENANCE_SIGNING_KEY=your-ed25519-private-key-base64
PROVENANCE_PUBLIC_KEY=your-ed25519-public-key-base64

# API authentication
API_KEY_HEADER=X-API-Key
JWT_SECRET=your-jwt-secret-min-32-chars
JWT_EXPIRES_IN=24h

# CORS configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# =============================================================================
# WORKFLOW EXECUTION
# =============================================================================
WORKER_CONCURRENCY=4
MAX_CONCURRENT_RUNS=100
STEP_TIMEOUT_MS=300000
RUN_TIMEOUT_MS=3600000

# Retry configuration
DEFAULT_RETRY_COUNT=3
DEFAULT_RETRY_BACKOFF_MS=1000
MAX_RETRY_BACKOFF_MS=30000

# =============================================================================
# STORAGE & FILE SYSTEM
# =============================================================================
UPLOAD_DIR=/tmp/maestro/uploads
WORKSPACE_DIR=/tmp/maestro/workspace
MAX_UPLOAD_SIZE=10485760
ALLOWED_FILE_TYPES=.txt,.json,.yaml,.yml,.csv,.md

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Email/Notification services
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@maestro.dev

# Webhook configuration
WEBHOOK_SECRET=your-webhook-secret
WEBHOOK_TIMEOUT=5000

# Slack integration
SLACK_BOT_TOKEN=
SLACK_WEBHOOK_URL=

# =============================================================================
# DEVELOPMENT & DEBUGGING
# =============================================================================
DEBUG=maestro:*
ENABLE_DEBUG_ROUTES=true
MOCK_PROVIDERS=false
SEED_DATABASE=true

# Hot reload
WATCH_FILES=true
RELOAD_ON_CHANGE=true

# Performance profiling
ENABLE_PROFILING=false
PROFILING_INTERVAL=60000

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESSFUL=false

# Provider-specific rate limits
OPENAI_RPM_LIMIT=3000
ANTHROPIC_RPM_LIMIT=1000
OPENAI_TPM_LIMIT=150000
ANTHROPIC_TPM_LIMIT=100000

# =============================================================================
# CIRCUIT BREAKER
# =============================================================================
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RESET_TIMEOUT_MS=60000
CIRCUIT_BREAKER_MONITOR_INTERVAL_MS=10000

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_PROVENANCE=true
ENABLE_POLICY_ENGINE=true
ENABLE_COST_GUARD=true
ENABLE_EVALS=true
ENABLE_REPLAY=true
ENABLE_STREAMING=true
ENABLE_HUMAN_IN_LOOP=true

# =============================================================================
# KUBERNETES DEPLOYMENT (when running in k8s)
# =============================================================================
# These are automatically set by Kubernetes - uncomment if needed
# KUBERNETES_NAMESPACE=maestro-production
# KUBERNETES_POD_NAME=
# KUBERNETES_NODE_NAME=

# =============================================================================
# HELM CHART OVERRIDES
# =============================================================================
# Used by Helm chart deployment
HELM_RELEASE_NAME=maestro-conductor
HELM_NAMESPACE=maestro-production
REPLICA_COUNT=3

# Ingress configuration
INGRESS_HOST=maestro.example.com
INGRESS_TLS_SECRET=maestro-tls
INGRESS_CLASS=nginx

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=
BACKUP_S3_PREFIX=maestro-backups/

# =============================================================================
# COMPLIANCE & AUDIT
# =============================================================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
GDPR_COMPLIANCE=true
HIPAA_COMPLIANCE=false
SOC2_COMPLIANCE=true

# Data retention
DATA_RETENTION_DAYS=365
AUDIT_RETENTION_DAYS=2555  # 7 years
PII_AUTO_REDACTION=true

# =============================================================================
# EXAMPLES & TESTING
# =============================================================================
# These are used for development and testing only
EXAMPLE_TENANT_ID=example-tenant
EXAMPLE_WORKFLOW_PATH=./examples/basic-workflow.yaml
LOAD_TEST_DURATION=2m
LOAD_TEST_VUS=20