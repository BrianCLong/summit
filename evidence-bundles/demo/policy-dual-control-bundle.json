{
  "version": "1.0.0",
  "scenario": "policy-dual-control-demo",
  "generatedAt": "2025-12-19T19:30:15.254229Z",
  "policy": {
    "package": "intelgraph.policy.export.enhanced",
    "inputPath": "evidence-bundles/demo/policy-dual-control-input.json",
    "inputSha256": "fb797099067b7693c8c8b5f5b8d8ed7e4b6be49fc20c7a2c929ad7da00423fff",
    "policySource": "policy/opa/export_enhanced.rego"
  },
  "context": {
    "exportType": "dataset",
    "destination": "s3://external-auditor/demo-bucket",
    "user": "analyst-123",
    "sourceCount": 120
  },
  "approvals": [
    {
      "actor": "compliance-officer",
      "channel": "ticket",
      "evidence": "IG-REQ-8721"
    },
    {
      "actor": "security-approver",
      "channel": "ticket",
      "evidence": "IG-REQ-8721"
    }
  ],
  "decision": {
    "action": "allow",
    "allow": true,
    "violations": [],
    "risk_assessment": {
      "level": "high",
      "factors": [
        "Large number of sources",
        "External dataset export"
      ],
      "requires_approval": false,
      "requires_dual_control": true,
      "requires_step_up": true
    },
    "required_approvals": [
      "dual-control"
    ],
    "appeal_available": false,
    "next_steps": [
      "Export approved - proceed with download"
    ]
  },
  "verification": {
    "expectedCommands": [
      "opa eval -f pretty -d policy/opa/export_enhanced.rego -i evidence-bundles/demo/policy-dual-control-input.json 'data.intelgraph.policy.export.enhanced.decision'",
      "jq -r '.decision.required_approvals' evidence-bundles/demo/policy-dual-control-bundle.json"
    ],
    "notes": [
      "Decision should show requires_dual_control = true with allow = true only after a second approver is present and step_up_verified = true.",
      "Risk factors should include the external destination and source volume triggers.",
      "Appeal availability remains false because there are no blocking violations in this sanitized sample."
    ]
  },
  "attestations": {
    "cosignSigned": false,
    "dualControlConfirmed": true,
    "stepUpVerified": true
  }
}