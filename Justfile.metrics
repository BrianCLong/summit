set shell := ["/bin/bash", "-cu"]

# Generate burndown/perf JSON
metrics-refresh:
    python3 tools/usage_burndown.py

# Serve the dashboard (repo root) and open it
dash-serve:
    python3 -m http.server 8787 >/dev/null 2>&1 & echo $! > /tmp/orchestra_http.pid

dash-open:
    open "http://localhost:8787/dash/burndown.html"

dash-stop:
    kill $(cat /tmp/orchestra_http.pid) 2>/dev/null || true

# One-liner to refresh + open
dash-refresh:
    just metrics-refresh
    just dash-open