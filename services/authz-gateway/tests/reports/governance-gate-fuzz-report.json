{
  "generatedAt": "2025-12-19T17:55:00.175Z",
  "propertyBased": {
    "runs": 60,
    "samples": [
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "PmbMVEsW8<_e",
          "resourceTenant": "bind",
          "action": "apply",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "y",
          "resourceTenant": "`%XD&yT$!x,",
          "action": "Q%ke$%#leS",
          "responseKind": "ok"
        },
        "result": {
          "allowed": true,
          "reason": " ;$Q",
          "obligations": 2
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "}& ",
          "resourceTenant": "S2LS)",
          "action": "wl;g",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "YtoStrin",
          "resourceTenant": "h",
          "action": "+-Bb2{%D",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "h&~Gld",
          "resourceTenant": "xGEVn.\"L {",
          "action": "T%FF$N\"8vH",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "/:",
          "resourceTenant": "^$>~!li<",
          "action": "kc%PU",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "deny",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "TYlE,!^",
          "resourceTenant": "u$v=h",
          "action": "V#~ H yg!8",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": " applyargume",
          "resourceTenant": "GrW@xl",
          "action": "j6s^(FDUQFf",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "65WZQ1",
          "resourceTenant": "0u",
          "action": "MhlPh",
          "responseKind": "ok"
        },
        "result": {
          "allowed": true,
          "reason": "allow",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "T}q]B=,ni",
          "resourceTenant": "P|R",
          "action": ":CagG",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "valueOf",
          "resourceTenant": "KwOwQt(x1G",
          "action": " T2.Twq",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "\\pUCfVH",
          "resourceTenant": "!61LV)@d\"+",
          "action": ": 32",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "deny",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "O^@Qk?9",
          "resourceTenant": ") ke",
          "action": "<vHvF!",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "apply",
          "resourceTenant": "s",
          "action": "9+:*X>NMwhS",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "^Z/Mc\"T78.6",
          "resourceTenant": "nD9ZKmozqAo",
          "action": "yA#6B*7}\"t~",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "call",
          "resourceTenant": "'a>j6pIUj",
          "action": "rtj;f=NH5'[&+Xs",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "%&a[",
          "resourceTenant": "{-",
          "action": "[*!`}jF",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "!_",
          "obligations": 4
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "AB?/J]I_d#S",
          "resourceTenant": "PW:pjK",
          "action": "lV|",
          "responseKind": "ok"
        },
        "result": {
          "allowed": true,
          "reason": "allow",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "NIu",
          "resourceTenant": "length",
          "action": "]Oz,b\",HC(=",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "w%",
          "resourceTenant": "s\"q",
          "action": "h+B(!jC",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "deny",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "95?#o9_S=",
          "resourceTenant": ";ZE/pkL4<.",
          "action": "h^d0?kkkv1?X",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "5t;|g&F",
          "resourceTenant": "@",
          "action": "%v?z#Po|3M~G",
          "responseKind": "ok"
        },
        "result": {
          "allowed": true,
          "reason": "allow",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "z[c*5h)S:",
          "resourceTenant": "#y^x\"&e\\\"#S",
          "action": "4:+3",
          "responseKind": "error"
        },
        "result": {
          "allowed": false,
          "reason": "opa_error",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "<z&~",
          "resourceTenant": "HhCE s",
          "action": "isProt",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      },
      {
        "name": "policy-authorize",
        "passed": true,
        "input": {
          "tenant": "fMte{~#",
          "resourceTenant": "name",
          "action": "sYh}]=x8R;zt",
          "responseKind": "ok"
        },
        "result": {
          "allowed": false,
          "reason": "opa_no_result",
          "obligations": 0
        }
      }
    ]
  },
  "mutationFuzzing": {
    "runs": 40,
    "samples": [
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "#_",
          "residencyHeader": "us",
          "classificationHeader": "public",
          "tags": [
            "pii"
          ],
          "acr": "loa2",
          "riskScore": 8
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "!wldRM{$-&j%",
          "residencyHeader": "apac",
          "classificationHeader": "internal",
          "tags": [],
          "acr": "loa1",
          "riskScore": 12
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": ")&rfL8j!_.",
          "residencyHeader": "eu",
          "classificationHeader": "public",
          "tags": [],
          "acr": "loa2",
          "riskScore": 12
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "bind",
          "residencyHeader": "us",
          "classificationHeader": "public",
          "tags": [
            "admin-only"
          ],
          "acr": "loa2",
          "riskScore": 6
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "tenantA",
          "residencyHeader": "us",
          "classificationHeader": "public",
          "tags": [
            "sensitive"
          ],
          "acr": "loa1",
          "riskScore": 96
        },
        "result": {
          "status": 403,
          "reason": "risk_threshold_exceeded",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "2{^9[fh`G*4",
          "residencyHeader": "apac",
          "classificationHeader": "public",
          "tags": [],
          "acr": "loa1",
          "riskScore": 12
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "|`*02}7bS'",
          "residencyHeader": "latam",
          "classificationHeader": "public",
          "tags": [
            "admin-only"
          ],
          "acr": "loa2",
          "riskScore": 97
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "Sdi^V",
          "residencyHeader": "us",
          "classificationHeader": "public",
          "tags": [
            "sensitive"
          ],
          "acr": "loa1",
          "riskScore": 4
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "LF&8EhFX\"z",
          "residencyHeader": "us",
          "classificationHeader": "public",
          "tags": [
            "pii"
          ],
          "acr": "loa1",
          "riskScore": 3
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa2"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-invalid-token",
        "passed": true,
        "input": {
          "tamperToken": true,
          "acr": "loa1"
        },
        "result": {
          "status": 401,
          "error": "invalid_token"
        }
      },
      {
        "name": "mutation-governance-case",
        "passed": true,
        "input": {
          "tenantHeader": "yb?",
          "residencyHeader": "us",
          "classificationHeader": "restricted",
          "tags": [
            "sensitive"
          ],
          "acr": "loa1",
          "riskScore": 0
        },
        "result": {
          "status": 403,
          "reason": "tenant_mismatch",
          "obligations": 0
        }
      }
    ]
  },
  "adversarialFuzzing": {
    "cases": 8,
    "samples": [
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "8016e3a9c",
          "classification": "GJ0bwaN0BUjDf4odUf==",
          "tags": [
            "fLgr69ZWNDldS17XZoEb0YdLZIm0",
            "Û™´≤ÒºÇ∫ÚÇìÑÒ∫πÇ"
          ],
          "encodedTenant": "ODAxNmUzYTlj",
          "encodedClassification": "R0owYndhTjBCVWpEZjRvZFVmPT0=",
          "encodedTags": [
            "ZkxncjY5WldORGxkUzE3WFpvRWIwWWRMWkltMA==",
            "86qrsvG8grrygpOE8bq5gg=="
          ],
          "acr": "loa1"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "8649931784568",
          "classification": "f6679fa1e",
          "tags": [
            "NJ3rNpuFsAlD3HjzHA1cVZm794CmWPk="
          ],
          "encodedTenant": "ODY0OTkzMTc4NDU2OA==",
          "encodedClassification": "ZjY2NzlmYTFl",
          "encodedTags": [
            "Tkozck5wdUZzQWxEM0hqekhBMWNWWm03OTRDbVdQaz0="
          ],
          "acr": "loa1"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "ca71d8c599324a820",
          "classification": "∏ûå°™ª•©óÛÇÑêÚã©¢Òó∞≠ÈÄ≤Ú¥àÜ",
          "tags": [
            "·àûÙéú§ÒÉ´£ÒÆ¢∑ÚÆóåÛ∑∏óÒÑÖ¢õàéÒÄÖ§"
          ],
          "encodedTenant": "Y2E3MWQ4YzU5OTMyNGE4MjA=",
          "encodedClassification": "8LiejPChqrvwpamX84KEkPKLqaLxl7Ct6YCy8rSIhg==",
          "encodedTags": [
            "4Yie9I6cpPGDq6PxrqK38q6XjPO3uJfxhIWi8JuIjvGAhaQ="
          ],
          "acr": "loa1"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "dEDiVE7Eru8bJ6B1A7DVEYRbFF==",
          "classification": "<script>alert(1)</script>",
          "tags": [
            "<script>alert(1)</script>"
          ],
          "encodedTenant": "ZEVEaVZFN0VydThiSjZCMUE3RFZFWVJiRkY9PQ==",
          "encodedClassification": "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==",
          "encodedTags": [
            "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
          ],
          "acr": "loa2"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "504bdca92a676",
          "classification": "OwnPrFcalllength",
          "tags": [
            "<script>alert(1)</script>"
          ],
          "encodedTenant": "NTA0YmRjYTkyYTY3Ng==",
          "encodedClassification": "T3duUHJGY2FsbGxlbmd0aA==",
          "encodedTags": [
            "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
          ],
          "acr": "loa2"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "tenantA'; DROP TABLE audit_log;--",
          "classification": "argumentsnamewD6Pro=",
          "tags": [
            "<script>alert(1)</script>"
          ],
          "encodedTenant": "dGVuYW50QSc7IERST1AgVEFCTEUgYXVkaXRfbG9nOy0t",
          "encodedClassification": "YXJndW1lbnRzbmFtZXdENlBybz0=",
          "encodedTags": [
            "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="
          ],
          "acr": "loa1"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "qhih6fXZKmjPpum5vOhijx8D",
          "classification": "<script>alert(1)</script>",
          "tags": [
            "45a0b85c6c0a22cb395a65955d"
          ],
          "encodedTenant": "cWhpaDZmWFpLbWpQcHVtNXZPaGlqeDhE",
          "encodedClassification": "PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==",
          "encodedTags": [
            "NDVhMGI4NWM2YzBhMjJjYjM5NWE2NTk1NWQ="
          ],
          "acr": "loa2"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      },
      {
        "name": "adversarial-input",
        "passed": true,
        "input": {
          "tenantId": "11abe4a4b2d8b6e01879",
          "classification": "Ûπ≥ÜÚºùôÛúÉªÛÄº≥",
          "tags": [
            "tenantA'; DROP TABLE audit_log;--",
            "03f8ae98ecad"
          ],
          "encodedTenant": "MTFhYmU0YTRiMmQ4YjZlMDE4Nzk=",
          "encodedClassification": "87mzhvK8nZnznIO784C8sw==",
          "encodedTags": [
            "dGVuYW50QSc7IERST1AgVEFCTEUgYXVkaXRfbG9nOy0t",
            "MDNmOGFlOThlY2Fk"
          ],
          "acr": "loa1"
        },
        "result": {
          "status": 403,
          "error": "forbidden",
          "reason": "tenant_mismatch"
        }
      }
    ]
  },
  "coverage": [
    {
      "file": "services/authz-gateway/src/middleware.ts",
      "summary": {
        "lines": {
          "total": 70,
          "covered": 50,
          "skipped": 0,
          "pct": 71.42
        },
        "functions": {
          "total": 5,
          "covered": 5,
          "skipped": 0,
          "pct": 100
        },
        "statements": {
          "total": 70,
          "covered": 50,
          "skipped": 0,
          "pct": 71.42
        },
        "branches": {
          "total": 63,
          "covered": 31,
          "skipped": 0,
          "pct": 49.2
        }
      }
    },
    {
      "file": "services/authz-gateway/src/policy.ts",
      "summary": {
        "lines": {
          "total": 45,
          "covered": 33,
          "skipped": 0,
          "pct": 73.33
        },
        "functions": {
          "total": 6,
          "covered": 6,
          "skipped": 0,
          "pct": 100
        },
        "statements": {
          "total": 46,
          "covered": 34,
          "skipped": 0,
          "pct": 73.91
        },
        "branches": {
          "total": 61,
          "covered": 44,
          "skipped": 0,
          "pct": 72.13
        }
      }
    }
  ]
}