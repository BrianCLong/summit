# ============================================================================
# SUMMIT PLATFORM - UNIFIED CONFIGURATION
# ============================================================================
# This is the CLEANED and CONSOLIDATED configuration template
# Migration Date: 2025-11-20
#
# INSTRUCTIONS:
# 1. Copy this file to .env for development
# 2. Fill in all required values marked with <REQUIRED>
# 3. Override optional values as needed for your environment
# 4. Never commit .env to version control
#
# PRECEDENCE ORDER:
# 1. Environment variables (highest priority)
# 2. .env.production (production only)
# 3. .env (development/local)
# 4. Default values in code (lowest priority)
# ============================================================================

# ============================================================================
# APPLICATION CORE
# ============================================================================

# Environment: development | staging | production
NODE_ENV=development

# Application name and version
APP_NAME=summit
APP_VERSION=1.0.0

# Server configuration
PORT=4000
HOST=localhost

# Base URL for the application (used for callbacks, webhooks, etc.)
BASE_URL=http://localhost:4000

# Log level: debug | info | warn | error
LOG_LEVEL=info

# Enable structured JSON logging (recommended for production)
LOG_FORMAT=json

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL (Primary Database)
# Connection string format: postgresql://user:password@host:port/database
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=summit_dev
POSTGRES_USER=summit
POSTGRES_PASSWORD=<REQUIRED>

# Alternative: Full connection URL (overrides individual params)
DATABASE_URL=postgresql://summit:password@localhost:5432/summit_dev

# Connection pool settings
POSTGRES_POOL_MIN=2
POSTGRES_POOL_MAX=10
POSTGRES_IDLE_TIMEOUT=30000

# Enable SSL for database connections (required in production)
POSTGRES_SSL=false
POSTGRES_SSL_REJECT_UNAUTHORIZED=true

# TimescaleDB (Time-series metrics)
TIMESCALE_HOST=localhost
TIMESCALE_PORT=5432
TIMESCALE_DB=summit_timeseries
TIMESCALE_USER=summit
TIMESCALE_PASSWORD=<REQUIRED>

# Redis (Caching & Sessions)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0

# Neo4j (Graph Database)
# MIGRATION NOTE: Use NEO4J_USER (not NEO4J_USERNAME - deprecated Q4 2024)
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=<REQUIRED>
NEO4J_DATABASE=neo4j

# ============================================================================
# AUTHENTICATION & SECURITY
# ============================================================================

# JWT Configuration
JWT_SECRET=<REQUIRED:generate-with-openssl-rand-base64-32>
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=<REQUIRED:generate-with-openssl-rand-base64-32>
JWT_REFRESH_EXPIRES_IN=30d

# Session configuration
SESSION_SECRET=<REQUIRED:generate-with-openssl-rand-base64-32>
SESSION_MAX_AGE=86400000

# CORS configuration (comma-separated origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:4000
CORS_CREDENTIALS=true

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Security headers
HELMET_ENABLED=true
HSTS_ENABLED=true

# API Keys (for external integrations)
API_KEY_HEADER=X-API-Key

# ============================================================================
# AI & LLM PROVIDERS
# ============================================================================

# OpenAI
OPENAI_API_KEY=<REQUIRED>
OPENAI_ORG_ID=
OPENAI_MODEL=gpt-4o
OPENAI_MAX_TOKENS=8000
OPENAI_TEMPERATURE=0.7

# Anthropic Claude
ANTHROPIC_API_KEY=<REQUIRED>
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929
ANTHROPIC_MAX_TOKENS=8000
ANTHROPIC_TEMPERATURE=0.7

# Google Gemini
GOOGLE_API_KEY=
GOOGLE_MODEL=gemini-pro
GOOGLE_MAX_TOKENS=8000

# Local LLM (vLLM)
VLLM_ENABLED=false
VLLM_BASE_URL=http://localhost:8000
VLLM_MODEL=mistral-7b

# Ollama (Local models)
OLLAMA_ENABLED=false
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama2

# Model Budget Management
BUDGET_TRACKING_ENABLED=true
BUDGET_ALERT_THRESHOLD=0.8
BUDGET_HARD_LIMIT=true

# ============================================================================
# MAESTRO ORCHESTRATION
# ============================================================================

# Maestro API Configuration
MAESTRO_API_URL=https://api.maestro.ai
MAESTRO_API_TOKEN=<REQUIRED>
MAESTRO_WORKSPACE_ID=<REQUIRED>

# Maestro features
MAESTRO_AGENTS_ENABLED=true
MAESTRO_WORKFLOWS_ENABLED=true
MAESTRO_TELEMETRY_ENABLED=true

# ============================================================================
# OBSERVABILITY & MONITORING
# ============================================================================

# OpenTelemetry (Distributed Tracing)
OTEL_ENABLED=true
OTEL_SERVICE_NAME=summit
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=0.1

# Metrics collection
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30000

# Error tracking (Sentry)
SENTRY_ENABLED=false
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Feature flag service
FEATURE_FLAGS_ENABLED=true
FEATURE_FLAGS_PROVIDER=local

# Individual feature flags (override config/flags.json)
FEATURE_AI_AGENTS=true
FEATURE_GRAPH_ANALYTICS=true
FEATURE_WORKFLOW_ENGINE=true
FEATURE_COLLABORATION=true
FEATURE_ADVANCED_SEARCH=false

# Experimental features (disabled by default)
FEATURE_EXPERIMENTAL_UI=false
FEATURE_BETA_API=false

# ============================================================================
# FILE STORAGE
# ============================================================================

# Storage provider: local | s3 | gcs | azure
STORAGE_PROVIDER=local

# Local storage
STORAGE_LOCAL_PATH=./uploads
STORAGE_LOCAL_MAX_SIZE=104857600

# AWS S3 (if STORAGE_PROVIDER=s3)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
AWS_S3_BUCKET=
AWS_S3_ENDPOINT=

# File upload limits
MAX_FILE_SIZE=104857600
ALLOWED_FILE_TYPES=image/*,application/pdf,text/*

# ============================================================================
# EMAIL & NOTIFICATIONS
# ============================================================================

# Email provider: smtp | sendgrid | ses
EMAIL_PROVIDER=smtp

# SMTP configuration
SMTP_HOST=localhost
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@summit.ai
SMTP_FROM_NAME=Summit Platform

# SendGrid (if EMAIL_PROVIDER=sendgrid)
SENDGRID_API_KEY=

# AWS SES (if EMAIL_PROVIDER=ses)
AWS_SES_REGION=us-east-1

# Notification channels
SLACK_WEBHOOK_URL=
DISCORD_WEBHOOK_URL=

# ============================================================================
# QUEUE & BACKGROUND JOBS
# ============================================================================

# Bull queue (Redis-based)
BULL_REDIS_URL=redis://localhost:6379/1

# Job processing
QUEUE_CONCURRENCY=5
QUEUE_MAX_RETRIES=3
QUEUE_BACKOFF_DELAY=5000

# Job types enabled
JOBS_EMAIL_ENABLED=true
JOBS_ANALYTICS_ENABLED=true
JOBS_EXPORT_ENABLED=true

# ============================================================================
# FEDERAL & COMPLIANCE (AirGap/FIPS)
# ============================================================================

# Federal deployment mode
FEDERAL_AIRGAP_MODE=false
FEDERAL_FIPS_ENABLED=false
FEDERAL_DUAL_NOTARY_ENABLED=false
FEDERAL_SLSA3_VERIFICATION=false

# Audit logging (required for federal)
AUDIT_TRAIL_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555

# Compliance reporting
COMPLIANCE_REPORTS_ENABLED=false
COMPLIANCE_REPORT_SCHEDULE=0 0 * * 0

# ============================================================================
# DEVELOPMENT & TESTING
# ============================================================================

# Development mode features
DEV_MODE=true
DEV_AUTO_RELOAD=true
DEV_DEBUG_SQL=false
DEV_MOCK_AUTH=false

# Testing
TEST_DATABASE_URL=postgresql://summit:password@localhost:5432/summit_test
TEST_REDIS_URL=redis://localhost:6379/15
TEST_TIMEOUT=30000

# Seeding & fixtures
SEED_SAMPLE_DATA=true
FIXTURES_PATH=./fixtures

# ============================================================================
# PERFORMANCE & OPTIMIZATION
# ============================================================================

# Caching
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=100

# Compression
COMPRESSION_ENABLED=true
COMPRESSION_THRESHOLD=1024

# Request timeouts (milliseconds)
REQUEST_TIMEOUT=30000
LONG_REQUEST_TIMEOUT=300000

# Database query optimization
QUERY_EXPLAIN_ENABLED=false
QUERY_SLOW_THRESHOLD=1000

# ============================================================================
# DEPRECATED KEYS (DO NOT USE)
# ============================================================================
# These keys are deprecated and will be removed in a future version
#
# NEO4J_USERNAME -> Use NEO4J_USER instead (deprecated Q4 2024)
# OLD_JWT_SECRET -> Use JWT_SECRET instead
# LEGACY_API_KEY -> Use API_KEY_HEADER instead
# ============================================================================

# ============================================================================
# MIGRATION NOTES
# ============================================================================
#
# FROM OLD CONFIGURATION:
#
# 1. Multiple config files consolidated:
#    - server/.env + server/.env.production -> .env + .env.production
#    - config/*.yaml keys mapped to environment variables where appropriate
#    - Feature flags from config/flags.json can be overridden here
#
# 2. Renamed variables (update your code):
#    - NEO4J_USERNAME -> NEO4J_USER
#    - OLD_JWT_SECRET -> JWT_SECRET
#    - POSTGRES_URL -> DATABASE_URL (standardized)
#
# 3. Removed duplicate loaders:
#    - Use ONLY server/src/config.ts (Zod-based validation)
#    - Delete server/config.ts (YAML loader)
#    - Delete server/src/config/index.ts (duplicate loader)
#    - Delete server/src/config/index.js (legacy CommonJS)
#
# 4. Config loading order (final recommendation):
#    a. Load .env file (or .env.production in production)
#    b. Validate with Zod schema in server/src/config.ts
#    c. Fail fast if validation fails
#    d. Load feature flags from config/flags.json (overridable by FEATURE_* env vars)
#    e. Load AI model budgets from config/model_budgets.yaml
#    f. Use distributed config service for runtime overrides (optional)
#
# 5. Security improvements:
#    - All secrets now require explicit values (no defaults)
#    - Added validation for weak passwords in production
#    - Enforced SSL for production databases
#    - CORS origins must be explicitly listed
#
# ============================================================================
# END OF CONFIGURATION
# ============================================================================
