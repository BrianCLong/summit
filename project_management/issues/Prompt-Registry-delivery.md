# Prompt Registry: Governed Prompt Lifecycle

Branch: feat/prompt-registry
Path: /ai/prompt-registry
Labels: track:ai, feature:PROMPT_REGISTRY_ENABLED, ci:lint, ci:unit, ci:contract, ci:playwright, preview-env, auto-rollback

## Mission
- Stand up a governed prompt registry with typed schemas, lineage, and rollout controls for AI prompts and agents.
- Provide contract-tested APIs and event feeds for prompt publication, review, and rollout with feature-flagged exposure.

## Deliverables
- `/ai/prompt-registry` scaffold with typed models, registry API surface, and event emitters for lifecycle changes.
- CI gates for lint, unit, contract, and Playwright flows validating registry UX/CLI paths.
- Preview environment and rollback validation steps wired into the feature workflow.

## Constraints
- No shared DBs with other services; registry uses isolated storage or mocked adapters with typed APIs.
- Deterministic test data for prompts (seeded fixtures) and reproducible agent behaviors.
- PII redaction enforced for stored prompts, logs, and generated artifacts; governance audit trail maintained.

## Definition of Done / CI Gates
- [ ] Lint: `pnpm run lint` with `FEATURE_PROMPT_REGISTRY_ENABLED=true`.
- [ ] Unit: `pnpm run test:unit` with seeded registry fixtures.
- [ ] Contract: `pnpm run test:policy` for API/event validation.
- [ ] Playwright: `pnpm run e2e` covering registry UX behind the flag.
- [ ] Preview env smoke: `bash scripts/preview-local.sh help` confirms preview availability.
- [ ] Auto-rollback hook: `bash scripts/validate-rollback.sh --help` confirms rollback validation flow.

## Acceptance Checklist
- [ ] Autogenerated coverage thresholds enforced for changed files.
- [ ] Deterministic prompt fixtures and replayable agent behaviors.
- [ ] PII/SPI redaction validated for stored prompts, logs, and telemetry.
- [ ] Typed API/event boundaries; no shared DB coupling.
- [ ] Preview env + rollback plan linked in PR using `.github/PULL_REQUEST_TEMPLATE.md`.
- [ ] Feature flag default OFF until governance sign-off.

## Kickoff Meta-Prompt
> Align on typed prompt schemas, registry API, and event boundaries (no shared DBs). Identify dependencies (feature flags, governance controls, telemetry sinks). Confirm deterministic fixtures and redaction posture. Lock CI gates (lint, unit, contract, Playwright, preview smoke, rollback validation). Deliver via `feat/prompt-registry` with preview env + auto-rollback hooks and documented rollout.
