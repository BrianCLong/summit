# ATSH: Autonomous Test Safety Harness

Branch: `feat/atsh`
Labels: feature:ATSH_ENABLED, area:qa, env:preview

## Mission
Stand up an autonomous test safety harness that stress-tests resilience, regression, and compliance paths with deterministic replay, seeded data, and strict PII redaction.

## Deliverables
- Scenario packs for chaos, adversarial, and compliance use cases with replayable seeds.
- Typed API/event probes for GraphQL, REST, and message topics with contract diffs per run.
- Golden observability baselines (logs/metrics/traces) with automated drift detection and redaction checks.
- Preview environment smoke book with rollback triggers.

## Constraints
- No shared databases between harness actors and target services; use isolated fixtures per run.
- Feature flag `feature:ATSH_ENABLED` must gate every harness entrypoint and be default-off outside preview.
- Runs must be deterministic; capture seeds and dependency versions in artifacts.

## Definition of Done / CI Gates
- Lint + typecheck: `pnpm lint`, `pnpm typecheck`.
- Tests: `pnpm test:unit`, `pnpm run test:policy`, `pnpm e2e` (Playwright) against preview env.
- Contract verification: contract diffs published and failing diffs block merges.
- Feature-flag enforcement: `node scripts/ci/feature-flag-gate.js ATSH_ENABLED`.
- Preview environment + auto-rollback hooks wired in CI (see `.github/workflows/feature-branch-flags.yml`).
- Links: issue template `.github/ISSUE_TEMPLATE`, PR template `.github/PULL_REQUEST_TEMPLATE.md`.

## Acceptance Checklist
- [ ] Autogenerated tests cover â‰¥90% of new harness modules; mutation/property tests present.
- [ ] Runs are deterministic with seeded fixtures and reproducible environment manifests.
- [ ] PII and secrets are redacted in logs/traces; validation step captured in artifacts.
- [ ] Preview environment deploys per PR with cleanup/rollback hooks executed on failure.
- [ ] Contract breaks fail CI and raise blocking status checks.

## Tuning Questions
- Which services require highest chaos priority and what blast radius is acceptable?
- What PII classes require additional masking beyond standard policies?
- How should replay artifacts be retained and audited?
- What smoke paths gate rollback vs roll-forward in preview?

## Kickoff Meta-Prompt
```
Team ATSH: align on typed API/event boundaries, compensations, and data contracts. No shared databases or cross-service coupling. Depend on feature flag `feature:ATSH_ENABLED` and preview-only namespaces. Confirm owners for contract schemas, observability baselines, and rollback criteria before coding. Record assumptions, seeds, and dependencies for deterministic reruns.
```
