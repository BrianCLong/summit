# FF2: Platform Saga Orchestration

Branch: feat/saga  \
Path: /platform/saga  \
Labels: track:platform, feature:SAGA_ENABLED, gate:ci-preview

## Mission & Scope
- Stand up saga orchestration scaffolding with typed command/event APIs and per-domain isolation.
- Deliver deterministic compensating-flow tests that validate no cross-service shared DB usage and predictable retries.
- Enforce `SAGA_ENABLED` gating in CI and runtime to avoid accidental orchestration on mainline builds.

## Deliverables
- `/platform/saga` scaffold with docs on choreography vs orchestration, contract schemas, and idempotency keys.
- CI gates (lint, unit, policy/contract, Playwright) tailored to saga flows with explicit feature-flag env wiring.
- Issue/PR alignment to standard templates with labels applied for saga feature flag coverage.

## Constraints & Feature Flags
- `SAGA_ENABLED` only true on `feat/saga` workflows; main remains disabled until cutover approvals.
- Each saga stage must expose typed API surfaces; no shared transactional stores across domains.
- Retry + rollback logic must be testable deterministically with fixed seeds and clock control.

## Definition of Done / CI Gates
- Sequential gates: lint → unit → policy/contract validation → Playwright smoke on saga happy-path and failure-path drills.
- Preview environment deploy triggered from PR with saga flag; integrates with `auto-rollback.yml` on failure.
- PRs must use `.github/PULL_REQUEST_TEMPLATE.md` and reference this issue; branch follows `feat/saga` naming.

## Acceptance Checklist
- [ ] Autogenerated coverage ≥80% for saga orchestrator and compensations; reports linked in PR.
- [ ] Deterministic replay fixtures (seeded queues/timers) documented and enforced in tests.
- [ ] No shared DBs; isolation verified via contract tests and CI assertions.
- [ ] Feature flag assertions confirming `SAGA_ENABLED` scope; toggles documented in workflow logs.
- [ ] Preview environment link posted with saga toggle on; rollback hook validated for failure cases.
- [ ] Typed event schema versions committed with backward-compat notes.
- [ ] PR template checklist completed; issue link + labels present.

## Kickoff Meta-Prompt
> Teams: platform + service owners. Align on saga boundaries, command/event schemas, compensation rules, and escalation policies. Validate infrastructure dependencies (message bus, DLQ, observability) and ownership. Confirm preview namespace and rollback steps. Enforce typed contracts, ban shared DBs, and document latency/error budgets plus integration points.
