# 114: Complex Event Processing & Stream Rules (CEP)

Track: Feature Flags
Branch: feat/cep
Labels: feature-flag, area:streaming, area:rules, ci:e2e

## Summary
Deliver a real-time CEP engine with rules DSL and adapters for Redis/Kafka, handling sliding/tumbling windows, joins, and sequence patterns. Provide APIs and a UI composer, all gated by CEP_ENABLED.

## Deliverables
- Service at `/services/cep` (Go/Node) implementing DSL constructs: AFTER, WITHIN, EVERY; tumbling/sliding windows; watermarking.
- Adapters for Redis and Kafka; at-least-once delivery with idempotent emits; LAC label propagation; no payload PII storage.
- APIs: POST `/rules`, GET `/runs/:id`, POST `/dryrun`.
- UI rule composer with live match preview and jQuery chips for window/sequence blocks.

## Constraints
- Enforce watermark/lateness handling defaults; ensure idempotent emissions.
- Feature flag gating via `CEP_ENABLED`.

## DoD / CI Gates
- Fixture corpus for sequences and joins; watermark correctness validation.
- k6 soak tests for throughput; Playwright “author → preview → deploy” E2E.
- Contract/unit tests for DSL parsing, adapters, and API responses.

## Open Questions (Tuning)
- Default lateness/watermark policy?
- Starter rules to ship (burst, fan-out, rare metapath)?

## Parallelization Notes
- Consumes streams and emits typed events in an isolated runtime; no shared DB coupling.
