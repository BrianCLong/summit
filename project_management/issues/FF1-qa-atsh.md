# FF1: QA ATSH Safety Harness

Branch: feat/atsh  \
Path: /qa/atsh  \
Labels: track:qa, feature:ATSH_ENABLED, gate:ci-preview

## Mission & Scope
- Stand up the ATSH (Autonomous Triage Safety Harness) QA lane with typed APIs for risk scoring and guardrail injection.
- Deliver validated harness coverage for ATSH entrypoints without coupling to shared databases or mutable global state.
- Ensure CI defensively gates ATSH-specific work behind the `ATSH_ENABLED` feature flag with deterministic runs and reproducible seeds.

## Deliverables
- Initial scaffold under `/qa/atsh` with harness docs, data-contract stubs, and redaction guardrails for logs/fixtures.
- Branch-specific CI configuration (lint, unit, policy/contract, Playwright) with preview-environment handshake and auto-rollback hook.
- Issue/PR wiring that references standard templates and enforces feature flag labels on PRs.

## Constraints & Feature Flags
- `ATSH_ENABLED` must default to false on `main` and true for `feat/atsh` pipelines; gate side effects with explicit flag checks.
- No shared databases; tests rely on ephemeral fixtures or mocks and redact PII before persistence or log emission.
- Typed API/event boundaries only; cross-team contracts expressed as versioned schemas.

## Definition of Done / CI Gates
- Lint → unit → policy/contract tests → Playwright smoke executed in the feature branch workflow.
- Preview environment deploys from PRs with ATSH flag on; failures dispatch `auto-rollback.yml`.
- Branch and PRs use `.github/ISSUE_TEMPLATE.md` and `.github/PULL_REQUEST_TEMPLATE.md` for traceability and checklists.

## Acceptance Checklist
- [ ] Autogenerated coverage ≥80% on ATSH code paths with reports attached to PRs.
- [ ] Deterministic test seeds documented; flakes triaged with retry budget and artifacts.
- [ ] PII redaction/obfuscation applied to fixtures, logs, and telemetry exports.
- [ ] Feature flag toggles validated (ATSH enabled on branch, off on main) and asserted in CI job outputs.
- [ ] Preview environment URL posted to PR with smoke status; rollback hook verified on failed gates.
- [ ] Contract expectations versioned and linked to typed schema snapshots.
- [ ] Branch follows `feat/atsh`; PRs linked to this issue with template checklists completed.

## Kickoff Meta-Prompt
> Teams: QA + platform reliability. Define typed request/response contracts for ATSH harness, isolate state (no shared DBs), and align on event boundaries before implementation. Identify dependencies (security review, data governance) and owners. Confirm preview env path, rollback triggers, and how feature flags will gate any new runtime behaviors. Document success metrics (coverage, latency budgets, guardrail hit rate) and comms rhythm.
