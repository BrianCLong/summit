# FF3: AI Prompt Registry Hardening

Branch: feat/prompt-registry  \
Path: /ai/prompt-registry  \
Labels: track:ai, feature:PROMPT_REGISTRY_ENABLED, gate:ci-preview

## Mission & Scope
- Stand up a governed prompt registry with typed schemas for prompts, evaluations, and feature-flag-aware rollout.
- Deliver deterministic evaluation harnesses (autogen tests, replayable data) to prevent drift and ensure reproducibility.
- Guard against PII exposure in prompts/responses with redaction and audit trails; avoid shared DBs with other domains.

## Deliverables
- `/ai/prompt-registry` scaffold with docs for schema definitions, lifecycle hooks, and evaluation pipelines.
- CI workflow coverage (lint, unit, policy/contract, Playwright) with `PROMPT_REGISTRY_ENABLED` flag toggles and preview deploy hook.
- Issues/PR templates referenced with labels applied for prompt-registry feature work.

## Constraints & Feature Flags
- Registry toggles on `feat/prompt-registry` pipelines; disabled on `main` until readiness gates pass.
- Typed API/event boundaries only; evaluations consume versioned prompt artifacts and do not share DB tables with other services.
- Tests must be deterministic with seeded evaluators and snapshot redaction for sensitive content.

## Definition of Done / CI Gates
- Lint → unit → policy/contract → Playwright sequencing enforced in the feature-branch workflow.
- Preview environment spins for PRs with prompt-registry flag enabled; failure triggers `auto-rollback.yml` dispatch.
- PRs must link to this issue, use `.github/PULL_REQUEST_TEMPLATE.md`, and respect the `feat/prompt-registry` branch naming.

## Acceptance Checklist
- [ ] Autogenerated coverage ≥80% for prompt registry modules and evaluators with artifacts attached to PR.
- [ ] Deterministic evaluation seeds and snapshot baselines documented; flakes triaged with rerun policy.
- [ ] PII redaction applied to prompt payloads, logs, and stored artifacts.
- [ ] Feature flag assertions prove `PROMPT_REGISTRY_ENABLED` scope in CI logs.
- [ ] Preview environment URL recorded with smoke status; rollback hook validated for failure.
- [ ] Typed schema versions committed with changelog notes; contract consumers notified.
- [ ] PR template checklist completed; labels applied and issue link present.

## Kickoff Meta-Prompt
> Teams: AI/ML + platform reliability. Define prompt schema and evaluation contracts, agree on event boundaries, and prevent shared DB usage. Identify dependencies (model registry, observability, privacy review) and owners. Confirm preview env path, rollback flow, and success metrics (coverage, eval stability, redaction effectiveness). Align communication cadence before implementation.
