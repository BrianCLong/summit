# Prompt Registry: Governed Prompt Store

Branch: `feat/prompt-registry`
Labels: feature:PROMPT_REGISTRY_ENABLED, area:ai, env:preview

## Mission
Ship a governed prompt registry with typed manifests, deterministic evaluations, and evented rollouts for AI consumers.

## Deliverables
- Prompt manifests with metadata (owner, version, guardrails, evaluators, PII classifications).
- Evaluation harness with autogenerated coverage and deterministic seeds per prompt change.
- Contract-first APIs/events for prompt fetch, diff, rollout, and notifications.
- Preview environment pipeline with rollback to prior bundle on regression signals.

## Constraints
- Feature flag `feature:PROMPT_REGISTRY_ENABLED` gates all surfaces; default-off outside preview.
- No shared databases with product workloads; signed artifacts only.
- Deterministic seeds and eval manifests stored with artifacts for replayability.

## Definition of Done / CI Gates
- Lint + typecheck: `pnpm lint`, `pnpm typecheck`.
- Tests: prompt evaluator unit suites, contract tests, Playwright for UI flows if present.
- Feature-flag enforcement: `node scripts/ci/feature-flag-gate.js PROMPT_REGISTRY_ENABLED`.
- Preview environment creation with rollback hook (see `.github/workflows/feature-branch-flags.yml`).
- Links: issue template `.github/ISSUE_TEMPLATE`, PR template `.github/PULL_REQUEST_TEMPLATE.md`.

## Acceptance Checklist
- [ ] Autogenerated eval coverage â‰¥90% for prompt changes; seeds captured and reproducible.
- [ ] Deterministic runs validated with stable snapshots and noise controls.
- [ ] PII/secret redaction verified on prompt payloads, logs, and artifacts.
- [ ] Preview env deploy + rollback executed; bundle rollback validated.
- [ ] Contract diffs published and enforced in CI.

## Tuning Questions
- What rollout policy (gradual vs cohort) should govern prompt promotions?
- Which PII classes are disallowed in prompt corpora, and how are detections enforced?
- What alerting thresholds trigger automatic rollback vs manual approval?
- Which consumers need typed SDKs first (REST, GraphQL, event clients)?

## Kickoff Meta-Prompt
```
Team Prompt Registry: define typed API/event boundaries and guardrails for prompt artifacts. No shared databases; rely on signed bundles and versioned manifests. Feature flag `feature:PROMPT_REGISTRY_ENABLED` gates all surfaces until preview validation passes. Align owners for schema governance, evaluators, rollout/rollback signals, and PII redaction paths. Capture deterministic seeds for every eval run.
```
