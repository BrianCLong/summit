apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata: { name: server-netpol }
spec:
  podSelector: { matchLabels: { app: server } }
  policyTypes: [Ingress]
  ingress:
    - from:
        - namespaceSelector:
            { matchLabels: { kubernetes.io/metadata.name: ingress } }
      ports: [{ protocol: TCP, port: 4000 }]
    - from:
        - namespaceSelector:
            { matchLabels: { kubernetes.io/metadata.name: monitoring } }
      ports: [{ protocol: TCP, port: 4000 }]
