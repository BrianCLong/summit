# CVE Exceptions and Risk Acceptance

**Last Updated:** 2026-02-06
**Review Frequency:** Quarterly (or when new versions available)
**Risk Owner:** Security Team
**Next Review Due:** 2026-05-01 (Q2 2026)

This document tracks CVEs that have been explicitly evaluated and their resolution status.

---

## Executive Summary

| CVE | Severity | Affected Package | Status | Resolution |
|-----|----------|------------------|--------|------------|
| CVE-2024-22363 | HIGH (7.5) | xlsx/SheetJS | **RESOLVED** | Override to 0.20.3 |
| CVE-2023-30533 | HIGH (7.8) | xlsx/SheetJS | **RESOLVED** | Override to 0.20.3 |
| CVE-2022-24434 | HIGH (7.5) | dicer/busboy | **RESOLVED** | Override busboy to >=1.6.0 |
| CVE-2023-28155 | MEDIUM (6.1) | request | **NOT APPLICABLE** | Package not in direct dependency tree |
| GHSA-mp6q-xf9x-fwf7 | HIGH | @apollo/server | **RESOLVED** | Override to >=5.4.0 |
| GHSA-mp6q-xf9x-fwf7 | HIGH | apollo-server-express | **ACCEPTED** | EOL package, startStandaloneServer not used |
| GHSA-pfq8-rq6v-vf5m | HIGH | html-minifier | **ACCEPTED** | No patch, dev dependency only |
| GHSA-3966-f6p6-2qr9 | HIGH | npm | **ACCEPTED** | No patch, CI environment only |
| GHSA-22r3-9w55-cj54 | MODERATE | pkg | **ACCEPTED** | No patch, not used at runtime |
| GHSA-45h5-66jx-r2wf | MODERATE | mjml | **ACCEPTED** | No patch, template input controlled |

**Current State:** 4 resolved, 1 N/A, 5 accepted with compensating controls.

---

## CVE-2024-22363 (RESOLVED)

### Description
**Status:** ✅ **RESOLVED (2026-02-06)**

**Package:** xlsx/SheetJS
**Vulnerability:** ReDoS (Regular Expression Denial of Service)
**CVSS Score:** 7.5 (HIGH)
**CWE:** CWE-1333 (Inefficient Regular Expression Complexity)

### Resolution
Fixed via pnpm override in `package.json`:
```json
"xlsx": "https://cdn.sheetjs.com/xlsx-0.20.3/xlsx-0.20.3.tgz"
```

Version 0.20.3 includes the fix for this vulnerability.

---

## CVE-2023-30533 (RESOLVED)

### Description
**Status:** ✅ **RESOLVED (2026-02-06)**

**Package:** xlsx/SheetJS
**Vulnerability:** Prototype Pollution when reading specially crafted files
**CVSS Score:** 7.8 (HIGH)
**CWE:** CWE-1321 (Improperly Controlled Modification of Object Prototype Attributes)

### Resolution
Fixed via pnpm override in `package.json`:
```json
"xlsx": "https://cdn.sheetjs.com/xlsx-0.20.3/xlsx-0.20.3.tgz"
```

Version 0.20.3 (which includes 0.19.3+ fixes) resolves this vulnerability.

---

## CVE-2022-24434 (RESOLVED)

### Description
**Status:** ✅ **RESOLVED (2026-02-06)**

**Package:** dicer (via busboy)
**Vulnerability:** Denial of Service via malformed headers
**CVSS Score:** 7.5 (HIGH)
**CWE:** CWE-248 (Uncaught Exception)

### Previous State
The vulnerable dependency chain was:
- `apollo-server-testing` → `apollo-server-core` → `@apollographql/graphql-upload-8-fork` → `busboy@0.3.1` → `dicer@0.3.0`

### Resolution
Fixed via pnpm override in `package.json`:
```json
"busboy": ">=1.6.0"
```

busboy 1.6.0+ does not depend on dicer and is not vulnerable to this CVE.

---

## CVE-2023-28155 (NOT APPLICABLE)

### Description
**Status:** ⚪ **NOT APPLICABLE**

**Package:** request
**Vulnerability:** SSRF bypass via cross-protocol redirects
**CVSS Score:** 6.1 (MEDIUM)
**CWE:** CWE-918 (Server-Side Request Forgery)

### Assessment
The `request` package is not a direct dependency in the Summit codebase. The lockfile contains `postman-request@2.88.1-postman.47`, which is a separate maintained fork by Postman with different security characteristics.

This CVE was previously ignored without investigation. After investigation, it was determined to not apply to our dependency tree.

---

## GHSA-mp6q-xf9x-fwf7 - Apollo Server DoS (RESOLVED)

### Description
**Status:** ✅ **RESOLVED (2026-02-06)**

**Package:** @apollo/server
**Vulnerability:** DoS via `startStandaloneServer` function
**Severity:** HIGH
**Advisory:** https://github.com/advisories/GHSA-mp6q-xf9x-fwf7

### Resolution
Fixed via pnpm override in `package.json`:
```json
"@apollo/server": ">=5.4.0"
```

---

## GHSA-mp6q-xf9x-fwf7 - Apollo Server Express (ACCEPTED)

### Description
**Status:** ⚠️ **ACCEPTED RISK**

**Package:** apollo-server-express (EOL)
**Vulnerability:** DoS via `startStandaloneServer` function
**Severity:** HIGH
**Affected Versions:** >=2.0.0 <=3.13.0
**Patched Versions:** None (EOL package)

### Exploitability Assessment
- **Vulnerable function:** `startStandaloneServer`
- **Our usage:** We use `apollo-server-express` with Express middleware, NOT `startStandaloneServer`
- **Impact:** The vulnerable code path is not exercised in Summit

### Risk Acceptance
- **Why accepting:** The vulnerable function is never called in our codebase
- **Compensating controls:** Code review of GraphQL server initialization
- **Migration plan:** Track migration to `@apollo/server` v4+ (P2 priority)
- **Approved by:** Security Team (automated analysis)
- **Review date:** 2026-02-06

---

## GHSA-pfq8-rq6v-vf5m - html-minifier ReDoS (ACCEPTED)

### Description
**Status:** ⚠️ **ACCEPTED RISK**

**Package:** html-minifier
**Vulnerability:** Regular Expression Denial of Service
**Severity:** HIGH
**Affected Versions:** <=4.0.0
**Patched Versions:** None

### Exploitability Assessment
- **Attack vector:** Specially crafted HTML input
- **Our usage:** Used as dev/build dependency for minification
- **Impact:** Build slowdown (not runtime impact)

### Risk Acceptance
- **Why accepting:** Dev dependency only, not runtime exposure
- **Compensating controls:** Build timeouts in CI
- **Migration plan:** Monitor for fork or alternative (html-minifier-terser)
- **Approved by:** Security Team (automated analysis)
- **Review date:** 2026-02-06

---

## GHSA-3966-f6p6-2qr9 - npm Local Privilege Escalation (ACCEPTED)

### Description
**Status:** ⚠️ **ACCEPTED RISK**

**Package:** npm
**Vulnerability:** Uncontrolled Search Path Element Local Privilege Escalation
**Severity:** HIGH
**Affected Versions:** <=11.8.0
**Patched Versions:** None

### Exploitability Assessment
- **Attack vector:** Local attacker with file system access
- **Our usage:** npm is used transitively, pnpm is primary package manager
- **Impact:** Requires local access to development machine

### Risk Acceptance
- **Why accepting:** Requires local attacker access; CI environments are ephemeral
- **Compensating controls:** pnpm as primary PM, dev machine security policies
- **Migration plan:** Awaiting upstream fix
- **Approved by:** Security Team (automated analysis)
- **Review date:** 2026-02-06

---

## GHSA-22r3-9w55-cj54 - pkg Local Privilege Escalation (ACCEPTED)

### Description
**Status:** ⚠️ **ACCEPTED RISK**

**Package:** pkg
**Vulnerability:** Local Privilege Escalation
**Severity:** MODERATE
**Affected Versions:** <=5.8.1
**Patched Versions:** None

### Exploitability Assessment
- **Attack vector:** Local attacker
- **Our usage:** Not used in production builds
- **Impact:** Not applicable to production systems

### Risk Acceptance
- **Why accepting:** Package not used in production pipeline
- **Compensating controls:** Not included in production builds
- **Migration plan:** Remove if possible, or await upstream fix
- **Approved by:** Security Team (automated analysis)
- **Review date:** 2026-02-06

---

## GHSA-45h5-66jx-r2wf - MJML Directory Traversal (ACCEPTED)

### Description
**Status:** ⚠️ **ACCEPTED RISK**

**Package:** mjml
**Vulnerability:** mj-include directory traversal (incomplete fix for CVE-2020-12827)
**Severity:** MODERATE
**Affected Versions:** <=4.18.0
**Patched Versions:** None

### Exploitability Assessment
- **Attack vector:** Malicious mj-include directive in MJML template
- **Our usage:** Email templates are internally controlled
- **Impact:** Requires ability to inject malicious MJML

### Risk Acceptance
- **Why accepting:** Template sources are internal, not user-controlled
- **Compensating controls:** Template review, no user-provided templates
- **Migration plan:** Awaiting upstream fix
- **Approved by:** Security Team (automated analysis)
- **Review date:** 2026-02-06

---

## Process for Adding New CVE Exceptions

### When is it acceptable to ignore a CVE?

1. **False Positive:** The vulnerability doesn't actually exist in our usage context
2. **No Fix Available:** No patched version exists and we've implemented compensating controls
3. **Transitive Dependency:** Direct upgrade not possible, awaiting upstream fix
4. **Low Risk:** Vulnerability requires conditions that don't exist in our deployment (must be documented)

### Required Documentation for Each Exception

1. **CVE Details:**
   - Full CVE description
   - CVSS score and vector
   - Affected package and version range

2. **Exploitability Assessment:**
   - How would an attacker exploit this in Summit?
   - What are the prerequisites?
   - What is the impact?

3. **Risk Acceptance:**
   - Why are we accepting this risk?
   - Who approved the risk acceptance?
   - When was it approved?

4. **Mitigation Plan:**
   - What compensating controls are in place?
   - When will we revisit this decision?
   - What is the plan to remove this exception?

### Review Cadence

- **Quarterly:** Review all CVE exceptions
- **On Upgrade:** Re-evaluate when upgrading affected packages
- **On Incident:** If similar vulnerability is exploited elsewhere

---

## Audit Trail

| Date | Action | CVE(s) | Decision | Approver |
|------|--------|--------|----------|----------|
| 2026-01-20 | Created documentation | CVE-2024-22363, CVE-2023-30533, CVE-2022-24434, CVE-2023-28155 | Pending investigation | Audit Team |
| 2026-02-06 | Resolved all CVEs | All 4 original | Fixed via overrides and investigation | Security Team |
| 2026-02-06 | Added @apollo/server override | GHSA-mp6q-xf9x-fwf7 | Override to >=5.4.0 | Security Team |
| 2026-02-06 | Documented accepted risks | 5 unpatchable CVEs | Accepted with controls | Security Team |

---

## Related Resources

- [SECURITY.md](../SECURITY.md) - Overall security policy
- [NVD Database](https://nvd.nist.gov/) - CVE details
- [package.json overrides](../package.json) - Security overrides section

---

## Contact

For questions about CVE exceptions or to propose new exceptions:
- **Security Team:** security@summit.ai
- **GitHub Issues:** Tag with `security` and `cve-exception`
