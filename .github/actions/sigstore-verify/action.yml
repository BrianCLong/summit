name: 'Sigstore Verify'
description: 'Verifies Sigstore signatures for artifacts'
inputs:
  artifact-path:
    description: 'Path to the artifact to verify'
    required: true
  signature-path:
    description: 'Path to the signature file'
    required: false
  certificate-path:
    description: 'Path to the certificate file'
    required: false
  identity:
    description: 'Expected identity'
    required: false
  issuer:
    description: 'Expected OIDC issuer'
    required: false

runs:
  using: "composite"
  steps:
    - name: Install Cosign
      uses: sigstore/cosign-installer@v3.5.0

    - name: Verify Signature
      shell: bash
      run: |
        .github/scripts/sigstore/verify.sh \
          "${{ inputs.artifact-path }}" \
          "${{ inputs.signature-path }}" \
          "${{ inputs.certificate-path }}" \
          "${{ inputs.identity }}" \
          "${{ inputs.issuer }}"
