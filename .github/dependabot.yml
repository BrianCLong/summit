version: 2
updates:
  - package-ecosystem: 'npm'
    directory: '/'
    schedule: { interval: 'weekly', day: 'monday', time: '07:00' }
    groups:
      react-stack:
        patterns: ['react*', 'react-*-*', 'next*', 'zustand*', 'redux*']
      tooling:
        patterns:
          [
            'eslint*',
            'prettier*',
            'typescript',
            'ts-*',
            'vite*',
            'vitest*',
            '@types/*',
          ]
      ui-graphics:
        patterns:
          ['@mui/*', 'three*', 'd3*', 'canvas*', 'mapbox*', 'react-map-gl*']
      minor-patch:
        update-types: ['minor', 'patch']
    open-pull-requests-limit: 15
  - package-ecosystem: 'github-actions'
    directory: '/'
    schedule: { interval: 'weekly', day: 'monday', time: '06:00' }
    commit-message:
      prefix: 'ci'
      include: 'scope'
    labels: ['dependencies', 'github-actions', 'security']
    reviewers: ['security-team']
    open-pull-requests-limit: 10
  - package-ecosystem: 'npm'
    directory: '/'
    schedule: { interval: 'daily' } # security only
    allow: [{ dependency-type: 'direct' }]
    labels: ['security-blocker']
    ignore:
      - dependency-name: '*'
        update-types: ['version-update:semver-major'] # security lane only
  # Docker - Monitor Dockerfile base images
  - package-ecosystem: 'docker'
    directory: '/'
    schedule: { interval: 'weekly', day: 'monday', time: '06:00' }
    commit-message:
      prefix: 'docker'
      include: 'scope'
    labels: ['dependencies', 'docker', 'security']
    reviewers: ['security-team']
    open-pull-requests-limit: 10
  - package-ecosystem: 'docker'
    directory: '/server'
    schedule: { interval: 'weekly' }
    commit-message:
      prefix: 'docker'
    labels: ['dependencies', 'docker']
  - package-ecosystem: 'docker'
    directory: '/client'
    schedule: { interval: 'weekly' }
    commit-message:
      prefix: 'docker'
    labels: ['dependencies', 'docker']
