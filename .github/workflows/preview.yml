on: pull_request
jobs:
  preview:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Helm install preview
        run: |
          ns=preview-${{ github.event.pull_request.number }}
          kubectl create ns $ns || true
          helm upgrade --install maestro charts/maestro -n $ns --set image.tag=pr-${{ github.sha }} --set preview=true
      - name: Comment URL
        run: echo "Preview at https://maestro-${{ github.event.pull_request.number }}.dev"  # replace with ingress logic