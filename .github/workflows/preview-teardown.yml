name: preview-teardown
on:
  pull_request:
    types: [closed]
jobs:
  teardown:
    runs-on: ubuntu-latest
    steps:
      - name: Delete preview namespace
        env: { KUBECONFIG: ${{ secrets.DEV_KUBECONFIG }} }
        run: |
          NS=pr-${{ github.event.pull_request.number }}
          kubectl delete ns $NS --ignore-not-found