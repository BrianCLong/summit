name: Oct25 Bulk Import

on:
  workflow_dispatch:
    inputs:
      start_batch:
        description: 'Start batch number'
        required: true
        default: '1'
      end_batch:
        description: 'End batch number'
        required: true
        default: '10'
      sleep_ms:
        description: 'Sleep time in milliseconds'
        required: true
        default: '250'
      concurrency:
        description: 'Number of concurrent jobs'
        required: true
        default: '3'

jobs:
  bulk-import:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Run bulk import
        env:
          GH_TOKEN: ${{ secrets.PAT_PROJECT }}
          OWNER: ${{ github.repository_owner }}
          REPO: ${{ github.event.repository.name }}
          PROJECT_ID: "PVT_kwHOAGG3w84BEh1S"
          START_BATCH: ${{ github.event.inputs.start_batch }}
          END_BATCH: ${{ github.event.inputs.end_batch }}
          SLEEP_MS: ${{ github.event.inputs.sleep_ms }}
          CONCURRENCY: ${{ github.event.inputs.concurrency }}
        run: |
          node scripts/oct25_bulk_issue_import.cjs
