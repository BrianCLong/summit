name: Infra Parity
on:
  pull_request:
    branches: [main]
    paths: ["infra/**", ".github/workflows/infra-parity.yml"]
jobs:
  parity:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    steps:
      - uses: actions/checkout@v4
      - uses: hashicorp/setup-terraform@v3
        with: {terraform_version: 1.8.5}
      - name: Parity â‰¥95%
        run: |
          chmod +x infra/scripts/validate_parity.sh
          THRESHOLD=95 infra/scripts/validate_parity.sh staging preprod
