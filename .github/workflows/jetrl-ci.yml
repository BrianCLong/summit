name: Jet-RL CI
on: [push, pull_request]
jobs:
  tests:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with: { python-version: "3.11" }
      - run: pip install pytest jsonschema torch
      # Only run tests that actually exist
      - run: |
          if [ -f tests/test_precision_flow_policy.py ]; then
            pytest tests/test_precision_flow_policy.py tests/test_detectors_deny_by_default.py
          else
            echo "Warning: tests/test_precision_flow_policy.py not found, running only available tests"
            pytest tests/test_detectors_deny_by_default.py
          fi
  evidence:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with: { python-version: "3.11" }
      - run: pip install jsonschema
      - run: python tools/validate_evidence_schemas.py
