name: Phishing Cluster
version: 1.0
description: Identify and analyze phishing campaign clusters

tasks:
  - id: email_ingest
    name: Ingest Email Data
    uses: connector:elastic
    with:
      index: "email-security-*"
      query: "phishing OR suspicious"
      time_range: "7d"

  - id: url_extraction
    name: Extract URLs and Domains
    uses: graph:entity-resolution
    needs: [email_ingest]
    with:
      entity_types: ["url", "domain", "ip"]
      similarity_threshold: 0.85

  - id: campaign_clustering
    name: Cluster Campaigns
    uses: ml:forecast
    needs: [url_extraction]
    with:
      algorithm: "dbscan"
      features: ["domain_similarity", "timing", "targets"]

  - id: threat_scoring
    name: Score Threat Level
    uses: analyze:risk
    needs: [campaign_clustering]
    with:
      scoring_model: "phishing-impact-v2"

  - id: attribution
    name: Threat Actor Attribution
    uses: xai:explanations
    needs: [threat_scoring]
    with:
      model: "attribution-v1"
      confidence_threshold: 0.7

  - id: export_intel
    name: Export Threat Intelligence
    uses: export:bundle
    needs: [attribution]
    with:
      format: "stix-bundle"
      include_iocs: true

kpis:
  - cluster_accuracy
  - false_positive_rate
  - time_to_detection

xai_notes: Attribution confidence must exceed 70% for actionable intel