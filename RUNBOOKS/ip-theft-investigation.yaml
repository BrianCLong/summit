name: IP Theft Investigation
version: 1.0
description: Investigate intellectual property theft and data exfiltration

tasks:
  - id: access_pattern_analysis
    name: Analyze Access Patterns
    uses: connector:elastic
    with:
      logs: ['file-access', 'email', 'network-traffic']
      time_range: '180d'

  - id: anomaly_detection
    name: Detect Suspicious Access
    uses: ml:forecast
    needs: [access_pattern_analysis]
    with:
      anomaly_types: ['unusual_volume', 'off_hours', 'unauthorized_systems']

  - id: data_flow_mapping
    name: Map Data Flows
    uses: graph:entity-resolution
    needs: [anomaly_detection]
    with:
      entity_types: ['file', 'user', 'system', 'external_endpoint']

  - id: exfiltration_scoring
    name: Score Exfiltration Risk
    uses: analyze:risk
    needs: [data_flow_mapping]
    with:
      model: 'data-exfiltration-v3'

  - id: investigation_insights
    name: Generate Investigation Insights
    uses: xai:explanations
    needs: [exfiltration_scoring]

  - id: forensic_package
    name: Create Forensic Package
    uses: export:bundle
    needs: [investigation_insights]
    with:
      format: 'forensic-evidence'

kpis:
  - detection_accuracy
  - evidence_completeness
