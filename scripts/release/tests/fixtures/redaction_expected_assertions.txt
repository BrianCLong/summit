# Redaction Layer Test Assertions
# Used by: scripts/release/tests/redaction_layer.test.sh
#
# Format:
#   MUST_NOT_CONTAIN: <pattern>   - Patterns that must be absent after redaction
#   MUST_CONTAIN: <literal>       - Strings that must be present after redaction

# ============================================================================
# FORBIDDEN PATTERNS - Must NOT appear in sanitized output
# ============================================================================

# Issue comment and PR discussion links
MUST_NOT_CONTAIN: issuecomment-
MUST_NOT_CONTAIN: #discussion_r
MUST_NOT_CONTAIN: discussion_r123456789

# Internal domains
MUST_NOT_CONTAIN: \.internal\.
MUST_NOT_CONTAIN: \.corp\.
MUST_NOT_CONTAIN: @internal\.example\.com
MUST_NOT_CONTAIN: @corp\.example\.com
MUST_NOT_CONTAIN: issues\.internal\.acme\.com
MUST_NOT_CONTAIN: wiki\.internal\.acme\.com
MUST_NOT_CONTAIN: runbook\.corp\.acme\.com
MUST_NOT_CONTAIN: pagerduty\.internal\.acme\.com
MUST_NOT_CONTAIN: db\.internal\.acme\.com
MUST_NOT_CONTAIN: api\.corp\.example\.com

# GitHub tokens
MUST_NOT_CONTAIN: ghp_abc123def456
MUST_NOT_CONTAIN: gho_secrettoken
MUST_NOT_CONTAIN: ghp_[A-Za-z0-9]{20,}

# Bearer tokens
MUST_NOT_CONTAIN: Bearer eyJ
MUST_NOT_CONTAIN: Bearer debug_token

# API keys and secrets
MUST_NOT_CONTAIN: api_key=sk_live
MUST_NOT_CONTAIN: apikey: prod_key
MUST_NOT_CONTAIN: password=temporary
MUST_NOT_CONTAIN: secret: mysecret
MUST_NOT_CONTAIN: sk_live_abcdefghij

# State file references
MUST_NOT_CONTAIN: blockers_state\.json
MUST_NOT_CONTAIN: triage_state\.json
MUST_NOT_CONTAIN: remediation_state\.json
MUST_NOT_CONTAIN: handoff_state\.json
MUST_NOT_CONTAIN: digest_state\.json
MUST_NOT_CONTAIN: _state\.json

# State snapshot paths
MUST_NOT_CONTAIN: state-snapshot/
MUST_NOT_CONTAIN: state-snapshot/db-state\.json
MUST_NOT_CONTAIN: state-snapshot/full-state\.json
MUST_NOT_CONTAIN: state-snapshot/2026-01-08

# Workflow run IDs (10+ digit IDs in actions/runs/)
MUST_NOT_CONTAIN: actions/runs/12345678901

# Internal team mentions
MUST_NOT_CONTAIN: @platform-team
MUST_NOT_CONTAIN: @security-team
MUST_NOT_CONTAIN: @sre-oncall

# Internal email addresses
MUST_NOT_CONTAIN: ops@corp\.example\.com
MUST_NOT_CONTAIN: admin@internal\.example\.com

# ============================================================================
# REQUIRED PATTERNS - Must appear in sanitized output
# ============================================================================

# Section collapse markers
MUST_CONTAIN: blocker(s) - see internal report for details
MUST_CONTAIN: escalation(s) in progress
MUST_CONTAIN: Daily digest available in internal report
MUST_CONTAIN: Handoff notes available in internal report

# Redaction placeholders
MUST_CONTAIN: [REDACTED_TOKEN]
MUST_CONTAIN: [internal]
MUST_CONTAIN: [email]
MUST_CONTAIN: @[team]

# Preserved public content
MUST_CONTAIN: Release Snapshot
MUST_CONTAIN: Total Candidates
MUST_CONTAIN: Quick Links
MUST_CONTAIN: Artifacts

# Preserved safe links
MUST_CONTAIN: https://github.com/acme/summit/
MUST_CONTAIN: https://github.com/acme/summit/releases
MUST_CONTAIN: https://github.com/acme/summit/actions
MUST_CONTAIN: https://docs.acme.com/summit

# Local file links preserved
MUST_CONTAIN: release_ops_single_page.html
MUST_CONTAIN: dashboard_summary.json
MUST_CONTAIN: cycle_summary.md

# Sanitization notice
MUST_CONTAIN: Sanitized for public viewing

# ============================================================================
# SECTION REMOVAL - These sections should not appear at all
# ============================================================================

# Sections that should be completely removed
MUST_NOT_CONTAIN: ## Internal Notes
MUST_NOT_CONTAIN: ## Debug Information
MUST_NOT_CONTAIN: \[DEBUG\] Loading state
MUST_NOT_CONTAIN: \[DEBUG\] Token:
MUST_NOT_CONTAIN: \[DEBUG\] Connecting to
