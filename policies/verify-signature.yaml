apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: require-cosign-signature
spec:
  validationFailureAction: Enforce
  background: true
  rules:
    - name: verify-signature
      match:
        any:
          - resources:
              kinds: [Deployment, StatefulSet, Job, CronJob]
      verifyImages:
        - imageReferences:
            - "ghcr.io/**"
          attestors:
            - entries:
                - keyless:
                    issuer: "https://token.actions.githubusercontent.com"
                    subject: "*"
          repository: "sigstore"
