# Global settings
global:
  env: production
  imageRegistry: ghcr.io

# Subchart configurations
server:
  enabled: true
  replicaCount: 2
  image:
    repository: ghcr.io/BrianCLong/intelgraph/server
    tag: latest
  service:
    port: 4000
  env:
    - name: NODE_ENV
      value: production
    - name: PORT
      value: "4000"
    - name: POSTGRES_HOST
      value: "summit-postgres"
    - name: REDIS_HOST
      value: "summit-redis-master"
    - name: NEO4J_URI
      value: "bolt://summit-neo4j:7687"
  # Secrets managed via ExternalSecrets (see helm/server/templates/externalsecret.yaml)
  externalSecrets:
    enabled: true
    backendType: vault
  hpa:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70

client:
  enabled: true
  replicaCount: 2
  image:
    repository: ghcr.io/BrianCLong/intelgraph/client
    tag: latest
  env:
    - name: VITE_API_URL
      value: "https://api.intelgraph.com"
  serviceMonitor:
    enabled: true
  externalSecrets:
    enabled: true
    backendType: vault
  hpa:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70

# Databases
postgres:
  enabled: true
  persistence:
    size: 20Gi
  # Password provided via Secret

redis:
  enabled: true

neo4j:
  enabled: true
  env:
    - name: NEO4J_AUTH
      valueFrom:
        secretKeyRef:
          name: neo4j-secret
          key: auth

# Workers
worker-python:
  enabled: true
  image:
    repository: ghcr.io/BrianCLong/intelgraph/ingestion-service
    tag: latest
  replicas: 1
  env:
    - name: KAFKA_BOOTSTRAP_SERVERS
      value: "summit-kafka:9092"
  kafka:
    bootstrapServers: "summit-kafka:9092"
  keda:
    enabled: true

kafka:
  enabled: true

ai-service:
  enabled: false

monitoring:
  enabled: true
  grafana:
    enabled: true
  prometheus:
    enabled: true
