image:
  repository: postgres
  tag: 16-alpine
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 5432

resources:
  requests:
    cpu: 250m
    memory: 2Gi
  limits:
    cpu: 600m
    memory: 3Gi

persistence:
  enabled: true
  size: 20Gi
  storageClass: ''

env:
  - name: POSTGRES_DB
    value: intelgraph
  - name: POSTGRES_USER
    value: intelgraph
  - name: POSTGRES_PASSWORD
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: password

# Enable pgvector extension
initdb:
  enabled: true
  scripts:
    enable-extensions.sql: |
      CREATE EXTENSION IF NOT EXISTS vector;
      CREATE EXTENSION IF NOT EXISTS pg_trgm;
      CREATE EXTENSION IF NOT EXISTS btree_gin;

serviceMonitor:
  enabled: false

vpa:
  enabled: true
  updatePolicy: Auto
  minAllowed:
    cpu: 200m
    memory: 1.5Gi
  maxAllowed:
    cpu: 2
    memory: 6Gi
  controlledResources:
    - cpu
    - memory
