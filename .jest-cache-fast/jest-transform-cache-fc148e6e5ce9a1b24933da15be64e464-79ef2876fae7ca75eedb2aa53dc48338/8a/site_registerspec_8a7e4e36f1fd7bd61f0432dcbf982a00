9b88172172b7eccd866ef812881d49e5
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const register_1 = require("../src/sites/register");
test("registers site and rejects bad signatures", async () => {
    const s = await (0, register_1.registerSite)({ name: "edge-paris", region: "eu-west-1", residency: "EU", pubkey: "-----BEGIN PUBLIC KEY-----\nMIIB...\n-----END PUBLIC KEY-----\n", bandwidth: "low" });
    expect(s.region).toBe("eu-west-1");
    expect((0, register_1.verifySignature)("bad", Buffer.from("x"), "abc=")).toBe(false);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9zaXRlX3JlZ2lzdGVyLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSxvREFBc0U7QUFFdEUsSUFBSSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO0lBQzNELE1BQU0sQ0FBQyxHQUFHLE1BQU0sSUFBQSx1QkFBWSxFQUFDLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLGlFQUFpRSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQ3hMLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ25DLE1BQU0sQ0FBQyxJQUFBLDBCQUFlLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdkUsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9zaXRlX3JlZ2lzdGVyLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVnaXN0ZXJTaXRlLCB2ZXJpZnlTaWduYXR1cmUgfSBmcm9tIFwiLi4vc3JjL3NpdGVzL3JlZ2lzdGVyXCI7XG5cbnRlc3QoXCJyZWdpc3RlcnMgc2l0ZSBhbmQgcmVqZWN0cyBiYWQgc2lnbmF0dXJlc1wiLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHMgPSBhd2FpdCByZWdpc3RlclNpdGUoeyBuYW1lOiBcImVkZ2UtcGFyaXNcIiwgcmVnaW9uOiBcImV1LXdlc3QtMVwiLCByZXNpZGVuY3k6IFwiRVVcIiwgcHVia2V5OiBcIi0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXFxuTUlJQi4uLlxcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLVxcblwiLCBiYW5kd2lkdGg6IFwibG93XCIgfSk7XG4gIGV4cGVjdChzLnJlZ2lvbikudG9CZShcImV1LXdlc3QtMVwiKTtcbiAgZXhwZWN0KHZlcmlmeVNpZ25hdHVyZShcImJhZFwiLCBCdWZmZXIuZnJvbShcInhcIiksIFwiYWJjPVwiKSkudG9CZShmYWxzZSk7XG59KTtcblxuIl0sInZlcnNpb24iOjN9