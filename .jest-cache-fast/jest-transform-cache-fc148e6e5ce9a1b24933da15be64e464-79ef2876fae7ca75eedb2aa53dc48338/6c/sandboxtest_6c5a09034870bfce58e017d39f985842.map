{"file":"/Users/brianlong/Developer/summit/server/src/tests/sandbox.test.ts","mappings":";;AAAA,kDAAsD;AACtD,2DAA8C;AAE9C,MAAM,eAAe,GAAG,CAAC,GAAG,EAAE;IAC5B,IAAI,CAAC;QACH,IAAA,6BAAQ,EAAC,aAAa,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;QAC7C,OAAO,IAAI,CAAC;IACd,CAAC;IAAC,MAAM,CAAC;QACP,OAAO,KAAK,CAAC;IACf,CAAC;AACH,CAAC,CAAC,EAAE,CAAC;AAEL,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE;IACjC,EAAE,CAAC,yBAAyB,EAAE,KAAK,IAAI,EAAE;QACvC,MAAM,MAAM,CAAC,IAAA,wBAAc,EAAC,iBAAiB,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,2BAA2B,CAAC,CAAC;IAC/F,CAAC,CAAC,CAAC;IAEH,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,wBAAwB,EAAE,KAAK,IAAI,EAAE;QACpE,MAAM,IAAI,GAAG,MAAM,IAAA,wBAAc,EAAC,eAAe,CAAC,CAAC;QACnD,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5B,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/Users/brianlong/Developer/summit/server/src/tests/sandbox.test.ts"],"sourcesContent":["import { executeSandbox } from '../nl2cypher/sandbox';\nimport { execSync } from 'node:child_process';\n\nconst dockerAvailable = (() => {\n  try {\n    execSync('docker info', { stdio: 'ignore' });\n    return true;\n  } catch {\n    return false;\n  }\n})();\n\ndescribe('sandbox execution', () => {\n  it('blocks mutating queries', async () => {\n    await expect(executeSandbox('CREATE (n:Test)')).rejects.toThrow('Mutations are not allowed');\n  });\n\n  (dockerAvailable ? it : it.skip)('runs read-only queries', async () => {\n    const rows = await executeSandbox('RETURN 1 AS n');\n    expect(rows[0].n).toBe(1);\n  });\n});\n"],"version":3}