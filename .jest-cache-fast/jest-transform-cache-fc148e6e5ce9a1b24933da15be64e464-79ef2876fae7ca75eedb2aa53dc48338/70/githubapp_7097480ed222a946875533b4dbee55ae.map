{"file":"/Users/brianlong/Developer/summit/server/src/routes/github-app.ts","mappings":";;;;;AAAA,qCAAiC;AACjC,sDAA8B;AAC9B,kDAAwD;AAExD,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,MAAM,CAAC,IAAI,CACT,SAAS,EACT,iBAAO,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,kBAAkB,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EACvD,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IACjB,MAAM,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC;IACrD,IAAI,CAAC,MAAM;QAAE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IAC7D,MAAM,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC,qBAAqB,CAAC,IAAI,EAAE,CAAC;IACpD,MAAM,QAAQ,GAAG,SAAS,GAAG,IAAA,mBAAO,EAAC,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,IAAc,CAAC,CAAC;IAC3E,IAAI,CAAC,IAAA,qBAAS,EAAC,QAAQ,EAAE,GAAG,CAAC;QAAE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;IAE5E,qEAAqE;IACrE,OAAO,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AAC7B,CAAC,CACF,CAAC;AAEF,kBAAe,MAAM,CAAC","names":[],"sources":["/Users/brianlong/Developer/summit/server/src/routes/github-app.ts"],"sourcesContent":["import { Router } from 'express';\nimport express from 'express';\nimport { hmacHex, safeEqual } from '../utils/signature';\n\nconst router = Router();\n\nrouter.post(\n  '/events',\n  express.raw({ type: 'application/json', limit: '1mb' }),\n  async (req, res) => {\n    const secret = process.env.GITHUB_APP_WEBHOOK_SECRET;\n    if (!secret) return res.status(503).send('webhook disabled');\n    const sig = req.header('X-Hub-Signature-256') || '';\n    const expected = 'sha256=' + hmacHex('sha256', secret, req.body as Buffer);\n    if (!safeEqual(expected, sig)) return res.status(401).send('bad signature');\n\n    // const payload = JSON.parse((req.body as Buffer).toString('utf8'));\n    return res.sendStatus(200);\n  },\n);\n\nexport default router;\n\n"],"version":3}