a8a6c4535302e1945dea56ef07ef2799
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EnhancedAIAssistant = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
/**
 * Enhanced AI Assistant - Testable Version
 * Advanced AI interface for IntelGraph with conversation capabilities
 */
const react_1 = require("react");
const material_1 = require("@mui/material");
const icons_material_1 = require("@mui/icons-material");
const useHoldToTalk_1 = require("./hooks/useHoldToTalk"); // Correct relative path
const realClock = {
    setTimeout: (fn, ms) => window.setTimeout(fn, ms),
    clearTimeout: (id) => window.clearTimeout(id),
    now: () => Date.now(),
};
const generateResponse = async (userMessage) => {
    await new Promise((resolve) => setTimeout(resolve, 1500));
    const queryKeywords = ['find', 'show', 'search', 'query', 'get', 'list', 'analyze'];
    const containsQueryRequest = queryKeywords.some((keyword) => userMessage.toLowerCase().includes(keyword));
    let response = '';
    let confidence = 0.85;
    if (containsQueryRequest) {
        response = `I understand you're looking for data. Let me help you construct an optimized query for that. Based on your request, I'd suggest focusing on these key entities and relationships.

Would you like me to generate a specific Cypher query for this?`;
        confidence = 0.92;
    }
    else if (userMessage.toLowerCase().includes('help')) {
        response = `I'm here to help you navigate and analyze your intelligence data. I can assist with:

🔍 Query Generation: Convert natural language to optimized Cypher queries
📊 Data Analysis: Identify patterns, anomalies, and insights
🗺️ Navigation: Guide you to relevant tools and features

What specific aspect would you like help with?`;
    }
    else {
        response = `I understand your question. Based on the current context and your investigation patterns, here are some insights that might be relevant to your analysis.

Let me provide some targeted recommendations based on your query history.`;
    }
    return {
        id: `msg-${Date.now()}`,
        type: 'assistant',
        content: response,
        timestamp: new Date(),
        metadata: {
            confidence,
            sources: ['Knowledge Base', 'Query History', 'Context Analysis'],
        },
    };
};
const EnhancedAIAssistant = ({ onQueryGenerate, onNavigate, enableVoice = true, enableProactiveSuggestions = true, transport, clock = realClock, typingDelayMs = 250, debounceMs = 200, }) => {
    const messagesEndRef = (0, react_1.useRef)(null);
    const inputRef = (0, react_1.useRef)(null);
    const abortRef = (0, react_1.useRef)(null);
    const timers = (0, react_1.useRef)([]);
    const [messages, setMessages] = (0, react_1.useState)([
        {
            id: 'welcome',
            type: 'assistant',
            content: `Hello! I'm IntelBot, your Intelligence Analysis Assistant. I'm here to help you with intelligent data analysis and navigation. How can I assist you today?`,
            timestamp: new Date(),
            metadata: {
                confidence: 1.0,
                sources: ['System'],
            },
        },
    ]);
    const [inputValue, setInputValue] = (0, react_1.useState)('');
    const [isTyping, setIsTyping] = (0, react_1.useState)(false);
    const [voiceEnabled, setVoiceEnabled] = (0, react_1.useState)(enableVoice);
    const [isListening, setIsListening] = (0, react_1.useState)(false);
    const [status, setStatus] = (0, react_1.useState)('idle');
    const [streamBuf, setStreamBuf] = (0, react_1.useState)('');
    // Ref to avoid TDZ/closure issues when callbacks reference handlers defined later
    const handleSendMessageRef = (0, react_1.useRef)(() => { });
    // Voice control logic
    const startVoice = (0, react_1.useCallback)(() => {
        if (!voiceEnabled)
            return;
        setIsListening(true);
        if (window.SpeechRecognition || window.webkitSpeechRecognition) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            recognition.onstart = () => setIsListening(true);
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                handleSendMessageRef.current(transcript);
            };
            recognition.onend = () => setIsListening(false);
            recognition.start();
        }
    }, [voiceEnabled]);
    const stopVoice = (0, react_1.useCallback)(() => {
        setIsListening(false);
        // Abort any ongoing recognition if needed
        if (window.SpeechRecognition || window.webkitSpeechRecognition) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition(); // Need to get the active instance if possible
            // For simplicity, we'll just stop the current listening state.
            // A more robust solution would involve storing the recognition instance.
            // For now, the mock handles the `onend` call.
        }
    }, []);
    const holdRef = (0, useHoldToTalk_1.useHoldToTalk)(startVoice, stopVoice); // Integrate the hook
    // 🔒 keep a ref to the latest stream buffer so the event handler sees fresh data
    const streamRef = (0, react_1.useRef)('');
    (0, react_1.useEffect)(() => {
        streamRef.current = streamBuf;
    }, [streamBuf]);
    // Auto-scroll to bottom
    (0, react_1.useEffect)(() => {
        messagesEndRef.current?.scrollTo({
            top: messagesEndRef.current.scrollHeight,
            behavior: 'smooth',
        });
    }, [messages]);
    // ✅ subscribe exactly once per transport; no dependency on streamBuf
    (0, react_1.useEffect)(() => {
        if (!transport)
            return;
        const unsubscribe = transport.on((evt) => {
            if (abortRef.current?.signal.aborted)
                return;
            switch (evt.type) {
                case 'status':
                    setStatus(evt.value);
                    setIsTyping(evt.value === 'thinking' || evt.value === 'streaming');
                    break;
                case 'token':
                    setStatus('streaming');
                    setIsTyping(true);
                    setStreamBuf((s) => s + evt.value);
                    break;
                case 'done': {
                    const final = streamRef.current;
                    if (final) {
                        setMessages((m) => [
                            ...m,
                            {
                                id: `msg-${clock.now()}`,
                                type: 'assistant',
                                content: final,
                                timestamp: new Date(),
                                metadata: {
                                    confidence: 0.85,
                                    sources: ['AI Assistant'],
                                },
                            },
                        ]);
                        setStreamBuf('');
                        streamRef.current = '';
                    }
                    // 👇 microtask settle ensures DOM reflects final message before "idle"
                    Promise.resolve().then(() => setStatus('idle'));
                    setIsTyping(false);
                    break;
                }
                case 'error':
                    setStatus('error');
                    setIsTyping(false);
                    break;
            }
        });
        return () => unsubscribe();
    }, [transport, clock]);
    // Cleanup on unmount
    (0, react_1.useEffect)(() => {
        return () => {
            abortRef.current?.abort();
            timers.current.forEach(clock.clearTimeout);
            timers.current = [];
        };
    }, [clock]);
    const pushTimer = (id) => {
        timers.current.push(id);
    };
    const handleSendMessage = (0, react_1.useCallback)(async (text) => {
        const messageText = text || inputValue;
        if (!messageText.trim())
            return;
        const userMessage = {
            id: `msg-${clock.now()}`,
            type: 'user',
            content: messageText,
            timestamp: new Date(),
        };
        setMessages((prev) => [...prev, userMessage]);
        if (!text)
            setInputValue(''); // Only clear if using current input
        if (transport) {
            // Use transport for testable async behavior
            const id = clock.setTimeout(() => {
                abortRef.current?.abort();
                abortRef.current = new AbortController();
                setStatus('thinking');
                setIsTyping(true);
                // Typing indicator delay – purely cosmetic, test-controlled
                pushTimer(clock.setTimeout(() => {
                    if (!abortRef.current?.signal.aborted)
                        setStatus('streaming');
                }, typingDelayMs));
                transport.send(messageText, abortRef.current.signal);
            }, debounceMs);
            pushTimer(id);
        }
        else {
            // Fallback to original behavior for legacy usage
            setIsTyping(true);
            try {
                const assistantResponse = await generateResponse(messageText);
                setMessages((prev) => [...prev, assistantResponse]);
            }
            catch (error) {
                setMessages((prev) => [
                    ...prev,
                    {
                        id: `error-${clock.now()}`,
                        type: 'assistant',
                        content: 'I apologize, but I encountered an error processing your request. Please try again.',
                        timestamp: new Date(),
                        metadata: {
                            confidence: 0,
                            sources: ['Error Handler'],
                        },
                    },
                ]);
            }
            finally {
                setIsTyping(false);
            }
        }
    }, [inputValue, transport, clock, typingDelayMs, debounceMs]);
    // Keep ref in sync for callbacks defined earlier
    (0, react_1.useEffect)(() => {
        handleSendMessageRef.current = handleSendMessage;
    }, [handleSendMessage]);
    const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            handleSendMessage();
        }
    };
    const handleCopy = (content) => {
        navigator.clipboard.writeText(content);
    };
    const MessageBubble = ({ message }) => {
        const isUser = message.type === 'user';
        const isSystem = message.type === 'system';
        return ((0, jsx_runtime_1.jsxs)(material_1.Box, { sx: {
                display: 'flex',
                flexDirection: isUser ? 'row-reverse' : 'row',
                gap: 1,
                mb: 2,
                alignItems: 'flex-start',
            }, children: [(0, jsx_runtime_1.jsx)(material_1.Avatar, { sx: {
                        width: 32,
                        height: 32,
                        bgcolor: isUser ? 'primary.main' : 'secondary.main',
                    }, children: isUser ? (0, jsx_runtime_1.jsx)(icons_material_1.Person, { fontSize: "small" }) : (0, jsx_runtime_1.jsx)(icons_material_1.SmartToy, { fontSize: "small" }) }), (0, jsx_runtime_1.jsxs)(material_1.Paper, { elevation: 1, sx: {
                        p: 2,
                        maxWidth: '70%',
                        bgcolor: isUser ? 'primary.main' : 'background.paper',
                        color: isUser ? 'primary.contrastText' : 'text.primary',
                        borderRadius: isUser ? '16px 16px 4px 16px' : '16px 16px 16px 4px',
                    }, children: [(0, jsx_runtime_1.jsx)(material_1.Typography, { variant: "body1", sx: { mb: 1, whiteSpace: 'pre-wrap' }, children: message.content }), message.metadata && ((0, jsx_runtime_1.jsx)(material_1.Box, { sx: { mt: 1 }, children: message.metadata.confidence && ((0, jsx_runtime_1.jsx)(material_1.Chip, { label: `${(message.metadata.confidence * 100).toFixed(0)}% confident`, size: "small", variant: "outlined", sx: { mr: 1, mb: 1 } })) })), message.type === 'assistant' && ((0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { mt: 1, display: 'flex', flexDirection: 'column', gap: 1 }, children: [(0, jsx_runtime_1.jsxs)(material_1.Stack, { direction: "row", spacing: 1, sx: { flexWrap: 'wrap' }, children: [(0, jsx_runtime_1.jsx)(material_1.Button, { size: "small", variant: "outlined", onClick: () => alert('Generate query clicked!'), children: "Generate Query" }), (0, jsx_runtime_1.jsx)(material_1.Button, { size: "small", variant: "outlined", onClick: () => alert('Export analysis clicked!'), children: "Export Analysis" })] }), (0, jsx_runtime_1.jsxs)(material_1.Box, { sx: {
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'space-between',
                                        mt: 1,
                                    }, children: [(0, jsx_runtime_1.jsx)(material_1.Typography, { variant: "caption", color: "text.secondary", children: message.timestamp.toLocaleTimeString() }), (0, jsx_runtime_1.jsxs)(material_1.Stack, { direction: "row", spacing: 1, children: [(0, jsx_runtime_1.jsx)(material_1.IconButton, { size: "small", onClick: () => handleCopy(message.content), children: (0, jsx_runtime_1.jsx)(icons_material_1.ContentCopy, { fontSize: "small" }) }), !isUser && ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(material_1.IconButton, { size: "small", color: "success", onClick: () => alert('Feedback: Thumbs Up!'), children: (0, jsx_runtime_1.jsx)(icons_material_1.ThumbUp, { fontSize: "small" }) }), (0, jsx_runtime_1.jsx)(material_1.IconButton, { size: "small", onClick: () => alert('Feedback: Thumbs Down!'), children: (0, jsx_runtime_1.jsx)(icons_material_1.ThumbDown, { fontSize: "small" }) })] }))] })] })] }))] })] }));
    };
    return ((0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { height: '100%', display: 'flex', flexDirection: 'column' }, children: [(0, jsx_runtime_1.jsx)(material_1.Paper, { elevation: 1, sx: { p: 2, borderRadius: '12px 12px 0 0' }, children: (0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { display: 'flex', alignItems: 'center', justifyContent: 'space-between' }, children: [(0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { display: 'flex', alignItems: 'center', gap: 2 }, children: [(0, jsx_runtime_1.jsx)(material_1.Avatar, { sx: { bgcolor: 'secondary.main' }, children: (0, jsx_runtime_1.jsx)(icons_material_1.SmartToy, {}) }), (0, jsx_runtime_1.jsxs)(material_1.Box, { children: [(0, jsx_runtime_1.jsx)(material_1.Typography, { variant: "h6", sx: { fontWeight: 600 }, children: "IntelBot" }), (0, jsx_runtime_1.jsxs)(material_1.Typography, { variant: "caption", color: "text.secondary", role: "status", "aria-label": "assistant-status", children: ["Intelligence Analysis Assistant \u2022", ' ', status === 'thinking'
                                                    ? 'Thinking...'
                                                    : status === 'streaming'
                                                        ? 'Typing...'
                                                        : status === 'error'
                                                            ? 'Error'
                                                            : 'Online'] })] })] }), (0, jsx_runtime_1.jsxs)(material_1.Stack, { direction: "row", spacing: 1, children: [(0, jsx_runtime_1.jsx)(material_1.IconButton, { ref: holdRef, color: isListening ? 'primary' : 'default', 
                                    // onClick is now handled by the useHoldToTalk hook's onStart/onEnd
                                    // We'll keep a simplified onClick for direct toggling if needed, or remove if only hold-to-talk
                                    onClick: () => {
                                        if (isListening) {
                                            // If currently listening, a click should stop it
                                            stopVoice();
                                        }
                                        else {
                                            // If not listening, a click should start it (for tap-to-talk behavior)
                                            startVoice();
                                        }
                                    }, disabled: !voiceEnabled, "aria-label": isListening ? 'Stop Voice' : 'Start Voice', children: isListening ? (0, jsx_runtime_1.jsx)(icons_material_1.Mic, {}) : (0, jsx_runtime_1.jsx)(icons_material_1.MicOff, {}) }), (0, jsx_runtime_1.jsx)(material_1.IconButton, { "aria-label": "Settings", children: (0, jsx_runtime_1.jsx)(icons_material_1.Settings, {}) })] })] }) }), (0, jsx_runtime_1.jsxs)(material_1.Box, { sx: {
                    flex: 1,
                    overflow: 'auto',
                    p: 2,
                    bgcolor: 'background.default',
                }, role: "log", "aria-live": "polite", "data-testid": "message-log", children: [messages.map((message) => ((0, jsx_runtime_1.jsx)("div", { role: "article", "aria-label": message.type, children: (0, jsx_runtime_1.jsx)(MessageBubble, { message: message }) }, message.id))), streamBuf && ((0, jsx_runtime_1.jsx)("div", { role: "article", "aria-label": "assistant", children: (0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { display: 'flex', alignItems: 'center', gap: 1, mb: 2 }, children: [(0, jsx_runtime_1.jsx)(material_1.Avatar, { sx: { width: 32, height: 32, bgcolor: 'secondary.main' }, children: (0, jsx_runtime_1.jsx)(icons_material_1.SmartToy, { fontSize: "small" }) }), (0, jsx_runtime_1.jsx)(material_1.Paper, { elevation: 1, sx: { p: 2, borderRadius: '16px 16px 16px 4px' }, children: (0, jsx_runtime_1.jsx)(material_1.Typography, { variant: "body2", children: streamBuf }) })] }) })), isTyping && ((0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { display: 'flex', alignItems: 'center', gap: 1, mb: 2 }, children: [(0, jsx_runtime_1.jsx)(material_1.Avatar, { sx: { width: 32, height: 32, bgcolor: 'secondary.main' }, children: (0, jsx_runtime_1.jsx)(icons_material_1.SmartToy, { fontSize: "small" }) }), (0, jsx_runtime_1.jsx)(material_1.Paper, { elevation: 1, sx: { p: 2, borderRadius: '16px 16px 16px 4px' }, children: (0, jsx_runtime_1.jsx)(material_1.Typography, { variant: "body2", children: "Typing..." }) })] })), (0, jsx_runtime_1.jsx)("div", { ref: messagesEndRef })] }), (0, jsx_runtime_1.jsx)(material_1.Paper, { elevation: 1, sx: { p: 2, borderRadius: '0 0 12px 12px' }, children: (0, jsx_runtime_1.jsxs)(material_1.Box, { sx: { display: 'flex', alignItems: 'center', gap: 1 }, children: [(0, jsx_runtime_1.jsx)(material_1.TextField, { ref: inputRef, fullWidth: true, variant: "outlined", placeholder: "Ask me anything about your data...", value: inputValue, onChange: (e) => setInputValue(e.target.value), onKeyPress: handleKeyPress, disabled: isTyping, inputProps: {
                                'aria-label': 'assistant-input',
                            }, sx: {
                                '& .MuiOutlinedInput-root': {
                                    borderRadius: 3,
                                },
                            } }), (0, jsx_runtime_1.jsx)(material_1.IconButton, { color: "primary", onClick: () => handleSendMessage(), disabled: !inputValue.trim() || isTyping, sx: { p: 1.5 }, "aria-label": "send", children: (0, jsx_runtime_1.jsx)(icons_material_1.Send, {}) })] }) })] }));
};
exports.EnhancedAIAssistant = EnhancedAIAssistant;
exports.default = exports.EnhancedAIAssistant;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L2NsaWVudC9zcmMvY29tcG9uZW50cy9haS1lbmhhbmNlZC9FbmhhbmNlZEFJQXNzaXN0YW50LnRzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7OztHQUdHO0FBRUgsaUNBQXdFO0FBQ3hFLDRDQWF1QjtBQUN2Qix3REFVNkI7QUFDN0IseURBQXNELENBQUMsd0JBQXdCO0FBK0IvRSxNQUFNLFNBQVMsR0FBVTtJQUN2QixVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUM7SUFDakQsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQztJQUM3QyxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtDQUN0QixDQUFDO0FBYUYsTUFBTSxnQkFBZ0IsR0FBRyxLQUFLLEVBQUUsV0FBbUIsRUFBb0IsRUFBRTtJQUN2RSxNQUFNLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7SUFFMUQsTUFBTSxhQUFhLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNwRixNQUFNLG9CQUFvQixHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUMxRCxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUM1QyxDQUFDO0lBRUYsSUFBSSxRQUFRLEdBQUcsRUFBRSxDQUFDO0lBQ2xCLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQztJQUV0QixJQUFJLG9CQUFvQixFQUFFLENBQUM7UUFDekIs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RSxDQUFDLEVBQUUsYUFDeEQsdUJBQUMsb0JBQVMsSUFDUixHQUFHLEVBQUUsUUFBUSxFQUNiLFNBQVMsUUFDVCxPQUFPLEVBQUMsVUFBVSxFQUNsQixXQUFXLEVBQUMsb0NBQW9DLEVBQ2hELEtBQUssRUFBRSxVQUFVLEVBQ2pCLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQzlDLFVBQVUsRUFBRSxjQUFjLEVBQzFCLFFBQVEsRUFBRSxRQUFRLEVBQ2xCLFVBQVUsRUFBRTtnQ0FDVixZQUFZLEVBQUUsaUJBQWlCOzZCQUNoQyxFQUNELEVBQUUsRUFBRTtnQ0FDRiwwQkFBMEIsRUFBRTtvQ0FDMUIsWUFBWSxFQUFFLENBQUM7aUNBQ2hCOzZCQUNGLEdBQ0QsRUFFRix1QkFBQyxxQkFBVSxJQUNULEtBQUssRUFBQyxTQUFTLEVBQ2YsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLGlCQUFpQixFQUFFLEVBQ2xDLFFBQVEsRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxRQUFRLEVBQ3hDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsZ0JBQ0gsTUFBTSxZQUVqQix1QkFBQyxxQkFBSSxLQUFHLEdBQ0csSUFDVCxHQUNBLElBQ0osQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBNWRXLFFBQUEsbUJBQW1CLHVCQTRkOUI7QUFFRixrQkFBZSwyQkFBbUIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYnJpYW5sb25nL0RldmVsb3Blci9zdW1taXQvY2xpZW50L3NyYy9jb21wb25lbnRzL2FpLWVuaGFuY2VkL0VuaGFuY2VkQUlBc3Npc3RhbnQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRW5oYW5jZWQgQUkgQXNzaXN0YW50IC0gVGVzdGFibGUgVmVyc2lvblxuICogQWR2YW5jZWQgQUkgaW50ZXJmYWNlIGZvciBJbnRlbEdyYXBoIHdpdGggY29udmVyc2F0aW9uIGNhcGFiaWxpdGllc1xuICovXG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgQm94LFxuICBQYXBlcixcbiAgVHlwb2dyYXBoeSxcbiAgVGV4dEZpZWxkLFxuICBJY29uQnV0dG9uLFxuICBBdmF0YXIsXG4gIENoaXAsXG4gIFN0YWNrLFxuICBBbGVydCxcbiAgQnV0dG9uLFxuICBTd2l0Y2gsXG4gIEZvcm1Db250cm9sTGFiZWwsXG59IGZyb20gJ0BtdWkvbWF0ZXJpYWwnO1xuaW1wb3J0IHtcbiAgU2VuZCxcbiAgU21hcnRUb3ksXG4gIFBlcnNvbixcbiAgQ29udGVudENvcHksXG4gIFRodW1iVXAsXG4gIFRodW1iRG93bixcbiAgU2V0dGluZ3MsXG4gIE1pYyxcbiAgTWljT2ZmLFxufSBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsJztcbmltcG9ydCB7IHVzZUhvbGRUb1RhbGsgfSBmcm9tICcuL2hvb2tzL3VzZUhvbGRUb1RhbGsnOyAvLyBDb3JyZWN0IHJlbGF0aXZlIHBhdGhcblxuLy8gVHlwZXNcbmludGVyZmFjZSBNZXNzYWdlIHtcbiAgaWQ6IHN0cmluZztcbiAgdHlwZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIG1ldGFkYXRhPzoge1xuICAgIGNvbmZpZGVuY2U/OiBudW1iZXI7XG4gICAgc291cmNlcz86IHN0cmluZ1tdO1xuICB9O1xufVxuXG5leHBvcnQgdHlwZSBBc3Npc3RhbnRFdmVudCA9XG4gIHwgeyB0eXBlOiAnc3RhdHVzJzsgdmFsdWU6ICdpZGxlJyB8ICd0aGlua2luZycgfCAnc3RyZWFtaW5nJyB8ICdlcnJvcicgfVxuICB8IHsgdHlwZTogJ3Rva2VuJzsgdmFsdWU6IHN0cmluZyB9XG4gIHwgeyB0eXBlOiAnZG9uZScgfVxuICB8IHsgdHlwZTogJ2Vycm9yJzsgZXJyb3I6IEVycm9yIH07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXNzaXN0YW50VHJhbnNwb3J0IHtcbiAgc2VuZDogKGlucHV0OiBzdHJpbmcsIHNpZ25hbDogQWJvcnRTaWduYWwpID0+IHZvaWQ7XG4gIG9uOiAoZm46IChldnQ6IEFzc2lzdGFudEV2ZW50KSA9PiB2b2lkKSA9PiAoKSA9PiB2b2lkOyAvLyByZXR1cm5zIHVuc3Vic2NyaWJlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xvY2sge1xuICBzZXRUaW1lb3V0OiAoZm46ICgpID0+IHZvaWQsIG1zOiBudW1iZXIpID0+IG51bWJlcjtcbiAgY2xlYXJUaW1lb3V0OiAoaWQ6IG51bWJlcikgPT4gdm9pZDtcbiAgbm93OiAoKSA9PiBudW1iZXI7XG59XG5cbmNvbnN0IHJlYWxDbG9jazogQ2xvY2sgPSB7XG4gIHNldFRpbWVvdXQ6IChmbiwgbXMpID0+IHdpbmRvdy5zZXRUaW1lb3V0KGZuLCBtcyksXG4gIGNsZWFyVGltZW91dDogKGlkKSA9PiB3aW5kb3cuY2xlYXJUaW1lb3V0KGlkKSxcbiAgbm93OiAoKSA9PiBEYXRlLm5vdygpLFxufTtcblxuaW50ZXJmYWNlIEVuaGFuY2VkQUlBc3Npc3RhbnRQcm9wcyB7XG4gIG9uUXVlcnlHZW5lcmF0ZT86IChxdWVyeTogc3RyaW5nKSA9PiB2b2lkO1xuICBvbk5hdmlnYXRlPzogKHBhdGg6IHN0cmluZykgPT4gdm9pZDtcbiAgZW5hYmxlVm9pY2U/OiBib29sZWFuO1xuICBlbmFibGVQcm9hY3RpdmVTdWdnZXN0aW9ucz86IGJvb2xlYW47XG4gIHRyYW5zcG9ydD86IEFzc2lzdGFudFRyYW5zcG9ydDtcbiAgY2xvY2s/OiBDbG9jaztcbiAgdHlwaW5nRGVsYXlNcz86IG51bWJlcjsgLy8gaW5kaWNhdG9yIGRlbGF5XG4gIGRlYm91bmNlTXM/OiBudW1iZXI7IC8vIGlucHV0IGRlYm91bmNlXG59XG5cbmNvbnN0IGdlbmVyYXRlUmVzcG9uc2UgPSBhc3luYyAodXNlck1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZT4gPT4ge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxNTAwKSk7XG5cbiAgY29uc3QgcXVlcnlLZXl3b3JkcyA9IFsnZmluZCcsICdzaG93JywgJ3NlYXJjaCcsICdxdWVyeScsICdnZXQnLCAnbGlzdCcsICdhbmFseXplJ107XG4gIGNvbnN0IGNvbnRhaW5zUXVlcnlSZXF1ZXN0ID0gcXVlcnlLZXl3b3Jkcy5zb21lKChrZXl3b3JkKSA9PlxuICAgIHVzZXJNZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa2V5d29yZCksXG4gICk7XG5cbiAgbGV0IHJlc3BvbnNlID0gJyc7XG4gIGxldCBjb25maWRlbmNlID0gMC44NTtcblxuICBpZiAoY29udGFpbnNRdWVyeVJlcXVlc3QpIHtcbiAgICByZXNwb25zZSA9IGBJIHVuZGVyc3RhbmQgeW91J3JlIGxvb2tpbmcgZm9yIGRhdGEuIExldCBtZSBoZWxwIHlvdSBjb25zdHJ1Y3QgYW4gb3B0aW1pemVkIHF1ZXJ5IGZvciB0aGF0LiBCYXNlZCBvbiB5b3VyIHJlcXVlc3QsIEknZCBzdWdnZXN0IGZvY3VzaW5nIG9uIHRoZXNlIGtleSBlbnRpdGllcyBhbmQgcmVsYXRpb25zaGlwcy5cblxuV291bGQgeW91IGxpa2UgbWUgdG8gZ2VuZXJhdGUgYSBzcGVjaWZpYyBDeXBoZXIgcXVlcnkgZm9yIHRoaXM/YDtcbiAgICBjb25maWRlbmNlID0gMC45MjtcbiAgfSBlbHNlIGlmICh1c2VyTWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoZWxwJykpIHtcbiAgICByZXNwb25zZSA9IGBJJ20gaGVyZSB0byBoZWxwIHlvdSBuYXZpZ2F0ZSBhbmQgYW5hbHl6ZSB5b3VyIGludGVsbGlnZW5jZSBkYXRhLiBJIGNhbiBhc3Npc3Qgd2l0aDpcblxu8J+UjSBRdWVyeSBHZW5lcmF0aW9uOiBDb252ZXJ0IG5hdHVyYWwgbGFuZ3VhZ2UgdG8gb3B0aW1pemVkIEN5cGhlciBxdWVyaWVzXG7wn5OKIERhdGEgQW5hbHlzaXM6IElkZW50aWZ5IHBhdHRlcm5zLCBhbm9tYWxpZXMsIGFuZCBpbnNpZ2h0c1xu8J+Xuu+4jyBOYXZpZ2F0aW9uOiBHdWlkZSB5b3UgdG8gcmVsZXZhbnQgdG9vbHMgYW5kIGZlYXR1cmVzXG5cbldoYXQgc3BlY2lmaWMgYXNwZWN0IHdvdWxkIHlvdSBsaWtlIGhlbHAgd2l0aD9gO1xuICB9IGVsc2Uge1xuICAgIHJlc3BvbnNlID0gYEkgdW5kZXJzdGFuZCB5b3VyIHF1ZXN0aW9uLiBCYXNlZCBvbiB0aGUgY3VycmVudCBjb250ZXh0IGFuZCB5b3VyIGludmVzdGlnYXRpb24gcGF0dGVybnMsIGhlcmUgYXJlIHNvbWUgaW5zaWdodHMgdGhhdCBtaWdodCBiZSByZWxldmFudCB0byB5b3VyIGFuYWx5c2lzLlxuXG5MZXQgbWUgcHJvdmlkZSBzb21lIHRhcmdldGVkIHJlY29tbWVuZGF0aW9ucyBiYXNlZCBvbiB5b3VyIHF1ZXJ5IGhpc3RvcnkuYDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaWQ6IGBtc2ctJHtEYXRlLm5vdygpfWAsXG4gICAgdHlwZTogJ2Fzc2lzdGFudCcsXG4gICAgY29udGVudDogcmVzcG9uc2UsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBjb25maWRlbmNlLFxuICAgICAgc291cmNlczogWydLbm93bGVkZ2UgQmFzZScsICdRdWVyeSBIaXN0b3J5JywgJ0NvbnRleHQgQW5hbHlzaXMnXSxcbiAgICB9LFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IEVuaGFuY2VkQUlBc3Npc3RhbnQ6IFJlYWN0LkZDPEVuaGFuY2VkQUlBc3Npc3RhbnRQcm9wcz4gPSAoe1xuICBvblF1ZXJ5R2VuZXJhdGUsXG4gIG9uTmF2aWdhdGUsXG4gIGVuYWJsZVZvaWNlID0gdHJ1ZSxcbiAgZW5hYmxlUHJvYWN0aXZlU3VnZ2VzdGlvbnMgPSB0cnVlLFxuICB0cmFuc3BvcnQsXG4gIGNsb2NrID0gcmVhbENsb2NrLFxuICB0eXBpbmdEZWxheU1zID0gMjUwLFxuICBkZWJvdW5jZU1zID0gMjAwLFxufSkgPT4ge1xuICBjb25zdCBtZXNzYWdlc0VuZFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IGlucHV0UmVmID0gdXNlUmVmPEhUTUxJbnB1dEVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBhYm9ydFJlZiA9IHVzZVJlZjxBYm9ydENvbnRyb2xsZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3QgdGltZXJzID0gdXNlUmVmPG51bWJlcltdPihbXSk7XG5cbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxNZXNzYWdlW10+KFtcbiAgICB7XG4gICAgICBpZDogJ3dlbGNvbWUnLFxuICAgICAgdHlwZTogJ2Fzc2lzdGFudCcsXG4gICAgICBjb250ZW50OiBgSGVsbG8hIEknbSBJbnRlbEJvdCwgeW91ciBJbnRlbGxpZ2VuY2UgQW5hbHlzaXMgQXNzaXN0YW50LiBJJ20gaGVyZSB0byBoZWxwIHlvdSB3aXRoIGludGVsbGlnZW50IGRhdGEgYW5hbHlzaXMgYW5kIG5hdmlnYXRpb24uIEhvdyBjYW4gSSBhc3Npc3QgeW91IHRvZGF5P2AsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBjb25maWRlbmNlOiAxLjAsXG4gICAgICAgIHNvdXJjZXM6IFsnU3lzdGVtJ10sXG4gICAgICB9LFxuICAgIH0sXG4gIF0pO1xuXG4gIGNvbnN0IFtpbnB1dFZhbHVlLCBzZXRJbnB1dFZhbHVlXSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW2lzVHlwaW5nLCBzZXRJc1R5cGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFt2b2ljZUVuYWJsZWQsIHNldFZvaWNlRW5hYmxlZF0gPSB1c2VTdGF0ZShlbmFibGVWb2ljZSk7XG4gIGNvbnN0IFtpc0xpc3RlbmluZywgc2V0SXNMaXN0ZW5pbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc3RhdHVzLCBzZXRTdGF0dXNdID0gdXNlU3RhdGU8J2lkbGUnIHwgJ3RoaW5raW5nJyB8ICdzdHJlYW1pbmcnIHwgJ2Vycm9yJz4oJ2lkbGUnKTtcbiAgY29uc3QgW3N0cmVhbUJ1Ziwgc2V0U3RyZWFtQnVmXSA9IHVzZVN0YXRlKCcnKTtcbiAgLy8gUmVmIHRvIGF2b2lkIFREWi9jbG9zdXJlIGlzc3VlcyB3aGVuIGNhbGxiYWNrcyByZWZlcmVuY2UgaGFuZGxlcnMgZGVmaW5lZCBsYXRlclxuICBjb25zdCBoYW5kbGVTZW5kTWVzc2FnZVJlZiA9IHVzZVJlZjwodGV4dD86IHN0cmluZykgPT4gdm9pZD4oKCkgPT4ge30pO1xuXG4gIC8vIFZvaWNlIGNvbnRyb2wgbG9naWNcbiAgY29uc3Qgc3RhcnRWb2ljZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIXZvaWNlRW5hYmxlZCkgcmV0dXJuO1xuICAgIHNldElzTGlzdGVuaW5nKHRydWUpO1xuICAgIGlmICgod2luZG93IGFzIGFueSkuU3BlZWNoUmVjb2duaXRpb24gfHwgKHdpbmRvdyBhcyBhbnkpLndlYmtpdFNwZWVjaFJlY29nbml0aW9uKSB7XG4gICAgICBjb25zdCBTcGVlY2hSZWNvZ25pdGlvbiA9XG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5TcGVlY2hSZWNvZ25pdGlvbiB8fCAod2luZG93IGFzIGFueSkud2Via2l0U3BlZWNoUmVjb2duaXRpb247XG4gICAgICBjb25zdCByZWNvZ25pdGlvbiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbigpO1xuICAgICAgcmVjb2duaXRpb24ub25zdGFydCA9ICgpID0+IHNldElzTGlzdGVuaW5nKHRydWUpO1xuICAgICAgcmVjb2duaXRpb24ub25yZXN1bHQgPSAoZXZlbnQ6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gZXZlbnQucmVzdWx0c1swXVswXS50cmFuc2NyaXB0O1xuICAgICAgICBoYW5kbGVTZW5kTWVzc2FnZVJlZi5jdXJyZW50KHRyYW5zY3JpcHQpO1xuICAgICAgfTtcbiAgICAgIHJlY29nbml0aW9uLm9uZW5kID0gKCkgPT4gc2V0SXNMaXN0ZW5pbmcoZmFsc2UpO1xuICAgICAgcmVjb2duaXRpb24uc3RhcnQoKTtcbiAgICB9XG4gIH0sIFt2b2ljZUVuYWJsZWRdKTtcblxuICBjb25zdCBzdG9wVm9pY2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgc2V0SXNMaXN0ZW5pbmcoZmFsc2UpO1xuICAgIC8vIEFib3J0IGFueSBvbmdvaW5nIHJlY29nbml0aW9uIGlmIG5lZWRlZFxuICAgIGlmICgod2luZG93IGFzIGFueSkuU3BlZWNoUmVjb2duaXRpb24gfHwgKHdpbmRvdyBhcyBhbnkpLndlYmtpdFNwZWVjaFJlY29nbml0aW9uKSB7XG4gICAgICBjb25zdCBTcGVlY2hSZWNvZ25pdGlvbiA9XG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5TcGVlY2hSZWNvZ25pdGlvbiB8fCAod2luZG93IGFzIGFueSkud2Via2l0U3BlZWNoUmVjb2duaXRpb247XG4gICAgICBjb25zdCByZWNvZ25pdGlvbiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbigpOyAvLyBOZWVkIHRvIGdldCB0aGUgYWN0aXZlIGluc3RhbmNlIGlmIHBvc3NpYmxlXG4gICAgICAvLyBGb3Igc2ltcGxpY2l0eSwgd2UnbGwganVzdCBzdG9wIHRoZSBjdXJyZW50IGxpc3RlbmluZyBzdGF0ZS5cbiAgICAgIC8vIEEgbW9yZSByb2J1c3Qgc29sdXRpb24gd291bGQgaW52b2x2ZSBzdG9yaW5nIHRoZSByZWNvZ25pdGlvbiBpbnN0YW5jZS5cbiAgICAgIC8vIEZvciBub3csIHRoZSBtb2NrIGhhbmRsZXMgdGhlIGBvbmVuZGAgY2FsbC5cbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBob2xkUmVmID0gdXNlSG9sZFRvVGFsayhzdGFydFZvaWNlLCBzdG9wVm9pY2UpOyAvLyBJbnRlZ3JhdGUgdGhlIGhvb2tcblxuICAvLyDwn5SSIGtlZXAgYSByZWYgdG8gdGhlIGxhdGVzdCBzdHJlYW0gYnVmZmVyIHNvIHRoZSBldmVudCBoYW5kbGVyIHNlZXMgZnJlc2ggZGF0YVxuICBjb25zdCBzdHJlYW1SZWYgPSB1c2VSZWYoJycpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHN0cmVhbVJlZi5jdXJyZW50ID0gc3RyZWFtQnVmO1xuICB9LCBbc3RyZWFtQnVmXSk7XG5cbiAgLy8gQXV0by1zY3JvbGwgdG8gYm90dG9tXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudD8uc2Nyb2xsVG8oe1xuICAgICAgdG9wOiBtZXNzYWdlc0VuZFJlZi5jdXJyZW50LnNjcm9sbEhlaWdodCxcbiAgICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcbiAgICB9KTtcbiAgfSwgW21lc3NhZ2VzXSk7XG5cbiAgLy8g4pyFIHN1YnNjcmliZSBleGFjdGx5IG9uY2UgcGVyIHRyYW5zcG9ydDsgbm8gZGVwZW5kZW5jeSBvbiBzdHJlYW1CdWZcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIXRyYW5zcG9ydCkgcmV0dXJuO1xuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gdHJhbnNwb3J0Lm9uKChldnQpID0+IHtcbiAgICAgIGlmIChhYm9ydFJlZi5jdXJyZW50Py5zaWduYWwuYWJvcnRlZCkgcmV0dXJuO1xuXG4gICAgICBzd2l0Y2ggKGV2dC50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3N0YXR1cyc6XG4gICAgICAgICAgc2V0U3RhdHVzKGV2dC52YWx1ZSk7XG4gICAgICAgICAgc2V0SXNUeXBpbmcoZXZ0LnZhbHVlID09PSAndGhpbmtpbmcnIHx8IGV2dC52YWx1ZSA9PT0gJ3N0cmVhbWluZycpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd0b2tlbic6XG4gICAgICAgICAgc2V0U3RhdHVzKCdzdHJlYW1pbmcnKTtcbiAgICAgICAgICBzZXRJc1R5cGluZyh0cnVlKTtcbiAgICAgICAgICBzZXRTdHJlYW1CdWYoKHMpID0+IHMgKyBldnQudmFsdWUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkb25lJzoge1xuICAgICAgICAgIGNvbnN0IGZpbmFsID0gc3RyZWFtUmVmLmN1cnJlbnQ7XG4gICAgICAgICAgaWYgKGZpbmFsKSB7XG4gICAgICAgICAgICBzZXRNZXNzYWdlcygobSkgPT4gW1xuICAgICAgICAgICAgICAuLi5tLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6IGBtc2ctJHtjbG9jay5ub3coKX1gLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGZpbmFsLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgY29uZmlkZW5jZTogMC44NSxcbiAgICAgICAgICAgICAgICAgIHNvdXJjZXM6IFsnQUkgQXNzaXN0YW50J10sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgc2V0U3RyZWFtQnVmKCcnKTtcbiAgICAgICAgICAgIHN0cmVhbVJlZi5jdXJyZW50ID0gJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIPCfkYcgbWljcm90YXNrIHNldHRsZSBlbnN1cmVzIERPTSByZWZsZWN0cyBmaW5hbCBtZXNzYWdlIGJlZm9yZSBcImlkbGVcIlxuICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gc2V0U3RhdHVzKCdpZGxlJykpO1xuICAgICAgICAgIHNldElzVHlwaW5nKGZhbHNlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgICAgc2V0U3RhdHVzKCdlcnJvcicpO1xuICAgICAgICAgIHNldElzVHlwaW5nKGZhbHNlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4gdW5zdWJzY3JpYmUoKTtcbiAgfSwgW3RyYW5zcG9ydCwgY2xvY2tdKTtcblxuICAvLyBDbGVhbnVwIG9uIHVubW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgYWJvcnRSZWYuY3VycmVudD8uYWJvcnQoKTtcbiAgICAgIHRpbWVycy5jdXJyZW50LmZvckVhY2goY2xvY2suY2xlYXJUaW1lb3V0KTtcbiAgICAgIHRpbWVycy5jdXJyZW50ID0gW107XG4gICAgfTtcbiAgfSwgW2Nsb2NrXSk7XG5cbiAgY29uc3QgcHVzaFRpbWVyID0gKGlkOiBudW1iZXIpID0+IHtcbiAgICB0aW1lcnMuY3VycmVudC5wdXNoKGlkKTtcbiAgfTtcblxuICBjb25zdCBoYW5kbGVTZW5kTWVzc2FnZSA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jICh0ZXh0Pzogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlVGV4dCA9IHRleHQgfHwgaW5wdXRWYWx1ZTtcbiAgICAgIGlmICghbWVzc2FnZVRleHQudHJpbSgpKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IHVzZXJNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICBpZDogYG1zZy0ke2Nsb2NrLm5vdygpfWAsXG4gICAgICAgIHR5cGU6ICd1c2VyJyxcbiAgICAgICAgY29udGVudDogbWVzc2FnZVRleHQsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgdXNlck1lc3NhZ2VdKTtcbiAgICAgIGlmICghdGV4dCkgc2V0SW5wdXRWYWx1ZSgnJyk7IC8vIE9ubHkgY2xlYXIgaWYgdXNpbmcgY3VycmVudCBpbnB1dFxuXG4gICAgICBpZiAodHJhbnNwb3J0KSB7XG4gICAgICAgIC8vIFVzZSB0cmFuc3BvcnQgZm9yIHRlc3RhYmxlIGFzeW5jIGJlaGF2aW9yXG4gICAgICAgIGNvbnN0IGlkID0gY2xvY2suc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgYWJvcnRSZWYuY3VycmVudD8uYWJvcnQoKTtcbiAgICAgICAgICBhYm9ydFJlZi5jdXJyZW50ID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgIHNldFN0YXR1cygndGhpbmtpbmcnKTtcbiAgICAgICAgICBzZXRJc1R5cGluZyh0cnVlKTtcblxuICAgICAgICAgIC8vIFR5cGluZyBpbmRpY2F0b3IgZGVsYXkg4oCTIHB1cmVseSBjb3NtZXRpYywgdGVzdC1jb250cm9sbGVkXG4gICAgICAgICAgcHVzaFRpbWVyKFxuICAgICAgICAgICAgY2xvY2suc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghYWJvcnRSZWYuY3VycmVudD8uc2lnbmFsLmFib3J0ZWQpIHNldFN0YXR1cygnc3RyZWFtaW5nJyk7XG4gICAgICAgICAgICB9LCB0eXBpbmdEZWxheU1zKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgdHJhbnNwb3J0LnNlbmQobWVzc2FnZVRleHQsIGFib3J0UmVmLmN1cnJlbnQuc2lnbmFsKTtcbiAgICAgICAgfSwgZGVib3VuY2VNcyk7XG4gICAgICAgIHB1c2hUaW1lcihpZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBiZWhhdmlvciBmb3IgbGVnYWN5IHVzYWdlXG4gICAgICAgIHNldElzVHlwaW5nKHRydWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGFzc2lzdGFudFJlc3BvbnNlID0gYXdhaXQgZ2VuZXJhdGVSZXNwb25zZShtZXNzYWdlVGV4dCk7XG4gICAgICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCBhc3Npc3RhbnRSZXNwb25zZV0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbXG4gICAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogYGVycm9yLSR7Y2xvY2subm93KCl9YCxcbiAgICAgICAgICAgICAgdHlwZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6XG4gICAgICAgICAgICAgICAgJ0kgYXBvbG9naXplLCBidXQgSSBlbmNvdW50ZXJlZCBhbiBlcnJvciBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgY29uZmlkZW5jZTogMCxcbiAgICAgICAgICAgICAgICBzb3VyY2VzOiBbJ0Vycm9yIEhhbmRsZXInXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgc2V0SXNUeXBpbmcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBbaW5wdXRWYWx1ZSwgdHJhbnNwb3J0LCBjbG9jaywgdHlwaW5nRGVsYXlNcywgZGVib3VuY2VNc10sXG4gICk7XG5cbiAgLy8gS2VlcCByZWYgaW4gc3luYyBmb3IgY2FsbGJhY2tzIGRlZmluZWQgZWFybGllclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGhhbmRsZVNlbmRNZXNzYWdlUmVmLmN1cnJlbnQgPSBoYW5kbGVTZW5kTWVzc2FnZTtcbiAgfSwgW2hhbmRsZVNlbmRNZXNzYWdlXSk7XG5cbiAgY29uc3QgaGFuZGxlS2V5UHJlc3MgPSAoZTogUmVhY3QuS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaGFuZGxlU2VuZE1lc3NhZ2UoKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgaGFuZGxlQ29weSA9IChjb250ZW50OiBzdHJpbmcpID0+IHtcbiAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcbiAgfTtcblxuICBjb25zdCBNZXNzYWdlQnViYmxlOiBSZWFjdC5GQzx7IG1lc3NhZ2U6IE1lc3NhZ2UgfT4gPSAoeyBtZXNzYWdlIH0pID0+IHtcbiAgICBjb25zdCBpc1VzZXIgPSBtZXNzYWdlLnR5cGUgPT09ICd1c2VyJztcbiAgICBjb25zdCBpc1N5c3RlbSA9IG1lc3NhZ2UudHlwZSA9PT0gJ3N5c3RlbSc7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEJveFxuICAgICAgICBzeD17e1xuICAgICAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgICAgICBmbGV4RGlyZWN0aW9uOiBpc1VzZXIgPyAncm93LXJldmVyc2UnIDogJ3JvdycsXG4gICAgICAgICAgZ2FwOiAxLFxuICAgICAgICAgIG1iOiAyLFxuICAgICAgICAgIGFsaWduSXRlbXM6ICdmbGV4LXN0YXJ0JyxcbiAgICAgICAgfX1cbiAgICAgID5cbiAgICAgICAgPEF2YXRhclxuICAgICAgICAgIHN4PXt7XG4gICAgICAgICAgICB3aWR0aDogMzIsXG4gICAgICAgICAgICBoZWlnaHQ6IDMyLFxuICAgICAgICAgICAgYmdjb2xvcjogaXNVc2VyID8gJ3ByaW1hcnkubWFpbicgOiAnc2Vjb25kYXJ5Lm1haW4nLFxuICAgICAgICAgIH19XG4gICAgICAgID5cbiAgICAgICAgICB7aXNVc2VyID8gPFBlcnNvbiBmb250U2l6ZT1cInNtYWxsXCIgLz4gOiA8U21hcnRUb3kgZm9udFNpemU9XCJzbWFsbFwiIC8+fVxuICAgICAgICA8L0F2YXRhcj5cblxuICAgICAgICA8UGFwZXJcbiAgICAgICAgICBlbGV2YXRpb249ezF9XG4gICAgICAgICAgc3g9e3tcbiAgICAgICAgICAgIHA6IDIsXG4gICAgICAgICAgICBtYXhXaWR0aDogJzcwJScsXG4gICAgICAgICAgICBiZ2NvbG9yOiBpc1VzZXIgPyAncHJpbWFyeS5tYWluJyA6ICdiYWNrZ3JvdW5kLnBhcGVyJyxcbiAgICAgICAgICAgIGNvbG9yOiBpc1VzZXIgPyAncHJpbWFyeS5jb250cmFzdFRleHQnIDogJ3RleHQucHJpbWFyeScsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IGlzVXNlciA/ICcxNnB4IDE2cHggNHB4IDE2cHgnIDogJzE2cHggMTZweCAxNnB4IDRweCcsXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxUeXBvZ3JhcGh5IHZhcmlhbnQ9XCJib2R5MVwiIHN4PXt7IG1iOiAxLCB3aGl0ZVNwYWNlOiAncHJlLXdyYXAnIH19PlxuICAgICAgICAgICAge21lc3NhZ2UuY29udGVudH1cbiAgICAgICAgICA8L1R5cG9ncmFwaHk+XG5cbiAgICAgICAgICB7bWVzc2FnZS5tZXRhZGF0YSAmJiAoXG4gICAgICAgICAgICA8Qm94IHN4PXt7IG10OiAxIH19PlxuICAgICAgICAgICAgICB7bWVzc2FnZS5tZXRhZGF0YS5jb25maWRlbmNlICYmIChcbiAgICAgICAgICAgICAgICA8Q2hpcFxuICAgICAgICAgICAgICAgICAgbGFiZWw9e2AkeyhtZXNzYWdlLm1ldGFkYXRhLmNvbmZpZGVuY2UgKiAxMDApLnRvRml4ZWQoMCl9JSBjb25maWRlbnRgfVxuICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtYWxsXCJcbiAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lZFwiXG4gICAgICAgICAgICAgICAgICBzeD17eyBtcjogMSwgbWI6IDEgfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHttZXNzYWdlLnR5cGUgPT09ICdhc3Npc3RhbnQnICYmIChcbiAgICAgICAgICAgIDxCb3ggc3g9e3sgbXQ6IDEsIGRpc3BsYXk6ICdmbGV4JywgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsIGdhcDogMSB9fT5cbiAgICAgICAgICAgICAgey8qIEZvbGxvdy11cCBBY3Rpb25zICovfVxuICAgICAgICAgICAgICA8U3RhY2sgZGlyZWN0aW9uPVwicm93XCIgc3BhY2luZz17MX0gc3g9e3sgZmxleFdyYXA6ICd3cmFwJyB9fT5cbiAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmVkXCJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGFsZXJ0KCdHZW5lcmF0ZSBxdWVyeSBjbGlja2VkIScpfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIEdlbmVyYXRlIFF1ZXJ5XG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtYWxsXCJcbiAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lZFwiXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBhbGVydCgnRXhwb3J0IGFuYWx5c2lzIGNsaWNrZWQhJyl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgRXhwb3J0IEFuYWx5c2lzXG4gICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgIDwvU3RhY2s+XG5cbiAgICAgICAgICAgICAgey8qIEZlZWRiYWNrIChUaHVtYnMvTGFiZWxzKSAqL31cbiAgICAgICAgICAgICAgPEJveFxuICAgICAgICAgICAgICAgIHN4PXt7XG4gICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgICAgICAgICAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICAgICAgICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAnc3BhY2UtYmV0d2VlbicsXG4gICAgICAgICAgICAgICAgICBtdDogMSxcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFR5cG9ncmFwaHkgdmFyaWFudD1cImNhcHRpb25cIiBjb2xvcj1cInRleHQuc2Vjb25kYXJ5XCI+XG4gICAgICAgICAgICAgICAgICB7bWVzc2FnZS50aW1lc3RhbXAudG9Mb2NhbGVUaW1lU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgPC9UeXBvZ3JhcGh5PlxuXG4gICAgICAgICAgICAgICAgPFN0YWNrIGRpcmVjdGlvbj1cInJvd1wiIHNwYWNpbmc9ezF9PlxuICAgICAgICAgICAgICAgICAgPEljb25CdXR0b24gc2l6ZT1cInNtYWxsXCIgb25DbGljaz17KCkgPT4gaGFuZGxlQ29weShtZXNzYWdlLmNvbnRlbnQpfT5cbiAgICAgICAgICAgICAgICAgICAgPENvbnRlbnRDb3B5IGZvbnRTaXplPVwic21hbGxcIiAvPlxuICAgICAgICAgICAgICAgICAgPC9JY29uQnV0dG9uPlxuXG4gICAgICAgICAgICAgICAgICB7IWlzVXNlciAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcj1cInN1Y2Nlc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gYWxlcnQoJ0ZlZWRiYWNrOiBUaHVtYnMgVXAhJyl9XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRodW1iVXAgZm9udFNpemU9XCJzbWFsbFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9JY29uQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgIDxJY29uQnV0dG9uIHNpemU9XCJzbWFsbFwiIG9uQ2xpY2s9eygpID0+IGFsZXJ0KCdGZWVkYmFjazogVGh1bWJzIERvd24hJyl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRodW1iRG93biBmb250U2l6ZT1cInNtYWxsXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L0ljb25CdXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L1N0YWNrPlxuICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvUGFwZXI+XG4gICAgICA8L0JveD5cbiAgICApO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPEJveCBzeD17eyBoZWlnaHQ6ICcxMDAlJywgZGlzcGxheTogJ2ZsZXgnLCBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyB9fT5cbiAgICAgIHsvKiBIZWFkZXIgKi99XG4gICAgICA8UGFwZXIgZWxldmF0aW9uPXsxfSBzeD17eyBwOiAyLCBib3JkZXJSYWRpdXM6ICcxMnB4IDEycHggMCAwJyB9fT5cbiAgICAgICAgPEJveCBzeD17eyBkaXNwbGF5OiAnZmxleCcsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBqdXN0aWZ5Q29udGVudDogJ3NwYWNlLWJldHdlZW4nIH19PlxuICAgICAgICAgIDxCb3ggc3g9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgZ2FwOiAyIH19PlxuICAgICAgICAgICAgPEF2YXRhciBzeD17eyBiZ2NvbG9yOiAnc2Vjb25kYXJ5Lm1haW4nIH19PlxuICAgICAgICAgICAgICA8U21hcnRUb3kgLz5cbiAgICAgICAgICAgIDwvQXZhdGFyPlxuXG4gICAgICAgICAgICA8Qm94PlxuICAgICAgICAgICAgICA8VHlwb2dyYXBoeSB2YXJpYW50PVwiaDZcIiBzeD17eyBmb250V2VpZ2h0OiA2MDAgfX0+XG4gICAgICAgICAgICAgICAgSW50ZWxCb3RcbiAgICAgICAgICAgICAgPC9UeXBvZ3JhcGh5PlxuICAgICAgICAgICAgICA8VHlwb2dyYXBoeVxuICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJjYXB0aW9uXCJcbiAgICAgICAgICAgICAgICBjb2xvcj1cInRleHQuc2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgICByb2xlPVwic3RhdHVzXCJcbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiYXNzaXN0YW50LXN0YXR1c1wiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICBJbnRlbGxpZ2VuY2UgQW5hbHlzaXMgQXNzaXN0YW50IOKAonsnICd9XG4gICAgICAgICAgICAgICAge3N0YXR1cyA9PT0gJ3RoaW5raW5nJ1xuICAgICAgICAgICAgICAgICAgPyAnVGhpbmtpbmcuLi4nXG4gICAgICAgICAgICAgICAgICA6IHN0YXR1cyA9PT0gJ3N0cmVhbWluZydcbiAgICAgICAgICAgICAgICAgICAgPyAnVHlwaW5nLi4uJ1xuICAgICAgICAgICAgICAgICAgICA6IHN0YXR1cyA9PT0gJ2Vycm9yJ1xuICAgICAgICAgICAgICAgICAgICAgID8gJ0Vycm9yJ1xuICAgICAgICAgICAgICAgICAgICAgIDogJ09ubGluZSd9XG4gICAgICAgICAgICAgIDwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgIDwvQm94PlxuXG4gICAgICAgICAgPFN0YWNrIGRpcmVjdGlvbj1cInJvd1wiIHNwYWNpbmc9ezF9PlxuICAgICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgICAgcmVmPXtob2xkUmVmfSAvLyBBdHRhY2ggdGhlIHJlZiBoZXJlXG4gICAgICAgICAgICAgIGNvbG9yPXtpc0xpc3RlbmluZyA/ICdwcmltYXJ5JyA6ICdkZWZhdWx0J31cbiAgICAgICAgICAgICAgLy8gb25DbGljayBpcyBub3cgaGFuZGxlZCBieSB0aGUgdXNlSG9sZFRvVGFsayBob29rJ3Mgb25TdGFydC9vbkVuZFxuICAgICAgICAgICAgICAvLyBXZSdsbCBrZWVwIGEgc2ltcGxpZmllZCBvbkNsaWNrIGZvciBkaXJlY3QgdG9nZ2xpbmcgaWYgbmVlZGVkLCBvciByZW1vdmUgaWYgb25seSBob2xkLXRvLXRhbGtcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChpc0xpc3RlbmluZykge1xuICAgICAgICAgICAgICAgICAgLy8gSWYgY3VycmVudGx5IGxpc3RlbmluZywgYSBjbGljayBzaG91bGQgc3RvcCBpdFxuICAgICAgICAgICAgICAgICAgc3RvcFZvaWNlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIElmIG5vdCBsaXN0ZW5pbmcsIGEgY2xpY2sgc2hvdWxkIHN0YXJ0IGl0IChmb3IgdGFwLXRvLXRhbGsgYmVoYXZpb3IpXG4gICAgICAgICAgICAgICAgICBzdGFydFZvaWNlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IXZvaWNlRW5hYmxlZH1cbiAgICAgICAgICAgICAgYXJpYS1sYWJlbD17aXNMaXN0ZW5pbmcgPyAnU3RvcCBWb2ljZScgOiAnU3RhcnQgVm9pY2UnfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXNMaXN0ZW5pbmcgPyA8TWljIC8+IDogPE1pY09mZiAvPn1cbiAgICAgICAgICAgIDwvSWNvbkJ1dHRvbj5cblxuICAgICAgICAgICAgPEljb25CdXR0b24gYXJpYS1sYWJlbD1cIlNldHRpbmdzXCI+XG4gICAgICAgICAgICAgIDxTZXR0aW5ncyAvPlxuICAgICAgICAgICAgPC9JY29uQnV0dG9uPlxuICAgICAgICAgIDwvU3RhY2s+XG4gICAgICAgIDwvQm94PlxuICAgICAgPC9QYXBlcj5cblxuICAgICAgey8qIE1lc3NhZ2VzIEFyZWEgKi99XG4gICAgICA8Qm94XG4gICAgICAgIHN4PXt7XG4gICAgICAgICAgZmxleDogMSxcbiAgICAgICAgICBvdmVyZmxvdzogJ2F1dG8nLFxuICAgICAgICAgIHA6IDIsXG4gICAgICAgICAgYmdjb2xvcjogJ2JhY2tncm91bmQuZGVmYXVsdCcsXG4gICAgICAgIH19XG4gICAgICAgIHJvbGU9XCJsb2dcIlxuICAgICAgICBhcmlhLWxpdmU9XCJwb2xpdGVcIlxuICAgICAgICBkYXRhLXRlc3RpZD1cIm1lc3NhZ2UtbG9nXCJcbiAgICAgID5cbiAgICAgICAge21lc3NhZ2VzLm1hcCgobWVzc2FnZSkgPT4gKFxuICAgICAgICAgIDxkaXYga2V5PXttZXNzYWdlLmlkfSByb2xlPVwiYXJ0aWNsZVwiIGFyaWEtbGFiZWw9e21lc3NhZ2UudHlwZX0+XG4gICAgICAgICAgICA8TWVzc2FnZUJ1YmJsZSBtZXNzYWdlPXttZXNzYWdlfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cblxuICAgICAgICB7c3RyZWFtQnVmICYmIChcbiAgICAgICAgICA8ZGl2IHJvbGU9XCJhcnRpY2xlXCIgYXJpYS1sYWJlbD1cImFzc2lzdGFudFwiPlxuICAgICAgICAgICAgPEJveCBzeD17eyBkaXNwbGF5OiAnZmxleCcsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBnYXA6IDEsIG1iOiAyIH19PlxuICAgICAgICAgICAgICA8QXZhdGFyIHN4PXt7IHdpZHRoOiAzMiwgaGVpZ2h0OiAzMiwgYmdjb2xvcjogJ3NlY29uZGFyeS5tYWluJyB9fT5cbiAgICAgICAgICAgICAgICA8U21hcnRUb3kgZm9udFNpemU9XCJzbWFsbFwiIC8+XG4gICAgICAgICAgICAgIDwvQXZhdGFyPlxuICAgICAgICAgICAgICA8UGFwZXIgZWxldmF0aW9uPXsxfSBzeD17eyBwOiAyLCBib3JkZXJSYWRpdXM6ICcxNnB4IDE2cHggMTZweCA0cHgnIH19PlxuICAgICAgICAgICAgICAgIDxUeXBvZ3JhcGh5IHZhcmlhbnQ9XCJib2R5MlwiPntzdHJlYW1CdWZ9PC9UeXBvZ3JhcGh5PlxuICAgICAgICAgICAgICA8L1BhcGVyPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG5cbiAgICAgICAge2lzVHlwaW5nICYmIChcbiAgICAgICAgICA8Qm94IHN4PXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicsIGdhcDogMSwgbWI6IDIgfX0+XG4gICAgICAgICAgICA8QXZhdGFyIHN4PXt7IHdpZHRoOiAzMiwgaGVpZ2h0OiAzMiwgYmdjb2xvcjogJ3NlY29uZGFyeS5tYWluJyB9fT5cbiAgICAgICAgICAgICAgPFNtYXJ0VG95IGZvbnRTaXplPVwic21hbGxcIiAvPlxuICAgICAgICAgICAgPC9BdmF0YXI+XG4gICAgICAgICAgICA8UGFwZXIgZWxldmF0aW9uPXsxfSBzeD17eyBwOiAyLCBib3JkZXJSYWRpdXM6ICcxNnB4IDE2cHggMTZweCA0cHgnIH19PlxuICAgICAgICAgICAgICA8VHlwb2dyYXBoeSB2YXJpYW50PVwiYm9keTJcIj5UeXBpbmcuLi48L1R5cG9ncmFwaHk+XG4gICAgICAgICAgICA8L1BhcGVyPlxuICAgICAgICAgIDwvQm94PlxuICAgICAgICApfVxuXG4gICAgICAgIDxkaXYgcmVmPXttZXNzYWdlc0VuZFJlZn0gLz5cbiAgICAgIDwvQm94PlxuXG4gICAgICB7LyogSW5wdXQgQXJlYSAqL31cbiAgICAgIDxQYXBlciBlbGV2YXRpb249ezF9IHN4PXt7IHA6IDIsIGJvcmRlclJhZGl1czogJzAgMCAxMnB4IDEycHgnIH19PlxuICAgICAgICA8Qm94IHN4PXt7IGRpc3BsYXk6ICdmbGV4JywgYWxpZ25JdGVtczogJ2NlbnRlcicsIGdhcDogMSB9fT5cbiAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICByZWY9e2lucHV0UmVmfVxuICAgICAgICAgICAgZnVsbFdpZHRoXG4gICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBc2sgbWUgYW55dGhpbmcgYWJvdXQgeW91ciBkYXRhLi4uXCJcbiAgICAgICAgICAgIHZhbHVlPXtpbnB1dFZhbHVlfVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRJbnB1dFZhbHVlKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIG9uS2V5UHJlc3M9e2hhbmRsZUtleVByZXNzfVxuICAgICAgICAgICAgZGlzYWJsZWQ9e2lzVHlwaW5nfVxuICAgICAgICAgICAgaW5wdXRQcm9wcz17e1xuICAgICAgICAgICAgICAnYXJpYS1sYWJlbCc6ICdhc3Npc3RhbnQtaW5wdXQnLFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIHN4PXt7XG4gICAgICAgICAgICAgICcmIC5NdWlPdXRsaW5lZElucHV0LXJvb3QnOiB7XG4gICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAzLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPlxuXG4gICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTZW5kTWVzc2FnZSgpfVxuICAgICAgICAgICAgZGlzYWJsZWQ9eyFpbnB1dFZhbHVlLnRyaW0oKSB8fCBpc1R5cGluZ31cbiAgICAgICAgICAgIHN4PXt7IHA6IDEuNSB9fVxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cInNlbmRcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxTZW5kIC8+XG4gICAgICAgICAgPC9JY29uQnV0dG9uPlxuICAgICAgICA8L0JveD5cbiAgICAgIDwvUGFwZXI+XG4gICAgPC9Cb3g+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBFbmhhbmNlZEFJQXNzaXN0YW50O1xuIl0sInZlcnNpb24iOjN9