{"file":"/Users/brianlong/Developer/summit/server/src/graphql/validation/depthLimit.ts","mappings":";;AAEA,gCA6BC;AA/BD,qCAAgF;AAEhF,SAAgB,UAAU,CAAC,WAAmB,EAAE;IAC9C,OAAO,CAAC,OAA0B,EAAE,EAAE;QACpC,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAI,aAAa,GAAG,WAAW,CAAC,CAAC,yBAAyB;QAE1D,OAAO;YACL,mBAAmB,EAAE;gBACnB,KAAK,CAAC,IAAI;oBACR,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;wBACjC,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;oBAClC,CAAC;gBACH,CAAC;gBACD,KAAK;oBACH,aAAa,GAAG,WAAW,CAAC,CAAC,2BAA2B;gBAC1D,CAAC;aACF;YACD,YAAY,EAAE;gBACZ,KAAK;oBACH,YAAY,EAAE,CAAC;oBACf,IAAI,YAAY,GAAG,QAAQ,EAAE,CAAC;wBAC5B,OAAO,CAAC,WAAW,CAAC,IAAI,sBAAY,CAAC,4BAA4B,YAAY,MAAM,QAAQ,gBAAgB,aAAa,GAAG,CAAC,CAAC,CAAC;oBAChI,CAAC;gBACH,CAAC;gBACD,KAAK;oBACH,YAAY,EAAE,CAAC;gBACjB,CAAC;aACF;SACF,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC","names":[],"sources":["/Users/brianlong/Developer/summit/server/src/graphql/validation/depthLimit.ts"],"sourcesContent":["import { Kind, visit, ValidationContext, ASTNode, GraphQLError } from 'graphql';\n\nexport function depthLimit(maxDepth: number = 10) {\n  return (context: ValidationContext) => {\n    let currentDepth = 0;\n    let operationName = 'anonymous'; // Default operation name\n\n    return {\n      OperationDefinition: {\n        enter(node) {\n          if (node.name && node.name.value) {\n            operationName = node.name.value;\n          }\n        },\n        leave() {\n          operationName = 'anonymous'; // Reset for next operation\n        }\n      },\n      SelectionSet: {\n        enter() {\n          currentDepth++;\n          if (currentDepth > maxDepth) {\n            context.reportError(new GraphQLError(`Query is too deep: depth ${currentDepth} > ${maxDepth} (operation: ${operationName})`));\n          }\n        },\n        leave() {\n          currentDepth--;\n        }\n      }\n    };\n  };\n}"],"version":3}