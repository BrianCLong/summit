e88c1589dde3eec6102654586d4131c4
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const loader_1 = require("../src/policy/loader");
describe("policy unsigned gate", () => {
    const prev = process.env.ALLOW_UNSIGNED_POLICY;
    beforeAll(() => { delete process.env.ALLOW_UNSIGNED_POLICY; });
    afterAll(() => { if (prev !== undefined)
        process.env.ALLOW_UNSIGNED_POLICY = prev; });
    it("blocks when signature missing and override not set", async () => {
        await expect((0, loader_1.loadSignedPolicy)("bundle.tgz")).rejects.toBeTruthy();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9wb2xpY3lfdW5zaWduZWRfYmxvY2suc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLGlEQUF3RDtBQUV4RCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO0lBQ3BDLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMscUJBQXFCLENBQUM7SUFDL0MsU0FBUyxDQUFDLEdBQUUsRUFBRSxHQUFFLE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdELFFBQVEsQ0FBQyxHQUFFLEVBQUUsR0FBRSxJQUFJLElBQUksS0FBSyxTQUFTO1FBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVwRixFQUFFLENBQUMsb0RBQW9ELEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDbEUsTUFBTSxNQUFNLENBQUMsSUFBQSx5QkFBZ0IsRUFBQyxZQUFtQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDM0UsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYnJpYW5sb25nL0RldmVsb3Blci9zdW1taXQvc2VydmVyL3Rlc3RzL3BvbGljeV91bnNpZ25lZF9ibG9jay5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvYWRTaWduZWRQb2xpY3kgfSBmcm9tIFwiLi4vc3JjL3BvbGljeS9sb2FkZXJcIjtcblxuZGVzY3JpYmUoXCJwb2xpY3kgdW5zaWduZWQgZ2F0ZVwiLCAoKSA9PiB7XG4gIGNvbnN0IHByZXYgPSBwcm9jZXNzLmVudi5BTExPV19VTlNJR05FRF9QT0xJQ1k7XG4gIGJlZm9yZUFsbCgoKT0+eyBkZWxldGUgcHJvY2Vzcy5lbnYuQUxMT1dfVU5TSUdORURfUE9MSUNZOyB9KTtcbiAgYWZ0ZXJBbGwoKCk9PnsgaWYgKHByZXYgIT09IHVuZGVmaW5lZCkgcHJvY2Vzcy5lbnYuQUxMT1dfVU5TSUdORURfUE9MSUNZID0gcHJldjsgfSk7XG5cbiAgaXQoXCJibG9ja3Mgd2hlbiBzaWduYXR1cmUgbWlzc2luZyBhbmQgb3ZlcnJpZGUgbm90IHNldFwiLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZXhwZWN0KGxvYWRTaWduZWRQb2xpY3koXCJidW5kbGUudGd6XCIgYXMgYW55KSkucmVqZWN0cy50b0JlVHJ1dGh5KCk7XG4gIH0pO1xufSk7XG5cbiJdLCJ2ZXJzaW9uIjozfQ==