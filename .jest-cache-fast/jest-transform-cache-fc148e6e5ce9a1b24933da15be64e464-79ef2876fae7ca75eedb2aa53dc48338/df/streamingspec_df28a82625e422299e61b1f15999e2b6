40a91ae6253b06057d735707f7da61af
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const streamProcess_1 = require("../src/conductor/steps/streamProcess");
test("freshness gate blocks stale", async () => {
    const ctx = { id: "r1", setOutputs: jest.fn() };
    await (0, streamProcess_1.streamProcess)(ctx, { id: "ingest", freshness: { freshWithin: "10m" } }, { key: "k", value: "{}", ts: new Date(Date.now() - 11 * 60 * 1000).toISOString() });
    expect(ctx.setOutputs).not.toHaveBeenCalled();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9zdHJlYW1pbmcuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLHdFQUFxRTtBQUVyRSxJQUFJLENBQUMsNkJBQTZCLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDN0MsTUFBTSxHQUFHLEdBQVEsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNyRCxNQUFNLElBQUEsNkJBQWEsRUFDakIsR0FBRyxFQUNILEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFDbkQsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQ25GLENBQUM7SUFDRixNQUFNLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0FBQ2hELENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9zZXJ2ZXIvdGVzdHMvc3RyZWFtaW5nLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RyZWFtUHJvY2VzcyB9IGZyb20gXCIuLi9zcmMvY29uZHVjdG9yL3N0ZXBzL3N0cmVhbVByb2Nlc3NcIjtcblxudGVzdChcImZyZXNobmVzcyBnYXRlIGJsb2NrcyBzdGFsZVwiLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGN0eDogYW55ID0geyBpZDogXCJyMVwiLCBzZXRPdXRwdXRzOiBqZXN0LmZuKCkgfTtcbiAgYXdhaXQgc3RyZWFtUHJvY2VzcyhcbiAgICBjdHgsXG4gICAgeyBpZDogXCJpbmdlc3RcIiwgZnJlc2huZXNzOiB7IGZyZXNoV2l0aGluOiBcIjEwbVwiIH0gfSxcbiAgICB7IGtleTogXCJrXCIsIHZhbHVlOiBcInt9XCIsIHRzOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTEgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCkgfSxcbiAgKTtcbiAgZXhwZWN0KGN0eC5zZXRPdXRwdXRzKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xufSk7XG5cbiJdLCJ2ZXJzaW9uIjozfQ==