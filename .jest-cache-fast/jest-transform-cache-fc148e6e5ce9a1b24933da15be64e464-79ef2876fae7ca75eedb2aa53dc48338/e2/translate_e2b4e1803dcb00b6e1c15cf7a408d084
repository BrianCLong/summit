c134e3a5ee434d8349d3baa70c7e1710
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.nlToFlow = nlToFlow;
function nlToFlow(text) {
    const t = text.toLowerCase();
    const nodes = [];
    const edges = [];
    const add = (id, type) => { if (!nodes.find((n) => n.id === id))
        nodes.push({ id, type }); };
    if (/on (pr|pull request)/.test(t)) { /* trigger */ }
    add("build", "build");
    if (/test/.test(t))
        add("test", "test"), edges.push({ from: "build", to: "test" });
    if (/tia|impact/.test(t))
        nodes.find((n) => n.id === "test").mode = "tia";
    if (/(deploy|rollout)/.test(t))
        add("deploy", "deploy"), edges.push({ from: "test", to: "deploy" });
    if (/confidence\s*(>=|â‰¥)\s*85/.test(t))
        nodes.push({ id: "gate", type: "approve", cond: "confidence>=85" }), edges.push({ from: "test", to: "gate" }, { from: "gate", to: "deploy" });
    return { name: "nl-flow", triggers: ["pull_request"], nodes, edges };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL21hZXN0cm9mbG93L3NyYy9ubC90cmFuc2xhdGUudHMiLCJtYXBwaW5ncyI6Ijs7QUFFQSw0QkFXQztBQVhELFNBQWdCLFFBQVEsQ0FBQyxJQUFXO0lBQ2xDLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM3QixNQUFNLEtBQUssR0FBUyxFQUFFLENBQUM7SUFBQyxNQUFNLEtBQUssR0FBUyxFQUFFLENBQUM7SUFDL0MsTUFBTSxHQUFHLEdBQUcsQ0FBQyxFQUFTLEVBQUMsSUFBVyxFQUFDLEVBQUUsR0FBRSxJQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUssRUFBQyxFQUFFLENBQUEsQ0FBQyxDQUFDLEVBQUUsS0FBRyxFQUFFLENBQUM7UUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUMsRUFBRSxFQUFDLElBQUksRUFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEcsSUFBSSxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3JELEdBQUcsQ0FBQyxPQUFPLEVBQUMsT0FBTyxDQUFDLENBQUM7SUFDckIsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBQyxPQUFPLEVBQUMsRUFBRSxFQUFDLE1BQU0sRUFBQyxDQUFDLENBQUM7SUFDN0UsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFLLEVBQUMsRUFBRSxDQUFBLENBQUMsQ0FBQyxFQUFFLEtBQUcsTUFBTSxDQUFDLENBQUMsSUFBSSxHQUFDLEtBQUssQ0FBQztJQUN4RSxJQUFJLGtCQUFrQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFBRSxHQUFHLENBQUMsUUFBUSxFQUFDLFFBQVEsQ0FBQyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBQyxJQUFJLEVBQUMsTUFBTSxFQUFDLEVBQUUsRUFBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO0lBQzlGLElBQUksMEJBQTBCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBQyxFQUFFLEVBQUMsTUFBTSxFQUFDLElBQUksRUFBQyxTQUFTLEVBQUMsSUFBSSxFQUFDLGdCQUFnQixFQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUMsSUFBSSxFQUFDLE1BQU0sRUFBQyxFQUFFLEVBQUMsTUFBTSxFQUFDLEVBQUMsRUFBQyxJQUFJLEVBQUMsTUFBTSxFQUFDLEVBQUUsRUFBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO0lBQ3BLLE9BQU8sRUFBRSxJQUFJLEVBQUMsU0FBUyxFQUFFLFFBQVEsRUFBQyxDQUFDLGNBQWMsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsQ0FBQztBQUNyRSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9wYWNrYWdlcy9tYWVzdHJvZmxvdy9zcmMvbmwvdHJhbnNsYXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIERldGVybWluaXN0aWMga2V5d29yZCBncmFtbWFyIOKGkiBEU0wgKG5vIExMTSkuIEV4cGFuZGFibGUgdmlhIHN5bm9ueW1zLlxudHlwZSBGbG93ID0geyBuYW1lOnN0cmluZzsgdHJpZ2dlcnM6c3RyaW5nW107IG5vZGVzOmFueVtdOyBlZGdlczphbnlbXSB9O1xuZXhwb3J0IGZ1bmN0aW9uIG5sVG9GbG93KHRleHQ6c3RyaW5nKTogRmxvdyB7XG4gIGNvbnN0IHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IG5vZGVzOmFueVtdID0gW107IGNvbnN0IGVkZ2VzOmFueVtdID0gW107XG4gIGNvbnN0IGFkZCA9IChpZDpzdHJpbmcsdHlwZTpzdHJpbmcpPT57IGlmKCFub2Rlcy5maW5kKChuOmFueSk9Pm4uaWQ9PT1pZCkpIG5vZGVzLnB1c2goe2lkLHR5cGV9KTsgfTtcbiAgaWYgKC9vbiAocHJ8cHVsbCByZXF1ZXN0KS8udGVzdCh0KSkgeyAvKiB0cmlnZ2VyICovIH1cbiAgYWRkKFwiYnVpbGRcIixcImJ1aWxkXCIpO1xuICBpZiAoL3Rlc3QvLnRlc3QodCkpIGFkZChcInRlc3RcIixcInRlc3RcIiksIGVkZ2VzLnB1c2goe2Zyb206XCJidWlsZFwiLHRvOlwidGVzdFwifSk7XG4gIGlmICgvdGlhfGltcGFjdC8udGVzdCh0KSkgbm9kZXMuZmluZCgobjphbnkpPT5uLmlkPT09XCJ0ZXN0XCIpLm1vZGU9XCJ0aWFcIjtcbiAgaWYgKC8oZGVwbG95fHJvbGxvdXQpLy50ZXN0KHQpKSBhZGQoXCJkZXBsb3lcIixcImRlcGxveVwiKSwgZWRnZXMucHVzaCh7ZnJvbTpcInRlc3RcIix0bzpcImRlcGxveVwifSk7XG4gIGlmICgvY29uZmlkZW5jZVxccyooPj184omlKVxccyo4NS8udGVzdCh0KSkgbm9kZXMucHVzaCh7aWQ6XCJnYXRlXCIsdHlwZTpcImFwcHJvdmVcIixjb25kOlwiY29uZmlkZW5jZT49ODVcIn0pLCBlZGdlcy5wdXNoKHtmcm9tOlwidGVzdFwiLHRvOlwiZ2F0ZVwifSx7ZnJvbTpcImdhdGVcIix0bzpcImRlcGxveVwifSk7XG4gIHJldHVybiB7IG5hbWU6XCJubC1mbG93XCIsIHRyaWdnZXJzOltcInB1bGxfcmVxdWVzdFwiXSwgbm9kZXMsIGVkZ2VzIH07XG59Il0sInZlcnNpb24iOjN9