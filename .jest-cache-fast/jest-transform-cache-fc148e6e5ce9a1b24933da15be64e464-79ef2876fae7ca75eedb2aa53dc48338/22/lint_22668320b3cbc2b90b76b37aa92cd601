8ffbdfc219eee32ffd560ff061405307
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.flowLint = flowLint;
function flowLint(flow) {
    const out = [];
    if (!flow.nodes.some((n) => n.type === "test"))
        out.push({ id: "no-tests", level: "error", msg: "Flow missing tests step" });
    const deployNeedsGate = flow.nodes.some((n) => n.type === "deploy") && !flow.nodes.some((n) => n.type === "approve");
    if (deployNeedsGate)
        out.push({ id: "no-gate", level: "warn", msg: "Deploy without confidence/approval gate" });
    return out;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL21hZXN0cm9mbG93L3NyYy9saW50LnRzIiwibWFwcGluZ3MiOiI7O0FBQ0EsNEJBTUM7QUFORCxTQUFnQixRQUFRLENBQUMsSUFBUTtJQUMvQixNQUFNLEdBQUcsR0FBUSxFQUFFLENBQUM7SUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBSyxFQUFDLEVBQUUsQ0FBQSxDQUFDLENBQUMsSUFBSSxLQUFHLE1BQU0sQ0FBQztRQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBQyxFQUFFLEVBQUMsVUFBVSxFQUFDLEtBQUssRUFBQyxPQUFPLEVBQUMsR0FBRyxFQUFDLHlCQUF5QixFQUFDLENBQUMsQ0FBQztJQUN0SCxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUssRUFBQyxFQUFFLENBQUEsQ0FBQyxDQUFDLElBQUksS0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBSyxFQUFDLEVBQUUsQ0FBQSxDQUFDLENBQUMsSUFBSSxLQUFHLFNBQVMsQ0FBQyxDQUFDO0lBQ3JILElBQUksZUFBZTtRQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBQyxFQUFFLEVBQUMsU0FBUyxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsR0FBRyxFQUFDLHlDQUF5QyxFQUFDLENBQUMsQ0FBQztJQUN6RyxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL21hZXN0cm9mbG93L3NyYy9saW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIExpbnQgPSB7IGlkOnN0cmluZzsgbGV2ZWw6XCJ3YXJuXCJ8XCJlcnJvclwiOyBtc2c6c3RyaW5nIH07XG5leHBvcnQgZnVuY3Rpb24gZmxvd0xpbnQoZmxvdzphbnkpOiBMaW50W10ge1xuICBjb25zdCBvdXQ6TGludFtdPVtdO1xuICBpZiAoIWZsb3cubm9kZXMuc29tZSgobjphbnkpPT5uLnR5cGU9PT1cInRlc3RcIikpIG91dC5wdXNoKHtpZDpcIm5vLXRlc3RzXCIsbGV2ZWw6XCJlcnJvclwiLG1zZzpcIkZsb3cgbWlzc2luZyB0ZXN0cyBzdGVwXCJ9KTtcbiAgY29uc3QgZGVwbG95TmVlZHNHYXRlID0gZmxvdy5ub2Rlcy5zb21lKChuOmFueSk9Pm4udHlwZT09PVwiZGVwbG95XCIpICYmICFmbG93Lm5vZGVzLnNvbWUoKG46YW55KT0+bi50eXBlPT09XCJhcHByb3ZlXCIpO1xuICBpZiAoZGVwbG95TmVlZHNHYXRlKSBvdXQucHVzaCh7aWQ6XCJuby1nYXRlXCIsbGV2ZWw6XCJ3YXJuXCIsbXNnOlwiRGVwbG95IHdpdGhvdXQgY29uZmlkZW5jZS9hcHByb3ZhbCBnYXRlXCJ9KTtcbiAgcmV0dXJuIG91dDtcbn0iXSwidmVyc2lvbiI6M30=