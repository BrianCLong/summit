578065cef06e57d3169e5681b06b243e
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Signer_1 = require("../products/Signer");
describe('KmsSigner', () => {
    it('signs and verifies using client', async () => {
        const client = {
            sign: async (id, data) => data,
            verify: async (id, data, sig) => Buffer.compare(data, sig) === 0,
        };
        const signer = new Signer_1.KmsSigner('kid1', client);
        const payload = Buffer.from('hello');
        const sig = await signer.sign(payload);
        expect(await signer.verify(payload, sig)).toBe(true);
        expect(signer.kid()).toBe('kid1');
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci9zcmMvdGVzdHMvYnlva19zaWduZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLCtDQUErQztBQUUvQyxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRTtJQUN6QixFQUFFLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDL0MsTUFBTSxNQUFNLEdBQUc7WUFDYixJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQVUsRUFBRSxJQUFZLEVBQUUsRUFBRSxDQUFDLElBQUk7WUFDOUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFVLEVBQUUsSUFBWSxFQUFFLEdBQVcsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLEtBQUssQ0FBQztTQUN6RixDQUFDO1FBQ0YsTUFBTSxNQUFNLEdBQUcsSUFBSSxrQkFBUyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUM3QyxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sR0FBRyxHQUFHLE1BQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsTUFBTSxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci9zcmMvdGVzdHMvYnlva19zaWduZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBLbXNTaWduZXIgfSBmcm9tICcuLi9wcm9kdWN0cy9TaWduZXInO1xuXG5kZXNjcmliZSgnS21zU2lnbmVyJywgKCkgPT4ge1xuICBpdCgnc2lnbnMgYW5kIHZlcmlmaWVzIHVzaW5nIGNsaWVudCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjbGllbnQgPSB7XG4gICAgICBzaWduOiBhc3luYyAoaWQ6IHN0cmluZywgZGF0YTogQnVmZmVyKSA9PiBkYXRhLFxuICAgICAgdmVyaWZ5OiBhc3luYyAoaWQ6IHN0cmluZywgZGF0YTogQnVmZmVyLCBzaWc6IEJ1ZmZlcikgPT4gQnVmZmVyLmNvbXBhcmUoZGF0YSwgc2lnKSA9PT0gMCxcbiAgICB9O1xuICAgIGNvbnN0IHNpZ25lciA9IG5ldyBLbXNTaWduZXIoJ2tpZDEnLCBjbGllbnQpO1xuICAgIGNvbnN0IHBheWxvYWQgPSBCdWZmZXIuZnJvbSgnaGVsbG8nKTtcbiAgICBjb25zdCBzaWcgPSBhd2FpdCBzaWduZXIuc2lnbihwYXlsb2FkKTtcbiAgICBleHBlY3QoYXdhaXQgc2lnbmVyLnZlcmlmeShwYXlsb2FkLCBzaWcpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChzaWduZXIua2lkKCkpLnRvQmUoJ2tpZDEnKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==