f97a82cb223a9ab12e486c03a9ee64c0
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const GossipAuditor_1 = require("../transparency/GossipAuditor");
describe('GossipAuditor', () => {
    it('alerts on fork', async () => {
        const alerts = [];
        const auditor = new GossipAuditor_1.GossipAuditor({
            getSTH: async () => ({ size: 1, root: 'a' }),
            getRange: async () => ['b'],
        }, { alert: (m) => alerts.push(m) });
        const res = await auditor.auditOnce();
        expect(res.ok).toBe(false);
        expect(alerts).toEqual(['transparency_log_mismatch']);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci9zcmMvdGVzdHMvZ29zc2lwX2F1ZGl0b3IudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUFBLGlFQUE4RDtBQUU5RCxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtJQUM3QixFQUFFLENBQUMsZ0JBQWdCLEVBQUUsS0FBSyxJQUFJLEVBQUU7UUFDOUIsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBQzVCLE1BQU0sT0FBTyxHQUFHLElBQUksNkJBQWEsQ0FDL0I7WUFDRSxNQUFNLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLENBQUM7WUFDNUMsUUFBUSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUM7U0FDNUIsRUFDRCxFQUFFLEtBQUssRUFBRSxDQUFDLENBQVMsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUN6QyxDQUFDO1FBQ0YsTUFBTSxHQUFHLEdBQUcsTUFBTSxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDdEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FBQztJQUN4RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9zZXJ2ZXIvc3JjL3Rlc3RzL2dvc3NpcF9hdWRpdG9yLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR29zc2lwQXVkaXRvciB9IGZyb20gJy4uL3RyYW5zcGFyZW5jeS9Hb3NzaXBBdWRpdG9yJztcblxuZGVzY3JpYmUoJ0dvc3NpcEF1ZGl0b3InLCAoKSA9PiB7XG4gIGl0KCdhbGVydHMgb24gZm9yaycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBhbGVydHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgYXVkaXRvciA9IG5ldyBHb3NzaXBBdWRpdG9yKFxuICAgICAge1xuICAgICAgICBnZXRTVEg6IGFzeW5jICgpID0+ICh7IHNpemU6IDEsIHJvb3Q6ICdhJyB9KSxcbiAgICAgICAgZ2V0UmFuZ2U6IGFzeW5jICgpID0+IFsnYiddLFxuICAgICAgfSxcbiAgICAgIHsgYWxlcnQ6IChtOiBzdHJpbmcpID0+IGFsZXJ0cy5wdXNoKG0pIH1cbiAgICApO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGF1ZGl0b3IuYXVkaXRPbmNlKCk7XG4gICAgZXhwZWN0KHJlcy5vaykudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KGFsZXJ0cykudG9FcXVhbChbJ3RyYW5zcGFyZW5jeV9sb2dfbWlzbWF0Y2gnXSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=