{"file":"/Users/brianlong/Developer/summit/server/src/conductor/metering.ts","mappings":";;AAIA,oCASC;AAED,4CAGC;AAlBD,2BAA0B;AAE1B,MAAM,EAAE,GAAG,IAAI,SAAI,CAAC,EAAE,gBAAgB,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC,CAAC;AAE7D,KAAK,UAAU,YAAY,CAChC,MAAc,EACd,CAA8F;IAE9F,MAAM,EAAE,CAAC,KAAK,CACZ;4CACwC,EACxC,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC,CAAC,WAAW,CAAC,CACpE,CAAC;AACJ,CAAC;AAEM,KAAK,UAAU,gBAAgB,CAAC,MAAc,EAAE,KAAa;IAClE,iEAAiE;IACjE,OAAO,gBAAgB,MAAM,IAAI,KAAK,MAAM,CAAC;AAC/C,CAAC","names":[],"sources":["/Users/brianlong/Developer/summit/server/src/conductor/metering.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pg = new Pool({ connectionString: process.env.DATABASE_URL });\n\nexport async function recordMeters(\n  tenant: string,\n  m: { cpuSec: number; gbSec: number; egressGb: number; dpEpsilon: number; pluginCalls: number },\n) {\n  await pg.query(\n    `INSERT INTO meters(tenant, ts, cpu_sec, gb_sec, egress_gb, dp_epsilon, plugin_calls)\n     VALUES ($1, now(), $2, $3, $4, $5, $6)`,\n    [tenant, m.cpuSec, m.gbSec, m.egressGb, m.dpEpsilon, m.pluginCalls],\n  );\n}\n\nexport async function exportBillingCSV(tenant: string, month: string) {\n  // Placeholder: return an S3 URI where an export job would write.\n  return `s3://billing/${tenant}/${month}.csv`;\n}\n\n"],"version":3}