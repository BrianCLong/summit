784303b4dfeb4a892bd7a46b0e7721a9
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EntityResolutionService_1 = require("../services/EntityResolutionService");
describe('EntityResolutionService normalization', () => {
    const svc = new EntityResolutionService_1.EntityResolutionService();
    const normalize = (input) => svc.normalizeEntityProperties(input);
    const key = (input) => svc.generateCanonicalKey(normalize(input));
    it('normalizes emails and aliases', () => {
        const props = normalize({ email: 'User.Name+spam@Gmail.com ' });
        expect(props.email).toBe('username@gmail.com');
    });
    it('normalizes urls', () => {
        const props = normalize({ url: 'https://Example.com/Path/?utm=1' });
        expect(props.url).toBe('example.com/path');
    });
    it('creates same key for equivalent values', () => {
        const k1 = key({ name: 'José Ángel', email: 'USER@EXAMPLE.com' });
        const k2 = key({ name: 'José  Angel', email: 'user@example.com' });
        expect(k1).toBe(k2);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci9zcmMvdGVzdHMvZW50aXR5UmVzb2x1dGlvbi5ub3JtYWxpemF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSxpRkFBOEU7QUFFOUUsUUFBUSxDQUFDLHVDQUF1QyxFQUFFLEdBQUcsRUFBRTtJQUNyRCxNQUFNLEdBQUcsR0FBRyxJQUFJLGlEQUF1QixFQUFFLENBQUM7SUFDMUMsTUFBTSxTQUFTLEdBQUcsQ0FBQyxLQUFVLEVBQUUsRUFBRSxDQUFFLEdBQVcsQ0FBQyx5QkFBeUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoRixNQUFNLEdBQUcsR0FBRyxDQUFDLEtBQVUsRUFBRSxFQUFFLENBQUUsR0FBVyxDQUFDLG9CQUFvQixDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBRWhGLEVBQUUsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7UUFDdkMsTUFBTSxLQUFLLEdBQUcsU0FBUyxDQUFDLEVBQUUsS0FBSyxFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztRQUNoRSxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ2pELENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtRQUN6QixNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsaUNBQWlDLEVBQUUsQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7SUFDN0MsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1FBQ2hELE1BQU0sRUFBRSxHQUFHLEdBQUcsQ0FBQyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixFQUFFLENBQUMsQ0FBQztRQUNsRSxNQUFNLEVBQUUsR0FBRyxHQUFHLENBQUMsRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUFDLENBQUM7UUFDcEUsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN0QixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9zZXJ2ZXIvc3JjL3Rlc3RzL2VudGl0eVJlc29sdXRpb24ubm9ybWFsaXphdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVudGl0eVJlc29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvRW50aXR5UmVzb2x1dGlvblNlcnZpY2UnO1xuXG5kZXNjcmliZSgnRW50aXR5UmVzb2x1dGlvblNlcnZpY2Ugbm9ybWFsaXphdGlvbicsICgpID0+IHtcbiAgY29uc3Qgc3ZjID0gbmV3IEVudGl0eVJlc29sdXRpb25TZXJ2aWNlKCk7XG4gIGNvbnN0IG5vcm1hbGl6ZSA9IChpbnB1dDogYW55KSA9PiAoc3ZjIGFzIGFueSkubm9ybWFsaXplRW50aXR5UHJvcGVydGllcyhpbnB1dCk7XG4gIGNvbnN0IGtleSA9IChpbnB1dDogYW55KSA9PiAoc3ZjIGFzIGFueSkuZ2VuZXJhdGVDYW5vbmljYWxLZXkobm9ybWFsaXplKGlucHV0KSk7XG5cbiAgaXQoJ25vcm1hbGl6ZXMgZW1haWxzIGFuZCBhbGlhc2VzJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0gbm9ybWFsaXplKHsgZW1haWw6ICdVc2VyLk5hbWUrc3BhbUBHbWFpbC5jb20gJyB9KTtcbiAgICBleHBlY3QocHJvcHMuZW1haWwpLnRvQmUoJ3VzZXJuYW1lQGdtYWlsLmNvbScpO1xuICB9KTtcblxuICBpdCgnbm9ybWFsaXplcyB1cmxzJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BzID0gbm9ybWFsaXplKHsgdXJsOiAnaHR0cHM6Ly9FeGFtcGxlLmNvbS9QYXRoLz91dG09MScgfSk7XG4gICAgZXhwZWN0KHByb3BzLnVybCkudG9CZSgnZXhhbXBsZS5jb20vcGF0aCcpO1xuICB9KTtcblxuICBpdCgnY3JlYXRlcyBzYW1lIGtleSBmb3IgZXF1aXZhbGVudCB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgazEgPSBrZXkoeyBuYW1lOiAnSm9zw6kgw4FuZ2VsJywgZW1haWw6ICdVU0VSQEVYQU1QTEUuY29tJyB9KTtcbiAgICBjb25zdCBrMiA9IGtleSh7IG5hbWU6ICdKb3NlzIEgIEFuZ2VsJywgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJyB9KTtcbiAgICBleHBlY3QoazEpLnRvQmUoazIpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9