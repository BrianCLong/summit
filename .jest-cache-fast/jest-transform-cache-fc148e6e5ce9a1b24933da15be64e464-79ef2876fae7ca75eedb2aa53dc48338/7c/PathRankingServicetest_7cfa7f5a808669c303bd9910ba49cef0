45d4c4a34413a71e2c67504c2619f5a4
const { rankPaths } = require("../src/services/PathRankingService");
describe("PathRankingService", () => {
    test("v2 ranking improves top1 path alignment", () => {
        const paths = [
            { from: "A", to: "B", relId: "r1", type: "WEAK" },
            { from: "A", to: "C", relId: "r2", type: "STRONG" },
        ];
        const edgeWeights = { WEAK: 0.5, STRONG: 1 };
        const nodeCentrality = { A: 1, B: 0.2, C: 0.9 };
        const baseline = rankPaths(paths, {
            edgeWeights,
            nodeCentrality,
            strategy: "v1",
        });
        const v2 = rankPaths(paths, {
            edgeWeights,
            nodeCentrality,
            strategy: "v2",
        });
        expect(baseline[0].path.relId).toBe("r1");
        expect(v2[0].path.relId).toBe("r2");
        const baselineAcc = baseline[0].path.relId === "r2" ? 1 : 0;
        const v2Acc = v2[0].path.relId === "r2" ? 1 : 0;
        expect(v2Acc - baselineAcc).toBeGreaterThanOrEqual(0.15);
        expect(v2[0].score_breakdown).toHaveProperty("edgeType");
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9QYXRoUmFua2luZ1NlcnZpY2UudGVzdC50cyIsIm1hcHBpbmdzIjoiQUFBQSxNQUFNLEVBQUUsU0FBUyxFQUFFLEdBQUcsT0FBTyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7QUFFcEUsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtJQUNsQyxJQUFJLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO1FBQ25ELE1BQU0sS0FBSyxHQUFHO1lBQ1osRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFO1lBQ2pELEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtTQUNwRCxDQUFDO1FBQ0YsTUFBTSxXQUFXLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUM3QyxNQUFNLGNBQWMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7UUFFaEQsTUFBTSxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssRUFBRTtZQUNoQyxXQUFXO1lBQ1gsY0FBYztZQUNkLFFBQVEsRUFBRSxJQUFJO1NBQ2YsQ0FBQyxDQUFDO1FBQ0gsTUFBTSxFQUFFLEdBQUcsU0FBUyxDQUFDLEtBQUssRUFBRTtZQUMxQixXQUFXO1lBQ1gsY0FBYztZQUNkLFFBQVEsRUFBRSxJQUFJO1NBQ2YsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVwQyxNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzVELE1BQU0sS0FBSyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEQsTUFBTSxDQUFDLEtBQUssR0FBRyxXQUFXLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6RCxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMzRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9zZXJ2ZXIvdGVzdHMvUGF0aFJhbmtpbmdTZXJ2aWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyByYW5rUGF0aHMgfSA9IHJlcXVpcmUoXCIuLi9zcmMvc2VydmljZXMvUGF0aFJhbmtpbmdTZXJ2aWNlXCIpO1xuXG5kZXNjcmliZShcIlBhdGhSYW5raW5nU2VydmljZVwiLCAoKSA9PiB7XG4gIHRlc3QoXCJ2MiByYW5raW5nIGltcHJvdmVzIHRvcDEgcGF0aCBhbGlnbm1lbnRcIiwgKCkgPT4ge1xuICAgIGNvbnN0IHBhdGhzID0gW1xuICAgICAgeyBmcm9tOiBcIkFcIiwgdG86IFwiQlwiLCByZWxJZDogXCJyMVwiLCB0eXBlOiBcIldFQUtcIiB9LFxuICAgICAgeyBmcm9tOiBcIkFcIiwgdG86IFwiQ1wiLCByZWxJZDogXCJyMlwiLCB0eXBlOiBcIlNUUk9OR1wiIH0sXG4gICAgXTtcbiAgICBjb25zdCBlZGdlV2VpZ2h0cyA9IHsgV0VBSzogMC41LCBTVFJPTkc6IDEgfTtcbiAgICBjb25zdCBub2RlQ2VudHJhbGl0eSA9IHsgQTogMSwgQjogMC4yLCBDOiAwLjkgfTtcblxuICAgIGNvbnN0IGJhc2VsaW5lID0gcmFua1BhdGhzKHBhdGhzLCB7XG4gICAgICBlZGdlV2VpZ2h0cyxcbiAgICAgIG5vZGVDZW50cmFsaXR5LFxuICAgICAgc3RyYXRlZ3k6IFwidjFcIixcbiAgICB9KTtcbiAgICBjb25zdCB2MiA9IHJhbmtQYXRocyhwYXRocywge1xuICAgICAgZWRnZVdlaWdodHMsXG4gICAgICBub2RlQ2VudHJhbGl0eSxcbiAgICAgIHN0cmF0ZWd5OiBcInYyXCIsXG4gICAgfSk7XG5cbiAgICBleHBlY3QoYmFzZWxpbmVbMF0ucGF0aC5yZWxJZCkudG9CZShcInIxXCIpO1xuICAgIGV4cGVjdCh2MlswXS5wYXRoLnJlbElkKS50b0JlKFwicjJcIik7XG5cbiAgICBjb25zdCBiYXNlbGluZUFjYyA9IGJhc2VsaW5lWzBdLnBhdGgucmVsSWQgPT09IFwicjJcIiA/IDEgOiAwO1xuICAgIGNvbnN0IHYyQWNjID0gdjJbMF0ucGF0aC5yZWxJZCA9PT0gXCJyMlwiID8gMSA6IDA7XG4gICAgZXhwZWN0KHYyQWNjIC0gYmFzZWxpbmVBY2MpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMC4xNSk7XG4gICAgZXhwZWN0KHYyWzBdLnNjb3JlX2JyZWFrZG93bikudG9IYXZlUHJvcGVydHkoXCJlZGdlVHlwZVwiKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==