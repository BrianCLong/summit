{"file":"/Users/brianlong/Developer/summit/server/src/middleware/rfa.ts","mappings":";;AAEA,sCAOC;AAPD,SAAgB,aAAa,CAAC,MAAgB;IAC5C,OAAO,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;QACzD,IAAI,MAAM,CAAC,QAAQ,CAAC,wBAAwB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC;YACvE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,4BAA4B,EAAE,CAAC,CAAC;QACvE,CAAC;QACD,IAAI,EAAE,CAAC;IACT,CAAC,CAAC;AACJ,CAAC","names":[],"sources":["/Users/brianlong/Developer/summit/server/src/middleware/rfa.ts"],"sourcesContent":["import type { Request, Response, NextFunction } from 'express';\n\nexport function requireReason(labels: string[]) {\n  return (req: Request, res: Response, next: NextFunction) => {\n    if (labels.includes('sensitivity:restricted') && !req.headers['x-rfa']) {\n      return res.status(403).json({ error: 'reason-for-access required' });\n    }\n    next();\n  };\n}\n\n"],"version":3}