e7ee73dae4a9cbc65568eca8a06a6e33
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const src_1 = require("../src");
const crypto_1 = require("crypto");
describe('ATL', () => {
    test('should train and infer tariffs', () => {
        const historicalData = [
            { fp: { contentHash: (0, crypto_1.randomUUID)(), formatSig: 'mime:1000:0:NOEXIF', timingSig: '12h:0', xformSig: 'nokpw', route: 'tip' }, outcome: { accepted: 1, disputed: 0, retracted: 0, beliefDecay: 0.1 } },
            { fp: { contentHash: (0, crypto_1.randomUUID)(), formatSig: 'mime:500:0:EXIF', timingSig: '02h:1', xformSig: 'kpw', route: 'social' }, outcome: { accepted: 0, disputed: 1, retracted: 0, beliefDecay: 0.5 } },
        ];
        const model = (0, src_1.trainATL)(historicalData);
        const testFp = { contentHash: (0, crypto_1.randomUUID)(), formatSig: 'mime:2000:1:NOEXIF', timingSig: '23h:0', xformSig: 'nokpw', route: 'email' };
        const tariff = (0, src_1.inferTariff)(model, testFp);
        expect(tariff).toHaveProperty('minProofLevel');
        expect(tariff).toHaveProperty('rateLimit');
        expect(tariff).toHaveProperty('throttleMs');
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL2F0bC90ZXN0cy9hdGwuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLGdDQUErQztBQUMvQyxtQ0FBb0M7QUFFcEMsUUFBUSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUU7SUFDbkIsSUFBSSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtRQUMxQyxNQUFNLGNBQWMsR0FBRztZQUNyQixFQUFFLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxJQUFBLG1CQUFVLEdBQUUsRUFBRSxTQUFTLEVBQUUsb0JBQW9CLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUU7WUFDbE0sRUFBRSxFQUFFLEVBQUUsRUFBRSxXQUFXLEVBQUUsSUFBQSxtQkFBVSxHQUFFLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsV0FBVyxFQUFFLEdBQUcsRUFBRSxFQUFFO1NBQ2pNLENBQUM7UUFDRixNQUFNLEtBQUssR0FBRyxJQUFBLGNBQVEsRUFBQyxjQUFjLENBQUMsQ0FBQztRQUN2QyxNQUFNLE1BQU0sR0FBRyxFQUFFLFdBQVcsRUFBRSxJQUFBLG1CQUFVLEdBQUUsRUFBRSxTQUFTLEVBQUUsb0JBQW9CLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsQ0FBQztRQUNySSxNQUFNLE1BQU0sR0FBRyxJQUFBLGlCQUFXLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBRTFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDL0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUMzQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzlDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL2F0bC90ZXN0cy9hdGwuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0cmFpbkFUTCwgaW5mZXJUYXJpZmYgfSBmcm9tICcuLi9zcmMnO1xuaW1wb3J0IHsgcmFuZG9tVVVJRCB9IGZyb20gJ2NyeXB0byc7XG5cbmRlc2NyaWJlKCdBVEwnLCAoKSA9PiB7XG4gIHRlc3QoJ3Nob3VsZCB0cmFpbiBhbmQgaW5mZXIgdGFyaWZmcycsICgpID0+IHtcbiAgICBjb25zdCBoaXN0b3JpY2FsRGF0YSA9IFtcbiAgICAgIHsgZnA6IHsgY29udGVudEhhc2g6IHJhbmRvbVVVSUQoKSwgZm9ybWF0U2lnOiAnbWltZToxMDAwOjA6Tk9FWElGJywgdGltaW5nU2lnOiAnMTJoOjAnLCB4Zm9ybVNpZzogJ25va3B3Jywgcm91dGU6ICd0aXAnIH0sIG91dGNvbWU6IHsgYWNjZXB0ZWQ6IDEsIGRpc3B1dGVkOiAwLCByZXRyYWN0ZWQ6IDAsIGJlbGllZkRlY2F5OiAwLjEgfSB9LFxuICAgICAgeyBmcDogeyBjb250ZW50SGFzaDogcmFuZG9tVVVJRCgpLCBmb3JtYXRTaWc6ICdtaW1lOjUwMDowOkVYSUYnLCB0aW1pbmdTaWc6ICcwMmg6MScsIHhmb3JtU2lnOiAna3B3Jywgcm91dGU6ICdzb2NpYWwnIH0sIG91dGNvbWU6IHsgYWNjZXB0ZWQ6IDAsIGRpc3B1dGVkOiAxLCByZXRyYWN0ZWQ6IDAsIGJlbGllZkRlY2F5OiAwLjUgfSB9LFxuICAgIF07XG4gICAgY29uc3QgbW9kZWwgPSB0cmFpbkFUTChoaXN0b3JpY2FsRGF0YSk7XG4gICAgY29uc3QgdGVzdEZwID0geyBjb250ZW50SGFzaDogcmFuZG9tVVVJRCgpLCBmb3JtYXRTaWc6ICdtaW1lOjIwMDA6MTpOT0VYSUYnLCB0aW1pbmdTaWc6ICcyM2g6MCcsIHhmb3JtU2lnOiAnbm9rcHcnLCByb3V0ZTogJ2VtYWlsJyB9O1xuICAgIGNvbnN0IHRhcmlmZiA9IGluZmVyVGFyaWZmKG1vZGVsLCB0ZXN0RnApO1xuXG4gICAgZXhwZWN0KHRhcmlmZikudG9IYXZlUHJvcGVydHkoJ21pblByb29mTGV2ZWwnKTtcbiAgICBleHBlY3QodGFyaWZmKS50b0hhdmVQcm9wZXJ0eSgncmF0ZUxpbWl0Jyk7XG4gICAgZXhwZWN0KHRhcmlmZikudG9IYXZlUHJvcGVydHkoJ3Rocm90dGxlTXMnKTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=