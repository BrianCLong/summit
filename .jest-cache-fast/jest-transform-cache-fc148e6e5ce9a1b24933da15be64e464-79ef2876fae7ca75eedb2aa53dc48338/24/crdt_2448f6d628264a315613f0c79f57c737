a60773341e7376336f91db380371b1f4
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TextCRDT = void 0;
class TextCRDT {
    text;
    constructor(initial = '') {
        this.text = initial;
    }
    apply(op) {
        if (op.insert) {
            const { pos, value } = op.insert;
            this.text = this.text.slice(0, pos) + value + this.text.slice(pos);
        }
        else if (op.delete) {
            const { pos, count } = op.delete;
            this.text = this.text.slice(0, pos) + this.text.slice(pos + count);
        }
    }
    value() {
        return this.text;
    }
    merge(other) {
        return new TextCRDT(other.value());
    }
}
exports.TextCRDT = TextCRDT;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL3Nkay9jb2xsYWItanMvc3JjL2NyZHQudHMiLCJtYXBwaW5ncyI6Ijs7O0FBS0EsTUFBYSxRQUFRO0lBQ1gsSUFBSSxDQUFTO0lBRXJCLFlBQVksT0FBTyxHQUFHLEVBQUU7UUFDdEIsSUFBSSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7SUFDdEIsQ0FBQztJQUVELEtBQUssQ0FBQyxFQUFhO1FBQ2pCLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2QsTUFBTSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyRSxDQUFDO2FBQU0sSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDckIsTUFBTSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQztRQUNyRSxDQUFDO0lBQ0gsQ0FBQztJQUVELEtBQUs7UUFDSCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDbkIsQ0FBQztJQUVELEtBQUssQ0FBQyxLQUFlO1FBQ25CLE9BQU8sSUFBSSxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDckMsQ0FBQztDQUNGO0FBeEJELDRCQXdCQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYnJpYW5sb25nL0RldmVsb3Blci9zdW1taXQvcGFja2FnZXMvc2RrL2NvbGxhYi1qcy9zcmMvY3JkdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBPcGVyYXRpb24gPSB7XG4gIGluc2VydD86IHsgcG9zOiBudW1iZXI7IHZhbHVlOiBzdHJpbmcgfTtcbiAgZGVsZXRlPzogeyBwb3M6IG51bWJlcjsgY291bnQ6IG51bWJlciB9O1xufTtcblxuZXhwb3J0IGNsYXNzIFRleHRDUkRUIHtcbiAgcHJpdmF0ZSB0ZXh0OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoaW5pdGlhbCA9ICcnKSB7XG4gICAgdGhpcy50ZXh0ID0gaW5pdGlhbDtcbiAgfVxuXG4gIGFwcGx5KG9wOiBPcGVyYXRpb24pOiB2b2lkIHtcbiAgICBpZiAob3AuaW5zZXJ0KSB7XG4gICAgICBjb25zdCB7IHBvcywgdmFsdWUgfSA9IG9wLmluc2VydDtcbiAgICAgIHRoaXMudGV4dCA9IHRoaXMudGV4dC5zbGljZSgwLCBwb3MpICsgdmFsdWUgKyB0aGlzLnRleHQuc2xpY2UocG9zKTtcbiAgICB9IGVsc2UgaWYgKG9wLmRlbGV0ZSkge1xuICAgICAgY29uc3QgeyBwb3MsIGNvdW50IH0gPSBvcC5kZWxldGU7XG4gICAgICB0aGlzLnRleHQgPSB0aGlzLnRleHQuc2xpY2UoMCwgcG9zKSArIHRoaXMudGV4dC5zbGljZShwb3MgKyBjb3VudCk7XG4gICAgfVxuICB9XG5cbiAgdmFsdWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy50ZXh0O1xuICB9XG5cbiAgbWVyZ2Uob3RoZXI6IFRleHRDUkRUKTogVGV4dENSRFQge1xuICAgIHJldHVybiBuZXcgVGV4dENSRFQob3RoZXIudmFsdWUoKSk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==