6def2f2f3a6c7cd2137cdc31009674b0
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const supertest_1 = __importDefault(require("supertest"));
const express_1 = __importDefault(require("express"));
const n8n_1 = __importDefault(require("../src/routes/n8n"));
describe('n8n raw-body route', () => {
    const app = (0, express_1.default)();
    app.use('/', n8n_1.default);
    const N8N_ENABLED = process.env.N8N_WEBHOOKS_ENABLED !== 'false';
    (N8N_ENABLED ? it : it.skip)('accepts raw payload before global json', async () => {
        const res = await (0, supertest_1.default)(app)
            .post('/webhooks/n8n')
            .set('Content-Type', 'application/json')
            .send(Buffer.from(JSON.stringify({ ok: true }), 'utf8'));
        expect([200, 204, 401, 403, 503]).toContain(res.status);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9uOG4tcmF3LWJvZHkuc3BlYy50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLDBEQUFnQztBQUNoQyxzREFBOEI7QUFDOUIsNERBQTBDO0FBRTFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsTUFBTSxHQUFHLEdBQUcsSUFBQSxpQkFBTyxHQUFFLENBQUM7SUFDdEIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsYUFBUyxDQUFDLENBQUM7SUFFeEIsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsS0FBSyxPQUFPLENBQUM7SUFDakUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLHdDQUF3QyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ2hGLE1BQU0sR0FBRyxHQUFHLE1BQU0sSUFBQSxtQkFBTyxFQUFDLEdBQUcsQ0FBQzthQUMzQixJQUFJLENBQUMsZUFBZSxDQUFDO2FBQ3JCLEdBQUcsQ0FBQyxjQUFjLEVBQUUsa0JBQWtCLENBQUM7YUFDdkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDM0QsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMxRCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9icmlhbmxvbmcvRGV2ZWxvcGVyL3N1bW1pdC9zZXJ2ZXIvdGVzdHMvbjhuLXJhdy1ib2R5LnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJlcXVlc3QgZnJvbSAnc3VwZXJ0ZXN0JztcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IG44blJvdXRlciBmcm9tICcuLi9zcmMvcm91dGVzL244bic7XG5cbmRlc2NyaWJlKCduOG4gcmF3LWJvZHkgcm91dGUnLCAoKSA9PiB7XG4gIGNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcbiAgYXBwLnVzZSgnLycsIG44blJvdXRlcik7XG5cbiAgY29uc3QgTjhOX0VOQUJMRUQgPSBwcm9jZXNzLmVudi5OOE5fV0VCSE9PS1NfRU5BQkxFRCAhPT0gJ2ZhbHNlJztcbiAgKE44Tl9FTkFCTEVEID8gaXQgOiBpdC5za2lwKSgnYWNjZXB0cyByYXcgcGF5bG9hZCBiZWZvcmUgZ2xvYmFsIGpzb24nLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAucG9zdCgnL3dlYmhvb2tzL244bicpXG4gICAgICAuc2V0KCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpXG4gICAgICAuc2VuZChCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeSh7IG9rOiB0cnVlIH0pLCAndXRmOCcpKTtcbiAgICBleHBlY3QoWzIwMCwgMjA0LCA0MDEsIDQwMywgNTAzXSkudG9Db250YWluKHJlcy5zdGF0dXMpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9