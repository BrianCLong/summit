29390de2b175911a9cb718b4c4c71d33
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createProvenanceRecord = createProvenanceRecord;
const crypto_1 = require("crypto");
const SECRET = process.env.PROVENANCE_SECRET || 'dev-secret';
function createProvenanceRecord(data, algorithm = 'SHA-256', version = '1', timestamp = new Date().toISOString()) {
    const hash = (0, crypto_1.createHash)('sha256').update(data).digest('hex');
    const signature = (0, crypto_1.createHmac)('sha256', SECRET)
        .update(`${hash}|${algorithm}|${version}|${timestamp}`)
        .digest('hex');
    return { inputHash: hash, algorithm, version, timestamp, signature };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3BhY2thZ2VzL3NoYXJlZC9wcm92ZW5hbmNlLnRzIiwibWFwcGluZ3MiOiI7O0FBWUEsd0RBV0M7QUF2QkQsbUNBQWdEO0FBVWhELE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLElBQUksWUFBWSxDQUFDO0FBRTdELFNBQWdCLHNCQUFzQixDQUNwQyxJQUFxQixFQUNyQixTQUFTLEdBQUcsU0FBUyxFQUNyQixPQUFPLEdBQUcsR0FBRyxFQUNiLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtJQUVwQyxNQUFNLElBQUksR0FBRyxJQUFBLG1CQUFVLEVBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3RCxNQUFNLFNBQVMsR0FBRyxJQUFBLG1CQUFVLEVBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQztTQUMzQyxNQUFNLENBQUMsR0FBRyxJQUFJLElBQUksU0FBUyxJQUFJLE9BQU8sSUFBSSxTQUFTLEVBQUUsQ0FBQztTQUN0RCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDakIsT0FBTyxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLENBQUM7QUFDdkUsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYnJpYW5sb25nL0RldmVsb3Blci9zdW1taXQvcGFja2FnZXMvc2hhcmVkL3Byb3ZlbmFuY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlSGFzaCwgY3JlYXRlSG1hYyB9IGZyb20gJ2NyeXB0byc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmVuYW5jZVJlY29yZCB7XG4gIGlucHV0SGFzaDogc3RyaW5nO1xuICBhbGdvcml0aG06IHN0cmluZztcbiAgdmVyc2lvbjogc3RyaW5nO1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgc2lnbmF0dXJlOiBzdHJpbmc7XG59XG5cbmNvbnN0IFNFQ1JFVCA9IHByb2Nlc3MuZW52LlBST1ZFTkFOQ0VfU0VDUkVUIHx8ICdkZXYtc2VjcmV0JztcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVByb3ZlbmFuY2VSZWNvcmQoXG4gIGRhdGE6IEJ1ZmZlciB8IHN0cmluZyxcbiAgYWxnb3JpdGhtID0gJ1NIQS0yNTYnLFxuICB2ZXJzaW9uID0gJzEnLFxuICB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4pOiBQcm92ZW5hbmNlUmVjb3JkIHtcbiAgY29uc3QgaGFzaCA9IGNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShkYXRhKS5kaWdlc3QoJ2hleCcpO1xuICBjb25zdCBzaWduYXR1cmUgPSBjcmVhdGVIbWFjKCdzaGEyNTYnLCBTRUNSRVQpXG4gICAgLnVwZGF0ZShgJHtoYXNofXwke2FsZ29yaXRobX18JHt2ZXJzaW9ufXwke3RpbWVzdGFtcH1gKVxuICAgIC5kaWdlc3QoJ2hleCcpO1xuICByZXR1cm4geyBpbnB1dEhhc2g6IGhhc2gsIGFsZ29yaXRobSwgdmVyc2lvbiwgdGltZXN0YW1wLCBzaWduYXR1cmUgfTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==