30233c6e1e8ef844f8b2683048c9b4c2
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const rfa_1 = require("../src/middleware/rfa");
describe("reason-for-access middleware", () => {
    it("blocks restricted without reason", () => {
        const mw = (0, rfa_1.requireReason)(["sensitivity:restricted"]);
        const req = { headers: {} };
        const res = { status: (c) => ({ json: (x) => ({ c, x }) }) };
        const next = jest.fn();
        const out = mw(req, res, next);
        expect(next).not.toHaveBeenCalled();
        expect(out).toBeDefined();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2JyaWFubG9uZy9EZXZlbG9wZXIvc3VtbWl0L3NlcnZlci90ZXN0cy9yZmEuc3BlYy50cyIsIm1hcHBpbmdzIjoiOztBQUFBLCtDQUFzRDtBQUV0RCxRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQzVDLEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7UUFDMUMsTUFBTSxFQUFFLEdBQUcsSUFBQSxtQkFBYSxFQUFDLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDO1FBQ3JELE1BQU0sR0FBRyxHQUFRLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2pDLE1BQU0sR0FBRyxHQUFRLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDL0UsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQy9CLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDNUIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYnJpYW5sb25nL0RldmVsb3Blci9zdW1taXQvc2VydmVyL3Rlc3RzL3JmYS5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlcXVpcmVSZWFzb24gfSBmcm9tIFwiLi4vc3JjL21pZGRsZXdhcmUvcmZhXCI7XG5cbmRlc2NyaWJlKFwicmVhc29uLWZvci1hY2Nlc3MgbWlkZGxld2FyZVwiLCAoKSA9PiB7XG4gIGl0KFwiYmxvY2tzIHJlc3RyaWN0ZWQgd2l0aG91dCByZWFzb25cIiwgKCkgPT4ge1xuICAgIGNvbnN0IG13ID0gcmVxdWlyZVJlYXNvbihbXCJzZW5zaXRpdml0eTpyZXN0cmljdGVkXCJdKTtcbiAgICBjb25zdCByZXE6IGFueSA9IHsgaGVhZGVyczoge30gfTtcbiAgICBjb25zdCByZXM6IGFueSA9IHsgc3RhdHVzOiAoYzogbnVtYmVyKSA9PiAoeyBqc29uOiAoeDogYW55KSA9PiAoeyBjLCB4IH0pIH0pIH07XG4gICAgY29uc3QgbmV4dCA9IGplc3QuZm4oKTtcbiAgICBjb25zdCBvdXQgPSBtdyhyZXEsIHJlcywgbmV4dCk7XG4gICAgZXhwZWN0KG5leHQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgZXhwZWN0KG91dCkudG9CZURlZmluZWQoKTtcbiAgfSk7XG59KTtcblxuIl0sInZlcnNpb24iOjN9