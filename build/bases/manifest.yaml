# Approved base images and per-service mapping for container hardening
approvedBases:
  runtime:
    - gcr.io/distroless/nodejs20-debian12
    - gcr.io/distroless/python3
    - gcr.io/distroless/static:nonroot
    - cgr.dev/chainguard/node
    - cgr.dev/chainguard/python
    - cgr.dev/chainguard/static
  builder:
    - node:20-bullseye-slim
    - python:3.11-slim
    - golang:1.22-alpine
    - cgr.dev/chainguard/go

services:
  api-gateway:
    builder: node:20-bullseye-slim
    runtime: gcr.io/distroless/nodejs20-debian12
    lastRefreshed: 2025-08-21
  analytics-service:
    builder: node:20-bullseye-slim
    runtime: gcr.io/distroless/nodejs20-debian12
    lastRefreshed: 2025-08-21
  ml-engine:
    builder: python:3.11-slim
    runtime: gcr.io/distroless/python3
    lastRefreshed: 2025-08-21
  graph-analytics:
    builder: golang:1.22-alpine
    runtime: gcr.io/distroless/static:nonroot
    lastRefreshed: 2025-08-21
  feed-processor:
    builder: python:3.11-slim
    runtime: gcr.io/distroless/python3
    lastRefreshed: 2025-08-21
  search-engine:
    builder: node:20-bullseye-slim
    runtime: gcr.io/distroless/nodejs20-debian12
    lastRefreshed: 2025-08-21
  workflow-engine:
    builder: node:20-bullseye-slim
    runtime: gcr.io/distroless/nodejs20-debian12
    lastRefreshed: 2025-08-21
  mobile-interface:
    builder: node:20-bullseye-slim
    runtime: gcr.io/distroless/nodejs20-debian12
    lastRefreshed: 2025-08-21

metadata:
  owner: platform-security
  schedule: weekly
  notes: |
    Runtime images must not contain compilers or package managers. Builders may include toolchains but
    final stages must run as UID 65532 with read-only root filesystems and dropped capabilities.
