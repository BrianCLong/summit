# SonarQube Project Configuration for IntelGraph Platform
# Documentation: https://docs.sonarqube.org/latest/analysis/analysis-parameters/

# Project identification
sonar.projectKey=intelgraph-platform
sonar.projectName=IntelGraph Platform
sonar.projectVersion=1.0.0
sonar.organization=intelgraph

# Source code location
sonar.sources=server/src,client/src,apps,packages,services
sonar.tests=server/src/**/*.test.ts,server/src/**/*.test.js,client/src/**/*.test.tsx,client/src/**/*.test.jsx,e2e

# Exclusions
sonar.exclusions=**/node_modules/**,**/*.test.ts,**/*.test.js,**/*.spec.ts,**/*.spec.js,**/dist/**,**/build/**,**/coverage/**,**/.turbo/**,**/archive/**

# Test coverage
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.typescript.lcov.reportPaths=coverage/lcov.info
# Coverage exclusions
sonar.coverage.exclusions=**/*.test.ts,**/*.test.js,**/*.spec.ts,**/*.spec.js,**/e2e/**,**/tests/**

# Language settings
sonar.language=js,ts
sonar.sourceEncoding=UTF-8

# ===================================
# MAINTAINABILITY METRICS THRESHOLDS
# ===================================

# Cyclomatic Complexity per function
# Default: 10, Adjusted for current codebase: 15
# Target: Reduce to 10 over time
sonar.javascript.complexity.functions.threshold=15
sonar.typescript.complexity.functions.threshold=15

# Cyclomatic Complexity per file
# Files should not exceed 50
# Current issues: Files with 110 conditionals found
sonar.javascript.complexity.file.threshold=50
sonar.typescript.complexity.file.threshold=50

# Cognitive Complexity
# More strict than cyclomatic - measures understandability
sonar.javascript.cognitiveComplexity.threshold=15
sonar.typescript.cognitiveComplexity.threshold=15

# Lines of Code per file
# Target: 500 lines max
# Current issues: 71 files over 1000 lines
sonar.javascript.file.linesThreshold=500
sonar.typescript.file.linesThreshold=500

# Lines of Code per function
# Target: 100 lines max
# Current issues: Functions over 200 lines found
sonar.javascript.function.linesThreshold=100
sonar.typescript.function.linesThreshold=100

# Number of methods per class
# Target: 20 methods max
# Current issues: Classes with 117 methods found (God Objects)
sonar.javascript.class.methodsThreshold=20
sonar.typescript.class.methodsThreshold=20

# Number of parameters per function
# Target: 5 parameters max
sonar.javascript.function.parametersThreshold=5
sonar.typescript.function.parametersThreshold=5

# Duplication
# Minimum lines for duplication detection
sonar.cpd.minimumLines=10
sonar.cpd.minimumTokens=100

# Technical Debt
# Effort to fix 1 issue (in minutes)
sonar.technicalDebt.hoursInDay=8
sonar.technicalDebt.ratingGrid=0.05,0.1,0.2,0.5

# ===================================
# QUALITY GATES
# ===================================

# Code Coverage - Minimum percentage
sonar.coverage.minimum=70
sonar.coverage.target=80

# Duplicated Lines - Maximum percentage
sonar.duplicatedLines.maximum=5

# Maintainability Rating
# A = debt ratio < 5%, B = 6-10%, C = 11-20%, D = 21-50%, E = > 50%
sonar.maintainability.rating.threshold=A

# Reliability Rating
sonar.reliability.rating.threshold=A

# Security Rating
sonar.security.rating.threshold=A

# New Code Quality Gate
sonar.qualitygate.wait=true
sonar.newCode.referenceBranch=main

# ===================================
# ANALYSIS SETTINGS
# ===================================

# Enable issue tracking
sonar.issue.ignore.multicriteria=e1

# Ignore issues in generated code
sonar.issue.ignore.multicriteria.e1.ruleKey=*
sonar.issue.ignore.multicriteria.e1.resourceKey=**/generated/**

# Analysis performance
sonar.scm.disabled=false
sonar.scm.provider=git

# Pull request analysis
sonar.pullrequest.github.repository=BrianCLong/summit
sonar.pullrequest.provider=github

# Branch analysis
sonar.branch.name=${env.GITHUB_REF_NAME}
sonar.branch.target=main
