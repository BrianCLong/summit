route:
  receiver: default
  group_by: [alertname, expert, tenant_tier]
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 4h
  routes:
    - matchers:
        - alertname =~ "SLO.*"
      receiver: pagerduty
      continue: true
    - matchers:
        - severity = "page"
      receiver: pagerduty
    - matchers:
        - severity = "warn"
      receiver: slack
    - matchers:
        - service = "cost"
      receiver: github-issues
      continue: true
receivers:
  - name: default
    slack_configs:
      - channel: '#conductor-ops'
        send_resolved: true
        title: '[{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}'
        text: |
          {{ range .Alerts }}â€¢ {{ .Annotations.summary }}
            {{- if .Labels.service }} (service={{ .Labels.service }}){{- end }}
            {{- if .Labels.tenant_tier }} (tier={{ .Labels.tenant_tier }}){{- end }}
            {{- if .Labels.expert }} (expert={{ .Labels.expert }}){{- end }}
          {{ end }}
  - name: pagerduty
    pagerduty_configs:
      - routing_key: '<PD_ROUTING_KEY>'
        severity: 'error'
  - name: slack
    slack_configs:
      - channel: '#conductor-warnings'
        send_resolved: true
  - name: github-issues
    webhook_configs:
      - url: 'https://ops-gateway.summit.internal/webhooks/github-issue'
        send_resolved: false
        http_config:
          bearer_token: '<GITHUB_APP_TOKEN>'
