service: companyos-api
owner: companyos-team
description: >
  SLOs for the CompanyOS API – disclosure packs, compliance actions, and internal
  policy operations.

slos:
  - name: availability
    objective: 0.995        # 99.5% success rate
    window: 30d
    indicator:
      type: ratio
      good: sum(rate(http_requests_total{job="companyos-api", status_code!~"5.."}[5m]))
      total: sum(rate(http_requests_total{job="companyos-api"}[5m]))

  - name: latency_p95
    objective: 0.99         # 99% of requests under target
    window: 30d
    target_ms: 300
    indicator:
      type: latency
      histogram: histogram_quantile(
        0.95,
        sum by (le) (
          rate(http_request_duration_seconds_bucket{job="companyos-api"}[5m])
        )
      )
      # we’ll compare this value against target_ms in tooling

error_budget_policies:
  rollout_block_threshold: 0.4   # block releases if >40% of error budget burned
  alert_threshold: 0.7           # page if >70% burned

canary_thresholds:
  # relative limits compared to previous window / baseline
  error_rate_factor: 2.0         # 2x error rate -> fail canary
  error_rate_abs: 0.02           # >2% absolute failure rate trips gate when baseline ~0
  latency_factor: 2.0            # 2x p95 latency -> fail canary
  latency_abs_seconds: 0.3       # 300ms absolute guardrail when baseline ~0
  evaluation_window: 10m
