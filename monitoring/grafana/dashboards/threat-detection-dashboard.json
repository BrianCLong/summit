{
  "dashboard": {
    "title": "Advanced Threat Detection & Security Operations",
    "tags": ["security", "threat-detection", "siem"],
    "timezone": "browser",
    "editable": true,
    "graphTooltip": 1,
    "panels": [
      {
        "title": "Threat Overview",
        "type": "row",
        "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 }
      },
      {
        "title": "Real-time Threat Level",
        "type": "gauge",
        "gridPos": { "x": 0, "y": 1, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "avg(security_threat_score)",
            "legendFormat": "Threat Level"
          }
        ],
        "options": {
          "showThresholdLabels": true,
          "showThresholdMarkers": true
        },
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "steps": [
                { "value": 0, "color": "green" },
                { "value": 0.3, "color": "yellow" },
                { "value": 0.7, "color": "orange" },
                { "value": 0.9, "color": "red" }
              ]
            },
            "min": 0,
            "max": 1
          }
        }
      },
      {
        "title": "Active Threats by Severity",
        "type": "piechart",
        "gridPos": { "x": 6, "y": 1, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "sum by (severity) (rate(security_events_total[5m]))",
            "legendFormat": "{{ severity }}"
          }
        ]
      },
      {
        "title": "Threat Events (Last Hour)",
        "type": "stat",
        "gridPos": { "x": 12, "y": 1, "w": 3, "h": 2 },
        "targets": [
          {
            "expr": "sum(increase(security_events_total[1h]))"
          }
        ],
        "options": {
          "colorMode": "background",
          "graphMode": "area"
        }
      },
      {
        "title": "Critical Alerts",
        "type": "stat",
        "gridPos": { "x": 15, "y": 1, "w": 3, "h": 2 },
        "targets": [
          {
            "expr": "sum(security_alerts_total{severity=\"CRITICAL\"})"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": { "mode": "palette-classic" },
            "thresholds": {
              "steps": [
                { "value": 0, "color": "green" },
                { "value": 1, "color": "red" }
              ]
            }
          }
        }
      },
      {
        "title": "Anomaly Detection Rate",
        "type": "stat",
        "gridPos": { "x": 18, "y": 1, "w": 3, "h": 2 },
        "targets": [
          {
            "expr": "rate(anomaly_detections_total[5m])"
          }
        ],
        "options": {
          "unit": "ops"
        }
      },
      {
        "title": "MTTR (Mean Time to Respond)",
        "type": "stat",
        "gridPos": { "x": 21, "y": 1, "w": 3, "h": 2 },
        "targets": [
          {
            "expr": "avg(alert_response_time_seconds)"
          }
        ],
        "options": {
          "unit": "s"
        }
      },
      {
        "title": "Threat Detection Timeline",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 5, "w": 24, "h": 8 },
        "targets": [
          {
            "expr": "sum by (category) (rate(security_events_total[5m]))",
            "legendFormat": "{{ category }}"
          }
        ],
        "options": {
          "legend": { "displayMode": "list", "placement": "bottom" },
          "tooltip": { "mode": "multi" }
        }
      },
      {
        "title": "Network Threats",
        "type": "row",
        "gridPos": { "x": 0, "y": 13, "w": 24, "h": 1 }
      },
      {
        "title": "DDoS Attack Indicators",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 14, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(security_events_total{category=\"DDOS\"}[1m])",
            "legendFormat": "DDoS Events/sec"
          },
          {
            "expr": "ddos_request_rate",
            "legendFormat": "Request Rate"
          }
        ]
      },
      {
        "title": "Port Scan Detection",
        "type": "timeseries",
        "gridPos": { "x": 12, "y": 14, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(security_events_total{category=\"PORT_SCAN\"}[5m])",
            "legendFormat": "Port Scans"
          }
        ]
      },
      {
        "title": "C2 Beaconing Activity",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 20, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(security_events_total{category=\"C2_COMMUNICATION\"}[5m])",
            "legendFormat": "C2 Beaconing"
          }
        ]
      },
      {
        "title": "Data Exfiltration Attempts",
        "type": "timeseries",
        "gridPos": { "x": 12, "y": 20, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(security_events_total{category=\"DATA_EXFILTRATION\"}[5m])",
            "legendFormat": "Exfiltration Events"
          },
          {
            "expr": "sum(data_transfer_bytes) by (source_ip)",
            "legendFormat": "{{ source_ip }}"
          }
        ]
      },
      {
        "title": "Machine Learning Models",
        "type": "row",
        "gridPos": { "x": 0, "y": 26, "w": 24, "h": 1 }
      },
      {
        "title": "ML Model Accuracy",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 27, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "ml_model_accuracy",
            "legendFormat": "{{ model_id }}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "min": 0,
            "max": 1,
            "unit": "percentunit"
          }
        }
      },
      {
        "title": "ML Model Drift Score",
        "type": "timeseries",
        "gridPos": { "x": 8, "y": 27, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "ml_model_drift_score",
            "legendFormat": "{{ model_id }}"
          }
        ]
      },
      {
        "title": "ML Inference Performance",
        "type": "timeseries",
        "gridPos": { "x": 16, "y": 27, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(ml_inference_duration_seconds_bucket[5m]))",
            "legendFormat": "p95 latency"
          },
          {
            "expr": "rate(ml_predictions_total[5m])",
            "legendFormat": "Predictions/sec"
          }
        ]
      },
      {
        "title": "Behavioral Analytics",
        "type": "row",
        "gridPos": { "x": 0, "y": 33, "w": 24, "h": 1 }
      },
      {
        "title": "User Behavior Anomalies",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 34, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(anomaly_detections_total{anomaly_type=\"behavioral\",entity_type=\"user\"}[5m])",
            "legendFormat": "User Anomalies"
          }
        ]
      },
      {
        "title": "Entity Behavior Anomalies",
        "type": "timeseries",
        "gridPos": { "x": 12, "y": 34, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(anomaly_detections_total{anomaly_type=\"behavioral\",entity_type=\"system\"}[5m])",
            "legendFormat": "System Anomalies"
          }
        ]
      },
      {
        "title": "Threat Intelligence",
        "type": "row",
        "gridPos": { "x": 0, "y": 40, "w": 24, "h": 1 }
      },
      {
        "title": "Threat Intel Feed Status",
        "type": "table",
        "gridPos": { "x": 0, "y": 41, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "threat_intel_feed_status",
            "format": "table",
            "instant": true
          }
        ]
      },
      {
        "title": "IOC Matches",
        "type": "timeseries",
        "gridPos": { "x": 12, "y": 41, "w": 12, "h": 6 },
        "targets": [
          {
            "expr": "rate(threat_intel_ioc_matches_total[5m])",
            "legendFormat": "{{ ioc_type }}"
          }
        ]
      },
      {
        "title": "Alert & Response",
        "type": "row",
        "gridPos": { "x": 0, "y": 47, "w": 24, "h": 1 }
      },
      {
        "title": "Alert Queue Depth",
        "type": "graph",
        "gridPos": { "x": 0, "y": 48, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "alert_queue_size",
            "legendFormat": "Queue Depth"
          }
        ]
      },
      {
        "title": "Alert Response Time",
        "type": "heatmap",
        "gridPos": { "x": 8, "y": 48, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "rate(alert_response_time_seconds_bucket[5m])"
          }
        ]
      },
      {
        "title": "Automated Response Success Rate",
        "type": "stat",
        "gridPos": { "x": 16, "y": 48, "w": 8, "h": 6 },
        "targets": [
          {
            "expr": "rate(automated_response_success_total[10m]) / rate(automated_response_total[10m])"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percentunit",
            "thresholds": {
              "steps": [
                { "value": 0, "color": "red" },
                { "value": 0.8, "color": "yellow" },
                { "value": 0.95, "color": "green" }
              ]
            }
          }
        }
      }
    ],
    "refresh": "30s",
    "schemaVersion": 36,
    "version": 1
  }
}
