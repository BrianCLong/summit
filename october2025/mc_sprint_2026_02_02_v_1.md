````md
# Maestro Conductor (MC) — Sprint Plan _(v1.0.0)_

**Slug:** `mc-sprint-2026-02-02-v1`  
**Dates (America/Denver):** 2026-02-02 → 2026-02-13  
**Owner/DRI:** Architect‑General  
**Teams:** Orchestrator Platform, SRE, Security, Data, UX  
**Tracks:** A) Now‑value; B) Enduring moats  
**Prereq:** `mc-0.8.0` shipped (Azure preview, policy rollout controller, SLA credits, provenance graph v1, estimator v2, KMS rotation)

---

## 0) Context & Carry‑Forward

**Done**: Azure runner preview stable at 2k conc; policy rails automation; signed SLA credits; provenance graph API; estimator v2 with fallback; envelope encryption and key rotations.  
**Carry‑forward**: Graph store cost tuning, Azure p99 tail spikes under burst, credit note export in disclosure pack format variants.

---

## 1) Objectives & Key Results

| #   | Objective                              | KR (measurable)                                                                                                 |
| --- | -------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| A1  | **Azure Runner GA**                    | Parity at 5k conc; p95 publish→start < **3.9s**; residency/egress enforced; failover drill passed               |
| A2  | **Policy Rails GA**                    | Sim→Warn→Enforce auto‑rollouts default‑on; MTTR for policy mis‑config < **20m**; false‑allow **0.0%** in canary |
| A3  | **Package Marketplace (private)**      | Tenant‑scoped catalog browse/install/update; 30 curated signed workflows available                              |
| B1  | **Provenance Query Language (PQL) v1** | Graph queries via PQL → p95 < **250ms** on 30M edges; saved queries with signatures                             |
| B2  | **Runner Zero‑Trust (SPIFFE/SPIRE)**   | mTLS SVIDs for API↔runner↔signer; authz via SPIFFE IDs in OPA; rotate certs w/o downtime                      |
| B3  | **Export Controls & Geo‑fencing**      | OPA pack & auditor for EAR/ITAR tags; zero violations; disclosure notes include export tags                     |
| B4  | **Scale & Efficiency**                 | 15k concurrent executions @ p95 publish→start < **3.9s**; idle cost ↓ **20%** vs last sprint                    |

---

## 2) Scope (In/Out)

**In**: Azure GA hardening, default policy rails, private marketplace APIs & CLI, PQL service & DSL, SPIFFE/SPIRE integration, export‑control policies + auditor, scale & cost tuning, SLO/alerts, docs and Jira scaffolds.  
**Out**: Public marketplace; UI authoring for packages; multi‑tenant cross‑cloud data movement.

---

## 3) Epics, Swimlanes & Stories

### 3.1 Multi‑Cloud Runner — Azure GA

- **MC‑AZ‑1401**: _Scale & perf to 5k conc_  
  **AC:** p95 < 3.9s; queue p95 < 850ms; CPU < 70%.
- **MC‑AZ‑1402**: _Failover & failback drill_  
  **AC:** AKS blackhole → AWS/GCP takeover < 3m; receipts intact; evidence archived.

### 3.2 Policy Rails GA (Default‑On)

- **MC‑POL‑1411**: _Default enable & guardrails_  
  **AC:** New packs auto‑enter Sim; controller promotes per policy; operator override with audit.
- **MC‑POL‑1412**: _Rollback macros_  
  **AC:** Single command reverts pack to Sim; MTTR < 20m proven.

### 3.3 Package Marketplace (Private)

- **MC‑PKG‑1421**: _Catalog browse/list/update_  
  **AC:** `GET /api/market/packages` (tenant‑scoped), `PATCH /api/market/packages/{id}` for updates; signatures verified.
- **MC‑PKG‑1422**: _Install/upgrade workflow packages_  
  **AC:** `POST /api/market/install` idempotent; rollback on signature mismatch; CLI wires.

### 3.4 Provenance Query Language (PQL) v1

- **MC‑PQL‑1431**: _DSL & parser_  
  **AC:** `FIND executions WHERE task='pkg:demo/echo@1.0.0' AND deny=false SINCE 30d`; safe subset documented.
- **MC‑PQL‑1432**: _Saved queries + signatures_  
  **AC:** Saved PQL signed & verified before execution; tenant‑scoped.

### 3.5 Zero‑Trust Runners (SPIFFE/SPIRE)

- **MC‑ZTA‑1441**: _SPIRE server & agents_  
  **AC:** SVIDs issued to API pods, runners, signer; rotation < 30m; trust domain documented.
- **MC‑ZTA‑1442**: _OPA integration with SPIFFE IDs_  
  **AC:** Access policies check `spiffe://` identities in input.

### 3.6 Export Controls & Geo‑fencing

- **MC‑EXP‑1451**: _OPA pack for export tags_  
  **AC:** Deny when `export_tag in {EAR99, ITAR}` and request region not allowed.
- **MC‑EXP‑1452**: _Export auditor job_  
  **AC:** Scans receipts; violations=0; disclosure pack adds export tag manifest.

### 3.7 Scale & Efficiency (15k conc)

- **MC‑PERF‑1461**: _Queue tuning & batching v2_  
  **AC:** 15k conc @ p95 < 3.9s; queue p95 < 900ms.
- **MC‑PERF‑1462**: _Cost reduction_  
  **AC:** Idle pool policy + image cache pruning → idle cost ↓ 20%.

### 3.8 SRE & Ops

- **MC‑SRE‑1471**: _GameDay (AZ failover + policy rollback)_  
  **AC:** Evidence captured; alerts green; runbook updated.

---

## 4) Milestones (America/Denver)

- **Kickoff**: Mon 2026‑02‑02 10:00
- **Design/ADR Review**: Tue 02‑03 15:00
- **Mid‑sprint Evidence Review**: Fri 02‑06 16:00
- **GameDay (AZ + Rails)**: Wed 02‑11 14:00
- **Sprint Review & Release**: Fri 02‑13 15:00
- **Retro**: Fri 02‑13 16:00

---

## 5) Artifacts & Scaffolds

### 5.1 OpenAPI (Marketplace, PQL)

```yaml
paths:
  /api/market/packages:
    get: { summary: List tenant-scoped packages }
  /api/market/packages/{id}:
    patch: { summary: Update package metadata (notes, deprecate) }
  /api/market/install:
    post: { summary: Install/upgrade a signed package into tenant catalog }
  /api/pql:
    post: { summary: Execute a PQL query (tenant-scoped) }
  /api/pql/saved:
    post: { summary: Save signed PQL query }
    get: { summary: List saved queries }
```
````

### 5.2 PQL Grammar (EBNF excerpt)

```ebnf
query      = "FIND" subject ("WHERE" predicate)? ("SINCE" duration)? ;
subject    = "executions" | "workflows" | "packages" ;
predicate  = condition { ("AND" | "OR") condition } ;
condition  = ident op value ;
op         = '=' | '!=' | 'CONTAINS' ;
duration   = integer 'd' ;
```

### 5.3 OPA Rego — Export Controls

`policy/rego/export.rego`

```rego
package mc.export

default allow = false

allow {
  not input.manifest.export_tag
  input.request.region == input.workflow.region
}

allow {
  tag := input.manifest.export_tag
  allowed_regions[tag][input.request.region]
}

allowed_regions = {
  "EAR99": {"US": true, "EU": true},
  "ITAR": {"US": true}
}
```

### 5.4 SPIFFE/SPIRE — Helm values (excerpt)

```yaml
spire:
  server:
    enabled: true
    trustDomain: 'mc.local'
  agent:
    enabled: true
workloads:
  api:
    spiffeID: 'spiffe://mc.local/ns/prod/sa/mc-api'
  runner:
    spiffeID: 'spiffe://mc.local/ns/prod/sa/mc-runner'
  signer:
    spiffeID: 'spiffe://mc.local/ns/prod/sa/mc-signer'
```

### 5.5 Auditor Job — Export Tags

`apps/mc-jobs/export-auditor.yaml`

```yaml
apiVersion: batch/v1
kind: CronJob
metadata: { name: export-auditor }
spec:
  schedule: '@hourly'
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: auditor
              image: ghcr.io/${ORG}/mc-export-auditor:latest
          restartPolicy: OnFailure
```

### 5.6 Marketplace CLI

```bash
maestro market ls
maestro market install myflow@1.2.3
maestro market update myflow --deprecate --note "Use v1.3.0"
```

### 5.7 Provenance Query Examples (PQL)

```text
FIND executions WHERE package='pkg:etl/s3@2.4.0' AND deny=false SINCE 14d
FIND receipts WHERE decision='residency.allow=false' SINCE 90d
```

### 5.8 DB/Indexing (PQL)

```sql
create index if not exists idx_exec_task on exec_steps (task_pkg);
create index if not exists idx_decision_pack on policy_decisions (pack, allow);
```

---

## 6) Observability & SLOs (adds)

- Metrics: `mc_azure_p95_ms`, `mc_pql_query_ms`, `mc_market_installs_total`, `mc_spiffe_svid_rotations_total`, `mc_export_violations_total`.
- Dashboards: Azure GA, Policy rails status, Marketplace activity, PQL latency, SPIFFE health, Export auditor.
- Alerts: AZ p95 > 3.9s; PQL p95 > 250ms; SVID rotation errors; export violations > 0.

---

## 7) Security & Compliance

- SPIFFE identities required for runner API; OPA checks SPIFFE IDs; cert rotation logs.
- Marketplace enforces cosign signatures + in‑toto attestations; packages immutable once published.
- Export controls: deny‑by‑default on unknown tags; auditor blocks release on violation.

---

## 8) GameDay & Drills

- **AZ failover** to AWS/GCP under 5k conc.
- **Policy rollback** macro under induced deny spike.
- **PQL load**: 100 QPS read burst; p95 < 250ms.

---

## 9) Release & Rollback

- Tag: `mc-0.9.0`.
- Flags: `runner_azure_ga`, `policy_rails_default_on`, `market_private`, `pql_v1`, `spiffe_enabled`, `export_controls_enforce`.
- Rollback: disable flags; revert SPIRE agents; marketplace read‑only; PQL endpoint off.

---

## 10) Jira Import (CSV)

```csv
Summary,Issue Type,Parent,Labels,Description
Azure GA perf & drill,Story,EPIC-MC-AZ,mc;multicloud,Scale to 5k conc p95<3.9s + failover
Policy rails default-on,Story,EPIC-MC-POL,mc;policy,Auto Sim→Warn→Enforce with override
Marketplace APIs,Story,EPIC-MC-PKG,mc;packages,Browse/list/update tenant catalog
Marketplace install/upgrade,Story,EPIC-MC-PKG,mc;packages,Install/upgrade signed packages
PQL DSL & parser,Story,EPIC-MC-PQL,mc;provenance,Query language + parser
Saved PQL with signatures,Story,EPIC-MC-PQL,mc;provenance,Signed saved queries
SPIFFE/SPIRE integration,Story,EPIC-MC-ZTA,mc;security,SVIDs for api/runner/signer
OPA authz w/ SPIFFE IDs,Story,EPIC-MC-ZTA,mc;security,Rego checks on spiffe:// identities
Export controls OPA pack,Story,EPIC-MC-EXP,mc;compliance,EAR/ITAR tags & deny
Export auditor CronJob,Story,EPIC-MC-EXP,mc;compliance,Scan receipts for violations
Scale to 15k conc,Story,EPIC-MC-PERF,mc;perf,Queue tuning & cost reduction
```

---

## 11) DoR / DoD (adds)

**Adds**: SPIFFE threat notes; marketplace supply‑chain attestations; PQL safety analysis; export‑controls legal review; AZ GA drill evidence.

---

## 12) Risks & Mitigations

| Risk                          | Likelihood | Impact | Mitigation                                                    |
| ----------------------------- | ---------- | ------ | ------------------------------------------------------------- |
| SPIFFE rollout complexity     | M          | H      | Phased enable per namespace; fallback mTLS; detailed runbooks |
| PQL misuse / heavy queries    | M          | M      | Safe subset + limits; signed saved queries; rate limits       |
| Marketplace supply‑chain risk | L          | H      | Mandatory signatures + in‑toto; verify on install & run       |
| Export tag mislabeling        | M          | M      | Dual controls: pack + auditor; block on any discrepancy       |

---

## 13) Evidence Links (populate during sprint)

- ADRs: `/docs/adr/ADR-07xx-*`
- AZ GA: `/docs/evidence/az-ga-2026-02-10/*`
- PQL perf: `/docs/evidence/pql-2026-02-12/*`
- Release: `releases/mc-0.9.0`

---

> Standardize the railhead: Azure to GA, safe‑by‑default policy rollouts, private marketplace, queryable provenance, and zero‑trust runners.

```

```
