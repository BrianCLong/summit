---
slug: mc-sprint-2026-03-16-v1
version: 1.0.0
date: 2026-03-16
status: Proposed
owner: Platform Eng • DevSecOps (MC)
confidentiality: Internal
---

# MC Sprint Plan — v28.5 Data Classification, DLP & Privacy Gates

> Theme: **Make data-safe by default.** Classify data flows, gate builds/deploys on privacy rules, and add redaction/telemetry controls. Prove that PII cannot move without policy‑backed consent, observability, and rollback.

**Scope anchor:** `/orchestrations/mc`  
**Prereqs:** v28.4 risk engine + adaptive gates live  
**Timebox:** 2 weeks (Mar 16–Mar 27, 2026, America/Denver)

---

## 0) Retro Snapshot (from 2026‑03‑02)

- ✅ Risk score computed and surfaced; adaptive gates bounded and logged.
- ⚠️ Drills running in sandbox; reviewer assist reducing time‑to‑green for high‑risk PRs.
- ❌ No standardized data classification; DLP checks exist but not tied to promotion/runtime.

---

## 1) Sprint Goals (Outcomes)

1. **Data map v1**: per‑service **data inventory** (PII/PHI/payment/none) with owners and retention.
2. **Privacy gates**: block builds/deploys that leak PII across boundaries without approved contract (OPA policy + waivers TTL ≤ 7d).
3. **Runtime redaction**: structured log redaction filters enabled for all services marked `contains_pii=true`.
4. **Egress guard**: deny egress of PII‑bearing telemetry to non‑approved endpoints; evidence dashboards.
5. **Incident drill**: synthetic PII leak → auto‑containment + redaction verification with ≤ 30m recovery.

---

## 2) Swimlanes

### A) Data Inventory & Contracts (Owner: DX + Data)

- YAML inventory per service; owners; data categories; retention; legal basis.

### B) Privacy Policies & Gates (Owner: DevSecOps)

- OPA rules using inventory as **policy‑as‑data**; conftest in CI; Argo admission deny on violations.

### C) Runtime Redaction & Telemetry (Owner: SRE + Platform)

- Log/processors that mask PII; sampling and drop policies; audit trails of redactions.

### D) Egress Controls (Owner: SRE)

- Netpol/proxy policies that prevent PII egress to unapproved domains; exception flow with TTL.

### E) Drills & Runbooks (Owner: SecOps)

- PII‑leak tabletop and automated drill; evidence pack; training snippets.

---

## 3) User Stories & Acceptance Criteria

> ID: `MC13-<lane>-<n>`

### Data Inventory & Contracts

1. **MC13-DATA-1** — _Inventory file per service_
   - **AC:** `data/inventory.yaml` exists for 90%+ services; owners present; categories from enum; retention set.

### Privacy Policies & Gates

2. **MC13-PRIV-1** — _Build‑time privacy gate_
   - **AC:** CI fails if service declares PII and sends logs/metrics to endpoints not in `approved_destinations`.
3. **MC13-PRIV-2** — _Admission deny on contract mismatch_
   - **AC:** Deploy blocked when `mc.data_category=PII` but namespace lacks `privacy.contract=approved` label.

### Runtime Redaction

4. **MC13-RED-1** — _Redaction on by default_
   - **AC:** Services with `contains_pii=true` have redaction filters applied; sample logs show masked fields.

### Egress Controls

5. **MC13-EGR-1** — _PII egress deny_
   - **AC:** Alerts fire on attempted egress; deny enforced; exception by waiver ≤ 7 days.

### Drills

6. **MC13-DRILL-1** — _PII leak drill_
   - **AC:** Synthetic PII in logs triggers redaction + alert; auto‑containment + 30m recovery; evidence pack stored.

---

## 4) Deliverables & Artifacts

- `data/inventory.schema.json` and per‑service `data/inventory.yaml`.
- `policy/opa/privacy.rego` + tests; `policy/data/privacy.yaml` (approved endpoints/contracts).
- `.github/workflows/privacy-check.yml`; `.github/workflows/pii-drill.yml`.
- Log processor config: `observability/redaction/*.yaml`.
- NetworkPolicy/proxy: `k8s/policy/egress-privacy.yaml`.
- Dashboards: `dashboards/mc-privacy.json`.
- Runbooks: `docs/mc/runbooks/privacy-incident.md`.

---

## 5) Scaffolds & Snippets

### A) Inventory Schema & Example

```json
// file: data/inventory.schema.json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "owner": { "type": "string" },
    "category": { "enum": ["NONE", "PII", "PHI", "PAYMENT"] },
    "retention_days": { "type": "integer", "minimum": 0 },
    "approved_destinations": { "type": "array", "items": { "type": "string" } }
  },
  "required": ["owner", "category", "retention_days", "approved_destinations"]
}
```

```yaml
# file: services/api/data/inventory.yaml
owner: team-api
category: PII
retention_days: 365
approved_destinations: ['logs.internal:4317', 'otel-collector.prod:4317']
```

### B) OPA Privacy Policy

```rego
# file: policy/opa/privacy.rego
package privacy

default allow := false

pii_service { input.inventory.category == "PII" }
unknown_destinations[dst] { some dst in input.outputs.destinations; not approved(dst) }
approved(dst) { some a in input.inventory.approved_destinations; a == dst }

violation[msg] {
  pii_service
  some d in unknown_destinations
  msg := sprintf("PII egress to unapproved destination: %s", [d])
}

allow { count(violation) == 0 }
```

### C) CI Privacy Check Workflow

```yaml
# file: .github/workflows/privacy-check.yml
name: Privacy Check
on: [pull_request]
jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate inventory schema
        run: npx ajv validate -s data/inventory.schema.json -d services/**/data/inventory.yaml
      - name: Conftest (privacy)
        uses: open-policy-agent/conftest-action@v1
        with:
          files: build/outputs.json # produced by build
          policy: policy/opa
```

### D) Admission Gate (Kyverno label check)

```yaml
# file: k8s/policy/privacy-admission.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata: { name: privacy-contract-required }
spec:
  validationFailureAction: Enforce
  rules:
    - name: require-contract
      match: { resources: { kinds: [Deployment, StatefulSet] } }
      validate:
        message: 'PII services require privacy.contract=approved'
        pattern:
          metadata:
            labels:
              (mc.data_category): 'PII'
              (privacy.contract): 'approved'
```

### E) Runtime Redaction (Otel Processor)

```yaml
# file: observability/redaction/otel-processor.yaml
processors:
  attributes/pii-redact:
    actions:
      - key: user.email
        action: update
        value: '***REDACTED***'
      - key: user.ssn
        action: update
        value: '***REDACTED***'
service:
  pipelines:
    logs/pii:
      processors: [attributes/pii-redact]
```

### F) Egress Privacy Netpol

```yaml
# file: k8s/policy/egress-privacy.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata: { name: egress-privacy }
spec:
  podSelector: { matchLabels: { mc.data_category: 'PII' } }
  policyTypes: [Egress]
  egress:
    - to:
        - namespaceSelector: { matchLabels: { app: otel-collector } }
      ports: [{ protocol: TCP, port: 4317 }]
```

### G) PII Drill

```yaml
# file: .github/workflows/pii-drill.yml
name: Drill — PII Redaction
on: workflow_dispatch
jobs:
  simulate:
    runs-on: ubuntu-latest
    steps:
      - run: echo '{"user":{"email":"alice@example.com","ssn":"123-45-6789"}}' > sample.log
      - name: Send to pipeline
        run: echo "(simulate sending logs)"
      - name: Assert redaction
        run: grep -q "REDACTED" sample.log || exit 1
```

---

## 6) Observability & Dashboards

```json
// file: dashboards/mc-privacy.json
{
  "title": "MC Privacy & DLP",
  "panels": [
    {
      "type": "stat",
      "title": "Services with inventory",
      "targets": [{ "expr": "100 * mc_services_inventory / mc_services_total" }]
    },
    {
      "type": "graph",
      "title": "Privacy Gate Violations",
      "targets": [{ "expr": "rate(mc_privacy_violations_total[1d])" }]
    },
    {
      "type": "table",
      "title": "Unapproved Destinations",
      "targets": [{ "expr": "mc_privacy_unapproved_destinations" }]
    },
    {
      "type": "stat",
      "title": "Redaction Coverage %",
      "targets": [
        { "expr": "100 * mc_redaction_enabled_services / mc_services_pii" }
      ]
    }
  ]
}
```

---

## 7) Risks & Mitigations

1. **Inventory rot** — nightly schema validation; owners paged on stale (>90d) inventories.
2. **Over‑redaction** — sample‑based QA; allow specific keys via allowlist; advisory mode first week.
3. **False privacy blocks** — tight waivers (≤ 7d) with owner + reason; retro review.
4. **Performance hit** — redaction processors benchmarked; enable only for PII‑tagged services.

---

## 8) DOD, Gates & Rollback

**DOD**

- [ ] ≥90% services have inventory; schema validated.
- [ ] Privacy gates blocking on violations; waivers TTL ≤ 7d.
- [ ] Redaction enabled for all `contains_pii=true` services; tests show masked fields.
- [ ] Egress privacy policy active; alerts and exceptions tracked.
- [ ] PII drill passes; recovery ≤ 30m with evidence pack.

**Rollback**

- Set `PRIVACY_GATES=advisory`; disable redaction processor; relax netpol to observability mode.

---

## 9) Timeline & Capacity (2 weeks)

- **D1–D3:** Inventory schema + generator; seed inventories.
- **D4–D6:** Privacy OPA + CI workflows; Kyverno label check.
- **D7–D8:** Redaction + egress policies; dashboards.
- **D9–D10:** Drill, docs, demo & retro.

**Estimate:** 24–28 pts across Platform, Sec, CI, SRE, DX.

---

## 10) Ticket Seed (importable)

```yaml
# file: .project/tickets/mc-sprint-2026-03-16.yaml
sprint: mc-2026-03-16
board:
  columns: [Backlog, Ready, In Progress, Review, Blocked, Done]
issues:
  - id: MC13-DATA-1
    title: Create per-service data inventory
    labels: [mc, privacy]
    assignees: [owner-dx, owner-data]
    points: 5
  - id: MC13-PRIV-1
    title: Build-time privacy gate in CI
    labels: [mc, privacy, policy]
    assignees: [owner-sec]
    points: 5
  - id: MC13-PRIV-2
    title: Admission gate for privacy contract
    labels: [mc, privacy, runtime]
    assignees: [owner-sre]
    points: 4
  - id: MC13-RED-1
    title: Enable runtime redaction for PII services
    labels: [mc, privacy, observability]
    assignees: [owner-sre]
    points: 4
  - id: MC13-EGR-1
    title: Egress privacy NetworkPolicy
    labels: [mc, privacy, network]
    assignees: [owner-sre]
    points: 3
  - id: MC13-DRILL-1
    title: PII leak drill with evidence pack
    labels: [mc, privacy, drills]
    assignees: [owner-sec]
    points: 3
```

---

## 11) Evidence & Reporting

- KPIs: inventory coverage %, privacy violations/day, redaction coverage %, egress denials, drill MTTR.
- Artifacts: inventories, OPA results, admission events, redaction configs, evidence packs.
- Store under `docs/mc/evidence/2026-03-16/`.

---

## 12) Changelog

- **Added:** Data inventories, privacy gates, runtime redaction, egress privacy, PII drill.
- **Changed:** CI/CD now respect data contracts.
- **Fixed:** Ungoverned PII flows in builds and runtime.
