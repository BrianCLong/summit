---
title: Docs Phase 5–6: Productionization & Automation Plan
summary: Make docs previewable per-PR, automate coverage from code, harden UX/a11y/i18n, and institutionalize docs SLAs.
lastUpdated: 2025-09-07
owner: docs
version: latest
---

# Executive summary
You’ve shipped a best-in-class docs foundation. Phase 5–6 focuses on **productionizing** the workflow (previews, coverage from code), **polishing UX** (role-based landings, print/PDF), **governance** (SLAs, freeze gates), and **measuring outcomes** (analytics, search).

---

# Track A — Preview Environments for every PR
Give reviewers and PMs a live link for docs changes.

## A1) PR Previews on GitHub Pages (per-PR path)
**`.github/workflows/docs-preview.yml`**
```yaml
name: Docs Preview
on:
  pull_request:
    paths: ['docs/**','docs-site/**']
permissions:
  contents: write
  pages: write
  id-token: write
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - run: |
          cd docs-site
          npm i
          npm run build
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: docs-site/build
  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
    steps:
      - name: Deploy to Pages
        id: deploy
        uses: actions/deploy-pages@v4
      - name: Comment PR with preview URL
        uses: actions/github-script@v7
        with:
          script: |
            const url = process.env['DEPLOYMENT_URL'] || (core.getInput('deployment_url') ?? '')
            const pr = context.payload.pull_request.number
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: pr,
              body: `✅ Docs preview ready: ${url}`
            })
```

> If your Pages is already used for production, switch to a separate branch (e.g., `gh-pages-previews`) or a `destination_dir: previews/pr-<num>` approach with `peaceiris/actions-gh-pages`.

**Acceptance**: Every docs PR auto-comments with a preview URL.

---

# Track B — Coverage from Code (env vars, CLI, OpenAPI diffs)
Close the gap between implementation and reference docs.

## B1) Extract Environment Variables → Reference page
**`scripts/docs/extract-env-vars.js`**
```js
const fs = require('fs');
const path = require('path');

const roots = ['apps','services','src','packages']; // adjust to your repo
const patterns = [
  /process\.env\.([A-Z0-9_]+)/g,         // Node
  /os\.getenv\(['\"]([A-Z0-9_]+)['\"]\)/g, // Python
  /\$\{([A-Z0-9_]+)(:[^}]*)?\}/g           // Bash/Compose
];
const vars = new Set();

function scan(file){
  const txt = fs.readFileSync(file, 'utf8');
  for (const rx of patterns){
    for (const m of txt.matchAll(rx)) vars.add(m[1]);
  }
}

function walk(dir){
  if (!fs.existsSync(dir)) return;
  for (const f of fs.readdirSync(dir)){
    const p = path.join(dir,f);
    const s = fs.statSync(p);
    if (s.isDirectory()) walk(p);
    else if (s.isFile() && s.size < 2_000_000) scan(p);
  }
}
for (const r of roots) walk(r);

const list = Array.from(vars).sort();
const out = `---\ntitle: Environment Variables\nsummary: Central reference of all environment variables discovered in code.\nversion: latest\nowner: platform\n---\n\n> Generated by \`scripts/docs/extract-env-vars.js\`. Fill in descriptions and defaults.\n\n| Name | Description | Default | Required |\n|---|---|---|:---:|\n${list.map(v=>`| ${v} |  |  |  |`).join('\n')}\n\n`;
fs.mkdirSync('docs/reference', { recursive: true });
fs.writeFileSync('docs/reference/env-vars.md', out);
console.log(`Extracted ${list.length} env vars`);
```

**Wire into CI** (docs-quality):
```yaml
      - name: Extract env vars reference
        run: node scripts/docs/extract-env-vars.js
```

## B2) Find Orphaned Docs (not reachable from sidebars)
**`scripts/docs/find-orphans.js`**
```js
const fs = require('fs');
const path = require('path');
const sidebar = fs.readFileSync('docs-site/sidebars.js','utf8');
const mentioned = new Set([...sidebar.matchAll(/["']([\w\-/]+)\b["']/g)].map(m=>m[1]));
const root = 'docs';
const files = [];
(function walk(d){ for(const f of fs.readdirSync(d)){ const p=path.join(d,f); const s=fs.statSync(p); s.isDirectory()?walk(p):/\.mdx?$/.test(f)&&files.push(p);} })(root);
const orphans = files.filter(f=>{
  const slug = f.replace(/^docs\//,'').replace(/\.mdx?$/,'');
  return !Array.from(mentioned).some(m => slug.endsWith(m));
});
if (orphans.length) {
  console.warn('Orphaned docs (not in sidebars):');
  for (const o of orphans) console.warn(' -', o);
}
fs.writeFileSync('docs-orphans.json', JSON.stringify(orphans, null, 2));
```

**CI**:
```yaml
      - name: Detect orphaned docs
        run: node scripts/docs/find-orphans.js
      - uses: actions/upload-artifact@v4
        with: { name: docs-orphans, path: docs-orphans.json }
```

## B3) OpenAPI Diff gate (warn on breaking changes)
**`scripts/api/openapi-diff.sh`** (stub)
```bash
#!/usr/bin/env bash
set -euo pipefail
# Requires: npm i -g openapi-diff@3 or docker image
# Usage: scripts/api/openapi-diff.sh api/intelgraph-core-api.yaml HEAD~1 HEAD
OLD=${1:-api/intelgraph-core-api.yaml}
openapi-diff $OLD $OLD > /dev/null || echo "Run diff between versions in CI here"
```

> Integrate with release workflow to attach HTML diff artifacts.

---

# Track C — UX Polish & Role-based Navigation

## C1) Role landing pages
Create entry pages for **User**, **Admin**, **Operator** with top tasks and links.
- `docs/get-started/for-users.md`
- `docs/get-started/for-admins.md`
- `docs/get-started/for-operators.md`

Each page:
- Top 5 tasks
- Troubleshooting links
- Contact/support paths

## C2) Print/PDF-friendly styling & export
Add a print stylesheet and a workflow to export selected guides as PDFs.

**`docs-site/src/css/print.css`**
```css
@media print {
  nav, aside, footer { display: none !important; }
  article { width: 100% !important; box-shadow: none !important; }
}
```

**`.github/workflows/docs-pdf.yml`**
```yaml
name: Docs PDF Export
on: [workflow_dispatch]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: 20 }
      - run: |
          cd docs-site && npm i && npm run build
      - name: Export PDFs (Puppeteer)
        run: |
          npm i -g puppeteer-cli
          npx puppeteer print http://localhost:3000/how-to/upgrade-to-v24 --output upgrade-to-v24.pdf || true
      - uses: actions/upload-artifact@v4
        with: { name: docs-pdfs, path: "*.pdf" }
```

---

# Track D — i18n Readiness

- Enable Docusaurus i18n scaffolding (`i18n/<locale>/docusaurus-plugin-content-docs/current`).
- Establish translation glossary and Do-not-translate list.

**`docs/i18n/glossary.md`** (seed)
```md
- IntelGraph → (Do not translate)
- GraphRAG → (Do not translate)
- ZIP Export → (Prefer local term if exists)
```

**Acceptance**: Site builds with a second locale stub; glossary exists.

---

# Track E — Security & Compliance in Docs

## E1) Secret scanner for docs
Block potential secrets accidentally added to docs/examples.

**`.github/workflows/docs-secrets.yml`**
```yaml
name: Docs Secrets Scan
on: [pull_request]
jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: gitleaks/gitleaks-action@v2
        with:
          args: detect -v --source=. --no-git --report-format sarif --report-path gitleaks.sarif --path docs
```

## E2) License & attribution checker
Maintain third-party attributions for copied code or images.

**`docs/ATTRIBUTIONS.md`** (create)

---

# Track F — Contributor Experience

## F1) Docs PR template
**`.github/PULL_REQUEST_TEMPLATE/docs.md`**
```md
### Summary

### Docs checklist
- [ ] Front-matter complete (title, summary, owner, version, lastUpdated)
- [ ] Added See also & Next steps
- [ ] Added alt text to all images
- [ ] Linked from sidebars
- [ ] If feature, updated `docs/_meta/features.yml`

### Screenshots/Preview link
```

## F2) Issue template for docs requests
**`.github/ISSUE_TEMPLATE/docs_request.yml`**
```yaml
name: Docs request
description: Ask for a new doc or update
labels: [docs]
body:
  - type: input
    id: area
    attributes: { label: Area/Feature, placeholder: "ZIP Export" }
  - type: textarea
    id: need
    attributes: { label: Need/Gap, placeholder: "Users don’t know how to…" }
  - type: checkboxes
    id: artifacts
    attributes:
      label: Which artifacts?
      options:
        - label: How-to
        - label: Tutorial
        - label: Reference
        - label: Concept
  - type: input
    id: owner
    attributes: { label: Owner team }
```

---

# Track G — Analytics & Search Tuning

- Enable Algolia analytics; export **zero-result queries** weekly to `docs/search-queries.md`.
- Monitor top exit pages and add **“What’s next?”** callouts.

**`scripts/docs/zero-results-stub.js`**
```js
console.log('Integrate Algolia Analytics API here and write results to docs/search-queries.md');
```

---

# Track H — SLAs, SLOs & On-call for Docs

Define service levels for docs freshness and responsiveness.

**`docs/ops/docs-slas.md`**
```md
---
title: Docs SLAs & SLOs
summary: Targets for freshness, response times, and quality gates.
owner: docs
---

## SLAs
- PR review for docs: < 2 business days
- Docs update on release: by code-freeze + 24h

## SLOs
- Broken links < 0.5%
- Stale pages (< lastUpdated 120d) < 5%
- A11y violations = 0 on key pages

## Process
- Weekly stale sweep triage
- Release docs freeze checklist
```

---

# Acceptance criteria (Phase 5–6)
- ✅ Per-PR preview URLs posted automatically.
- ✅ `env-vars.md` generated from code and owned by Platform.
- ✅ Orphaned docs report produced on each PR.
- ✅ Role-based landing pages live and linked from Get Started.
- ✅ Print stylesheet + manual PDF export workflow operating.
- ✅ i18n scaffolding present with glossary.
- ✅ Secret scan & attribution doc in place.
- ✅ Docs PR/Issue templates live.
- ✅ SLAs/SLOs documented and adopted by the team.

