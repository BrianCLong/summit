---
slug: mc-sprint-2026-03-02-v1
version: 1.0.0
date: 2026-03-02
status: Proposed
owner: Platform Eng • DevSecOps (MC)
confidentiality: Internal
---

# MC Sprint Plan — v28.4 Risk Scoring, Adaptive Gates & Safe Experiments

> Theme: **Quantify risk, adapt gates dynamically (with strict guardrails), and validate with controlled experiments.** Convert lineage + policies into a continuous **risk score** that tunes enforcement profiles within bounded ranges; run safe chaos drills for CI/CD + admission paths.

**Scope anchor:** `/orchestrations/mc`  
**Prereqs:** v28.3 progressive delivery + continuous verification live  
**Timebox:** 2 weeks (Mar 2–Mar 13, 2026, America/Denver)

---

## 0) Retro Snapshot (from 2026‑02‑16)

- ✅ Canary/blue‑green wired to MC verify; auto‑rollback works.  
- ✅ CVE watch revokes promotable within SLA; drift lock functional.  
- ⚠️ Session‑bound approvals rollout mid‑stream (80%).  
- ❌ Gates static per‑env; no quantified risk score; experiments/manual only.

---

## 1) Sprint Goals (Outcomes)

1. **Risk Score v1** (0–100): computed per PR/run/release from SBOM, provenance, secrets, test health, drift, CVEs, ownership.  
2. **Adaptive gates (bounded)**: profiles auto‑tighten/relax **within pre‑approved ranges** based on risk (e.g., require 2 reviewers + slow canary for high risk).  
3. **Safe experiment framework**: deterministic drills that exercise gates (secrets leak, unsigned artifact, CVE injection, drift) in sandboxes without real impact.  
4. **Reviewer assist**: PR comment bundle adds risk score + top drivers + suggested fixes with links.  
5. **Governance**: All adaptations logged with reason, inputs, and approver; rollback path in one command.

---

## 2) Swimlanes

### A) Risk Engine (Owner: DevSecOps + Data/Graph)
- Ingest signals → weighted score; store on run, PR, image nodes in Neo4j; expose API.

### B) Adaptive Profiles (Owner: Platform + Release)
- Map risk buckets to **bounded** gate changes (reviewers, canary steps, SLO thresholds) via policy‑as‑data.

### C) Experiment Framework (Owner: SRE)
- Reproducible drills (synthetic secrets, unsigned blobs, CVE toggles, drift simulator); evidence capture.

### D) Reviewer Assist (Owner: DX)
- PR bot formatting: top drivers, fix‑it suggestions, quick links to docs and MC commands.

### E) Governance & Audit (Owner: SecOps)
- Log all adaptations; approvals for crossing thresholds; dashboard & weekly report.

---

## 3) User Stories & Acceptance Criteria

> ID: `MC12-<lane>-<n>`

### Risk Engine
1. **MC12-RISK-1** — *Compute score*
   - **AC:** `risk = f(SBOM vulns, secrets=0/1, provenance, tests pass %, drift, CVEs, ownership, change size)` stored per run; API returns value ≤ 200ms.
2. **MC12-RISK-2** — *Top drivers*
   - **AC:** PR bundle lists top 5 contributors with weights and remediation tips.

### Adaptive Profiles
3. **MC12-ADPT-1** — *Bounded mapping*
   - **AC:** `low/med/high` risk → predefined changes only (e.g., canary 10%→25% for low; 5% multi‑step for high); no free‑form modifications.
4. **MC12-ADPT-2** — *Change safety*
   - **AC:** Every adaptation logged (who/why/when/inputs); `mc adapt --rollback` reverses within 5 min.

### Experiment Framework
5. **MC12-EXP-1** — *Secrets drill*
   - **AC:** Synthetic secret in PR triggers block + advisory; drill label auto‑clears; no artifacts published.
6. **MC12-EXP-2** — *Unsigned artifact drill*
   - **AC:** Unsigned blob path fails verify; rollback clean; evidence pack archived.

### Reviewer Assist
7. **MC12-REV-1** — *PR risk comment*
   - **AC:** PR shows score badge + guidance; time‑to‑green improves ≥ 15% on high‑risk PRs after 2 fixes.

### Governance & Audit
8. **MC12-GOV-1** — *Weekly risk report*
   - **AC:** Dashboard + CSV of scores, adaptations, exceptions; executive summary.

---

## 4) Deliverables & Artifacts

- `risk/config/weights.yaml`, `risk/engine.ts` (score calc), `graph/schema/risk.cql`.  
- `policy/data/adaptive.yaml` (bounded mapping) + generator.  
- `.github/workflows/drills/{secret,unsig,cve,drift}.yml` (sandbox only).  
- `scripts/risk-comment.js` (PR bot).  
- Dashboards: `dashboards/mc-risk.json`, `dashboards/mc-adaptations.json`.  
- Runbooks: risk tuning, experiment SOP, rollback.

---

## 5) Scaffolds & Snippets

### A) Risk Weights (policy‑as‑data)
```yaml
# file: risk/config/weights.yaml
weights:
  vuln_critical: 20
  vuln_high: 10
  secrets_found: 40
  provenance_missing: 25
  tests_unhealthy: 15
  drift_recent: 20
  cve_new: 15
  change_size_large: 10
  ownership_unknown: 10
```

### B) Risk Engine (TS)
```ts
// file: risk/engine.ts
export type Signals = { crit: number; high: number; secrets: boolean; prov: boolean; tests: number; drift: boolean; cve: boolean; lines: number; owner: boolean };
export function score(s: Signals){
  let r = 0;
  r += s.crit * 20 + s.high * 10;
  r += s.secrets ? 40 : 0;
  r += !s.prov ? 25 : 0;
  r += (s.tests < 0.9 ? 15 : 0);
  r += s.drift ? 20 : 0;
  r += s.cve ? 15 : 0;
  r += (s.lines > 1000 ? 10 : 0);
  r += (!s.owner ? 10 : 0);
  return Math.min(100, r);
}
```

### C) Adaptive Mapping (bounded)
```yaml
# file: policy/data/adaptive.yaml
risk_buckets:
  low:   { reviewers: 1,  canary_step: 25, slo_burn_rate: 2.5 }
  med:   { reviewers: 2,  canary_step: 10, slo_burn_rate: 2.0 }
  high:  { reviewers: 2,  canary_step: 5,  slo_burn_rate: 1.5, require_rollout_steps: true }
thresholds: { low: 0-29, med: 30-69, high: 70-100 }
```

```ts
// file: scripts/adaptive-build.ts
import yaml from 'js-yaml'; import fs from 'node:fs';
const m = yaml.load(fs.readFileSync('policy/data/adaptive.yaml','utf8')) as any;
const risk = Number(process.env.MC_RISK || 0);
const b = risk < 30 ? 'low' : risk < 70 ? 'med' : 'high';
fs.writeFileSync('.mc/adapt.json', JSON.stringify({ bucket:b, params:m.risk_buckets[b] }));
```

### D) PR Risk Comment
```js
// file: scripts/risk-comment.js
const { score } = require('./risk/engine');
const s = JSON.parse(process.env.MC_SIGNALS);
const r = score(s);
console.log(`MC Risk: **${r}/100** — Top drivers: secrets=${s.secrets}, crit=${s.crit}, prov_missing=${!s.prov}`);
```

### E) Drills (Unsigned artifact example)
```yaml
# file: .github/workflows/drills/unsig.yml
name: Drill — Unsigned Artifact
on: workflow_dispatch
jobs:
  simulate:
    runs-on: ubuntu-latest
    steps:
      - run: echo "produce unsigned artifact" > dist/app.bin
      - name: Expect verify to fail
        run: |
          set +e; cosign verify-blob dist/app.bin || exit 0; exit 1
```

---

## 6) Observability & Dashboards

```json
// file: dashboards/mc-risk.json
{ "title": "MC Risk Score", "panels": [
  {"type":"histogram","title":"Risk Distribution","targets":[{"expr":"histogram_quantile(0.5, sum(rate(mc_risk_bucket_seconds_bucket[1d])) by (le))"}]},
  {"type":"stat","title":"High-Risk PRs","targets":[{"expr":"sum(mc_pr_risk{bucket=\"high\"})"}]}
]}
```

```json
// file: dashboards/mc-adaptations.json
{ "title": "MC Adaptive Gates", "panels": [
  {"type":"table","title":"Adaptations","targets":[{"expr":"mc_adaptations"}]},
  {"type":"graph","title":"Time to Green (high risk)","targets":[{"expr":"histogram_quantile(0.5, sum(rate(mc_time_to_green_seconds_bucket{bucket=\"high\"}[1w])) by (le))"}]}
]}
```

---

## 7) Risks & Mitigations

1. **Score gaming** — publish weights; include manual review; periodically shuffle within small bounds; monitor deltas.  
2. **Over‑relaxation** — hard caps: never disable provenance/signature/secrets gates; only adjust reviewers/canary/SLO within bounds.  
3. **Drill spillover** — sandbox repos/namespaces only; artifacts quarantined; drill labels mandatory.  
4. **Reviewer fatigue** — concise comments with top drivers + one‑click fixes/doc links.

---

## 8) DOD, Gates & Rollback

**DOD**
- [ ] Risk score computed & surfaced on PRs and runs; API ≤ 200ms.  
- [ ] Adaptive profiles applied within bounds; logs + rollback tested.  
- [ ] Secret/unsigned/CVE/drift drills pass and capture evidence.  
- [ ] Time‑to‑green improvement measured on remediated high‑risk PRs.  
- [ ] Weekly risk/adaptation report delivered.

**Rollback**
- Set `MC_ADAPTIVE=false`; revert to static profiles; disable drills workflows.

---

## 9) Timeline & Capacity (2 weeks)

- **D1–D3:** Risk engine + weights; PR comment MVP.  
- **D4–D6:** Adaptive mapping + bounded enforcement; audit logs + rollback.  
- **D7–D8:** Drills and evidence capture; dashboards.  
- **D9–D10:** Tuning, reports, demo & retro.

**Estimate:** 24–28 pts across Platform, Sec, CI, SRE, DX.

---

## 10) Ticket Seed (importable)

```yaml
# file: .project/tickets/mc-sprint-2026-03-02.yaml
sprint: mc-2026-03-02
board:
  columns: [Backlog, Ready, In Progress, Review, Blocked, Done]
issues:
  - id: MC12-RISK-1
    title: Implement risk engine and API
    labels: [mc, risk, data]
    assignees: [owner-sec, owner-ci]
    points: 6
  - id: MC12-ADPT-1
    title: Adaptive profiles (bounded) + rollback
    labels: [mc, policy, cd]
    assignees: [owner-platform, owner-release]
    points: 6
  - id: MC12-EXP-1
    title: Safe drills (secret/unsigned/CVE/drift)
    labels: [mc, sre, drills]
    assignees: [owner-sre]
    points: 5
  - id: MC12-REV-1
    title: PR reviewer assist (risk drivers & fixes)
    labels: [mc, dx]
    assignees: [owner-dx]
    points: 3
  - id: MC12-GOV-1
    title: Governance logs + weekly report
    labels: [mc, policy, audit]
    assignees: [owner-sec]
    points: 4
```

---

## 11) Evidence & Reporting

- KPIs: risk distribution, high‑risk PR count, time‑to‑green delta, #adaptations, drill pass rate.  
- Artifacts: risk API logs, adapt.json snapshots, drill evidence packs, weekly report CSVs.  
- Store under `docs/mc/evidence/2026-03-02/`.

---

## 12) Changelog

- **Added:** Risk scoring, adaptive gates, and safe drills.  
- **Changed:** Reviewer workflow includes risk guidance.  
- **Fixed:** Static gating regardless of change risk.

