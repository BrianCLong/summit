---
slug: mc-sprint-2025-11-10-v1
version: 1.0.0
date: 2025-11-10
status: Proposed
owner: Platform Eng • DevSecOps (MC)
confidentiality: Internal
---

# MC Sprint Plan — v27.4 Scale, Audit, and Cost

> Theme: **Scale MC to 100% adoption, prove auditability, reduce CI/CD cost by 20%,** and harden runtime gates with SLO guardrails.

**Scope anchor:** `/orchestrations/mc`
**Prereqs:** `mc-sprint-2025-10-27-v1` runtime admission + PreSync verify in place
**Timebox:** 2 weeks (Nov 10–Nov 21, 2025, America/Denver)

---

## 0) Retro Snapshot (from 2025‑10‑27)

- ✅ Admission policies enforcing in prod; PreSync verify deployed broadly.
- ✅ CI latency improved for top repos; SBOM diff path working.
- ⚠️Partial: adoption at ~93–95% depending on day; drift alerting tuned but noisy.
- ❌Not done: unified audit report + export for compliance; cost controls (cache warmer only).

**Carry‑over risks:** developer friction from admission denials; flaky E2E when sharded.

---

## 1) Sprint Goals (Outcomes)

1. **Adoption = 100%** of active repos on MC reusable workflow (≥1 run during sprint).
2. **Audit pack v1**: exportable packet (attestations, SBOMs, policy results) for any release.
3. **CI/CD cost ↓ 20%** (compute minutes) versus baseline from 2025‑10‑13.
4. **Noise ↓ 50%** in drift and gate alerts via suppression and better labels.
5. **SLO guardrails**: block promotion if error budget burn > threshold.

---

## 2) Swimlanes

### A) Adoption Finalization (Owner: Platform)

- Auto‑PR remaining repos; block legacy workflows by date; CODEOWNERS coverage.

### B) Audit & Reporting (Owner: DevSecOps)

- Evidence pack generator; signed audit manifest; storage policy + retention.

### C) Cost Optimization (Owner: CI Guild)

- Runner sizing matrix; cache keys; selective matrix builds; artifact retention tweaks.

### D) Observability v4 (Owner: SRE)

- Alert dedupe; labels/owner mapping; burn‑rate SLOs wired to promotion gate.

### E) Developer Experience v4 (Owner: DX)

- `mc` CLI: `evidence pack` and `cost report`; status page improvements.

---

## 3) User Stories & Acceptance Criteria

> ID format: `MC4-<lane>-<n>`

### Adoption Finalization

1. **MC4-ADOPT-1** — _Block legacy workflows_
   - **AC:** `.github/workflows/legacy-*.yml` disabled via org rule; PRs created to migrate last repos; adoption = 100%.

### Audit & Reporting

2. **MC4-AUD-1** — _Evidence pack generator_
   - **AC:** `mc evidence --release <tag>` produces zip with: SBOM, signatures, attestations, OPA results, waivers; signed manifest.json.
3. **MC4-AUD-2** — _Compliance view_
   - **AC:** Dashboard lists releases with pass/fail; export to CSV.

### Cost Optimization

4. **MC4-COST-1** — _Compute minutes ↓ 20%_
   - **AC:** Weekly report shows ≥20% reduction; no gate coverage loss.
5. **MC4-COST-2** — _Artifact retention policy_
   - **AC:** Non‑promotable build artifacts auto‑expire in 3 days; promotable retained 90 days.

### Observability v4

6. **MC4-OBS-1** — _Alert dedup + ownership_
   - **AC:** Gate failure alerts include repo → team mapping; duplicates within 15m suppressed.
7. **MC4-OBS-2** — _SLO burn → promotion gate_
   - **AC:** If 30m burn rate > 2× budget, `promote` denies until cleared or override approved.

### Developer Experience v4

8. **MC4-DX-1** — _CLI evidence & cost_
   - **AC:** `mc evidence` and `mc cost` commands produce artifacts and charts; docs published.

---

## 4) Deliverables & Artifacts

- `.github/legacy-block.yml` (org rule doc), PR script.
- `cmd/mc` updates: `evidence`, `cost`.
- `scripts/cost-report.sh`, `scripts/selective-matrix.sh`.
- `dashboards/mc-compliance.json`, `dashboards/mc-cost.json`, `alerts/mc-rules-v4.yaml`.
- Storage policy: `SECURITY/retention.yaml`.

---

## 5) Scaffolds & Templates

### A) MC Evidence Pack (manifest + signer)

```bash
# file: scripts/mc-evidence.sh
set -euo pipefail
REL="$1"
OUT="docs/mc/evidence/$REL"
mkdir -p "$OUT"
cp sbom.json "$OUT/" || true
cp provenance/*.json "$OUT/" || true
cp verify/*.log "$OUT/" || true
jq -n --arg rel "$REL" '{release:$rel, created: now|todate, items: inputs}' < <(ls -1 "$OUT" | jq -R .) > "$OUT/manifest.json"
cosign sign-blob --yes "$OUT/manifest.json"
zip -r "$REL-evidence.zip" "$OUT"
```

### B) Promotion Gate: SLO burn‑rate check

```yaml
# file: .github/workflows/release-verify.yml
jobs:
  verify:
    steps:
      - name: Check SLO burn rate (30m)
        run: |
          BURN=$(curl -s "$PROM_URL/api/v1/query?query=alert:burn_rate_30m")
          echo "$BURN" | jq -e '.data.result[0].value[1] | tonumber <= 2.0'
```

### C) Selective Matrix Build (reduce waste)

```bash
# file: scripts/selective-matrix.sh
set -euo pipefail
CHANGED=$(git diff --name-only origin/main...HEAD)
MATRIX=[]
if echo "$CHANGED" | grep -q '^services/api/'; then MATRIX=$(jq -c '.+[{"name":"api"}]' <<<"$MATRIX"); fi
if echo "$CHANGED" | grep -q '^services/gateway/'; then MATRIX=$(jq -c '.+[{"name":"gateway"}]' <<<"$MATRIX"); fi
echo "matrix=$MATRIX" >> $GITHUB_OUTPUT
```

### D) Retention Policy (non‑promotable vs promotable)

```yaml
# file: SECURITY/retention.yaml
artifacts:
  non_promotable:
    ttl: 3d
  promotable:
    ttl: 90d
attestations:
  ttl: 365d
```

### E) GitHub Action: Apply Retention Labels

```yaml
# file: .github/workflows/artifact-retention.yml
name: Artifact Retention
on: [workflow_run]
jobs:
  label:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            // pseudo: mark artifacts with ttl based on promotable label
            core.info('apply retention labels')
```

---

## 6) Observability v4 (dashboards & alerts)

```json
// file: dashboards/mc-compliance.json
{
  "title": "MC Compliance",
  "panels": [
    {
      "type": "table",
      "title": "Releases",
      "targets": [{ "expr": "mc_release_status" }]
    },
    {
      "type": "graph",
      "title": "Gate Failures (dedup)",
      "targets": [{ "expr": "rate(mc_gate_failures_dedup_total[10m])" }]
    }
  ]
}
```

```json
// file: dashboards/mc-cost.json
{
  "title": "MC Cost",
  "panels": [
    {
      "type": "graph",
      "title": "CI Minutes",
      "targets": [{ "expr": "sum(rate(mc_ci_minutes_total[1d]))" }]
    },
    {
      "type": "table",
      "title": "Top Repos by Spend",
      "targets": [{ "expr": "topk(10, mc_ci_minutes_total)" }]
    }
  ]
}
```

```yaml
# file: alerts/mc-rules-v4.yaml
groups:
  - name: mc
    rules:
      - alert: MCCostRegression
        expr: increase(mc_ci_minutes_total[7d]) > baseline_cost*0.9
        for: 24h
        labels: { severity: ticket }
      - alert: MCDedupNoise
        expr: rate(mc_alerts_suppressed_total[1h]) < 0.5 and rate(mc_gate_failures_total[1h]) > 1
        for: 1h
        labels: { severity: info }
```

---

## 7) Governance: Deadlines & Decommission

- Freeze legacy CI workflows on **Nov 20, 2025**; exceptions require DevSecOps + Release Manager approval.
- Document bypass procedure for SEV‑1 incidents only; all bypasses logged to `docs/mc/bypasses/` with owner + TTL.

---

## 8) DOD, Gates & Rollback

**DOD**

- [ ] 100% adoption confirmed.
- [ ] Evidence pack generator shipped and signed; sample pack attached to demo.
- [ ] Cost minutes ↓ ≥ 20% without test coverage loss.
- [ ] Alert noise reduced by ≥ 50%; ownership mapping complete.
- [ ] SLO burn‑rate gate active in release verify.

**Rollback**

- Revert SLO gate step; keep verify/signature gates intact.
- Pause artifact retention action; restore previous TTLs.

---

## 9) Timeline & Capacity (2 weeks)

- **D1–D3:** Adoption close‑out; retention policy; cost matrix.
- **D4–D6:** Evidence pack + dashboards; alert dedupe.
- **D7–D9:** SLO gate wiring; finalize cost reductions.
- **D10:** Demo + compliance export.

**Estimate:** 26–30 pts across Platform, Sec, CI, SRE, DX.

---

## 10) Ticket Seed (importable)

```yaml
# file: .project/tickets/mc-sprint-2025-11-10.yaml
sprint: mc-2025-11-10
board:
  columns: [Backlog, Ready, In Progress, Review, Blocked, Done]
issues:
  - id: MC4-ADOPT-1
    title: Block legacy workflows & reach 100% adoption
    labels: [mc, migration]
    assignees: [owner-platform]
    points: 5
  - id: MC4-AUD-1
    title: Evidence pack generator + signed manifest
    labels: [mc, audit]
    assignees: [owner-sec]
    points: 5
  - id: MC4-AUD-2
    title: Compliance dashboard + CSV export
    labels: [mc, audit, observability]
    assignees: [owner-sre]
    points: 3
  - id: MC4-COST-1
    title: Reduce CI minutes by 20%
    labels: [mc, ci, cost]
    assignees: [owner-ci]
    points: 7
  - id: MC4-OBS-1
    title: Alert dedupe & ownership mapping
    labels: [mc, observability]
    assignees: [owner-sre]
    points: 3
  - id: MC4-OBS-2
    title: SLO burn-rate promotion gate
    labels: [mc, observability, cd]
    assignees: [owner-platform]
    points: 3
  - id: MC4-DX-1
    title: mc CLI evidence & cost
    labels: [mc, developer-experience]
    assignees: [owner-dx]
    points: 4
```

---

## 11) Evidence & Reporting

- KPIs: adoption %, CI minutes delta %, dedup ratio, #compliant releases, #bypasses with TTL.
- Artifacts: evidence zips, signed manifests, cost reports, dashboards.
- Store under `docs/mc/evidence/2025-11-10/`.

---

## 12) Changelog

- **Added:** Evidence packs; SLO gates; cost dashboards.
- **Changed:** Artifact retention; matrix selection; alert dedupe.
- **Fixed:** Last repos on legacy workflows.
