```md
# Maestro Conductor (MC) — Sprint Plan *(v1.0.0)*

**Slug:** `mc-sprint-2026-03-30-v1`  
**Dates (America/Denver):** 2026-03-30 → 2026-04-10  
**Owner/DRI:** Architect‑General  
**Teams:** Orchestrator Platform, SRE, Security, Data, UX, RevOps  
**Tracks:** A) Now‑value; B) Enduring moats  
**Prereq:** `mc-1.2.0` shipped (self‑serve onboarding, staged‑public marketplace, console PQL read‑only, CDC spine, edge policy bundles, budgets v2)

---

## 0) Context & Carry‑Forward
**Done**: Onboarding API w/ checklist & samples; partner allowlist marketplace; PQL in console (read‑only); CDC to Parquet; CDN‑served signed policy bundles; progressive throttling & rollback.  
**Carry‑forward**: Marketplace moderation tooling polish; CDC backfill monitoring; edge PDP stale‑bundle UX; incident correlator signal weights.

---

## 1) Objectives & Key Results — **Reliability & Growth**
| # | Objective | KR (measurable) |
|---|---|---|
| A1 | **Marketplace Public GA (Curated)** | Public browse (signed, curated); install success > **99.7%**; mean time to install < **30s** |
| A2 | **Incident Intelligence v2** | Root‑cause hints from correlated signals; median MTTA < **2m**; false page rate ↓ **30%** |
| A3 | **Customer Controls: Run Limits & Windows** | Per‑tenant run windows + max concurrent/by‑package limits; violation rate < **0.1%** |
| B1 | **Edge Policy GA** | Cache hit > **93%**; stale‑bundle auto‑quarantine; p95 eval − **35%** vs baseline |
| B2 | **Data Spine v2 (CDC → Lakehouse)** | Freshness SLA < **90s**; incremental merge; schema versioning w/ audit |
| B3 | **Perf & Cost v4** | 25k conc @ p95 publish→start < **3.8s**; idle cost ↓ **15%** additional |

---

## 2) Scope (In/Out)
**In**: Marketplace public GA toggles + moderation & provenance UI hooks, incident correlator v2 with hinting, run‑windows & per‑pkg caps, edge policy GA hardening, CDC→Lakehouse merge jobs & freshness SLOs, perf & cost tuning, docs & Jira scaffolds.  
**Out**: Marketplace revenue share; authoring UI for packages; non‑read‑only PQL UI.

---

## 3) Epics, Swimlanes & Stories

### 3.1 Marketplace Public GA (Curated)
- **MC‑MKT‑1801**: *Public browse & search*  
  **AC:** `/api/market/public` read‑only; search by name/tags; signatures/in‑toto required.  
- **MC‑MKT‑1802**: *Moderation queue & provenance view*  
  **AC:** reviewers approve/reject; provenance (SBOM, signatures) displayed; audit trail.  
- **MC‑MKT‑1803**: *Install fast‑path*  
  **AC:** pre‑pull images + cache hint → TTI < 30s for curated set.

### 3.2 Incident Intelligence v2
- **MC‑INC‑1811**: *Signal weighting & hints*  
  **AC:** correlator attaches `likely_root_cause` from patterns (policy spike, queue depth, region issue).  
- **MC‑INC‑1812**: *On‑call digest & paging*  
  **AC:** single summarized page w/ runbook links; false page rate ↓ 30%.

### 3.3 Customer Controls: Run Limits & Windows
- **MC‑LIM‑1821**: *Run windows*  
  **AC:** `allowedWindows` per tenant; deny w/ `retryAfter` advice.  
- **MC‑LIM‑1822**: *Per‑package caps*  
  **AC:** limit concurrent executions for specific packages per tenant; explainable denies.

### 3.4 Edge Policy GA
- **MC‑EDGE‑1831**: *Stale‑bundle quarantine*  
  **AC:** detect stale/unsigned; switch to last good; emit incident event.  
- **MC‑EDGE‑1832**: *Warm start + delta updates*  
  **AC:** delta bundle pushes; warm start from snapshot; hit > 93%.

### 3.5 Data Spine v2 (Lakehouse)
- **MC‑SPN‑1841**: *Merge job & freshness SLO*  
  **AC:** incremental upserts to Delta/Iceberg; SLA < 90s; backfill path documented.  
- **MC‑SPN‑1842**: *Schema versioning & audit*  
  **AC:** contract registry; change log; CI breaks on incompatible changes.

### 3.6 Perf & Cost v4
- **MC‑PERF‑1851**: *Queue partition auto‑tune*  
  **AC:** adaptive partitions based on tenant volume; fairness preserved.  
- **MC‑PERF‑1852**: *Runner image diet + cache DAO*  
  **AC:** reduce image size 20%; cache hit +10%; idle cost −15%.

### 3.7 SRE & Ops
- **MC‑SRE‑1861**: *GameDay: stale bundle & run window*  
  **AC:** quarantine works; windows deny with advice; on‑call digest clean.

---

## 4) Milestones (America/Denver)
- **Kickoff**: Mon 2026‑03‑30 10:00  
- **Design/ADR Review**: Tue 03‑31 15:00  
- **Mid‑sprint Evidence Review**: Fri 04‑03 16:00  
- **GameDay (Edge + Limits)**: Wed 04‑08 14:00  
- **Sprint Review & Release**: Fri 04‑10 15:00  
- **Retro**: Fri 04‑10 16:00

---

## 5) Artifacts & Scaffolds

### 5.1 OpenAPI (Marketplace, Limits)
```yaml
paths:
  /api/market/public:
    get: { summary: Public curated browse & search }
  /api/market/moderation:
    get: { summary: List pending packages for review }
    post: { summary: Approve/reject a package }
  /api/limits/windows:
    put: { summary: Upsert per-tenant run windows }
  /api/limits/package-caps:
    put: { summary: Upsert per-tenant per-package caps }
```

### 5.2 Run Windows (Rego)
`policy/rego/windows.rego`
```rego
package mc.windows

default allow = true

allow {
  some w
  w := input.tenant.allowedWindows[_]
  within_window(w.start, w.end, input.request.ts)
}

deny[msg] {
  not allow
  msg := {"reason":"outside_run_window","retryAfter": next_window_start(input.tenant.allowedWindows, input.request.ts) }
}
```

### 5.3 Per‑Package Caps (Rego)
`policy/rego/pkgcaps.rego`
```rego
package mc.pkgcaps

default allow = true

deny[msg] {
  wanted := input.request.package
  current := input.tenant.packageUsage[wanted]
  cap := input.tenant.packageCaps[wanted]
  current >= cap
  msg := {"reason": "package_cap", "package": wanted, "cap": cap}
}
```

### 5.4 Edge Quarantine (spec)
`docs/policy/EDGE_QUARANTINE.md`
```md
Detect: signature mismatch, digest drift, or TTL expiry.  
Action: mark current bundle unsafe → swap to last-good; raise `mc.incident.open` with `type=edge.bundle.stale`.  
Recovery: fetch fresh bundle; verify; close incident.
```

### 5.5 CDC → Lakehouse Merge Job (pseudo)
`jobs/lake/merge.py`
```python
# read kafka parquet micro-batches → merge into Delta/Iceberg using keys (executionId)
```

### 5.6 Moderation Queue (DDL)
`apps/mc-api/db/20260330_market.sql`
```sql
create table if not exists market_submissions (
  id uuid primary key default gen_random_uuid(),
  pkg_name text not null,
  version text not null,
  submitter text not null,
  status text not null check (status in ('pending','approved','rejected')) default 'pending',
  provenance jsonb not null,
  created_at timestamptz default now(),
  decided_at timestamptz
);
create index on market_submissions (status, created_at);
```

### 5.7 Incident On‑call Digest (template)
`docs/ops/INCIDENT_DIGEST.md`
```md
# Incident Digest
- Summary
- Likely root cause
- Impacted tenants/regions
- Runbook links
- Next update time
```

### 5.8 Queue Auto‑tune (config)
`infra/helm/mc/values.queue.yaml`
```yaml
queue:
  partitions:
    mode: adaptive
    minPerTenant: 2
    maxPerTenant: 16
    fairnessGuard: true
```

---

## 6) Observability & SLOs (adds)
- Metrics: `mc_market_public_installs_total`, `mc_incident_false_pages_ratio`, `mc_window_denies_total`, `mc_edge_quarantines_total`, `mc_cdc_freshness_s`, `mc_queue_partitions_active`, `mc_cost_idle_reduction_usd`.  
- Dashboards: Marketplace GA; Incident v2; Run limits; Edge GA; Lakehouse freshness; Queue auto‑tune & cost.  
- Alerts: false page ratio > 0.1; freshness > 90s; quarantine > 0 in 1h; outside window denies spike.

---

## 7) Security & Compliance
- Marketplace requires signatures + in‑toto; provenance must be viewable before install.  
- Edge GA enforces fail‑closed; all swaps to last‑good signed and audited.  
- Limits & windows decisions surfaced to users with explainability.

---

## 8) GameDay & Drills
- **Edge stale bundle**: quarantine & recover; users unaffected.  
- **Run window**: outside‑window burst blocked with proper advice; normal within window.  
- **CDC freshness**: traffic burst; freshness remains < 90s.

---

## 9) Release & Rollback
- Tag: `mc-1.3.0`.  
- Flags: `market_public_ga`, `incident_v2`, `run_windows_caps`, `edge_policy_ga`, `cdc_lakehouse`, `queue_autotune`.  
- Rollback: disable flags; return to central PDP; marketplace to private mode; revert partitions static.

---

## 10) Jira Import (CSV)
```csv
Summary,Issue Type,Parent,Labels,Description
Public marketplace browse/search,Story,EPIC-MC-MKT,mc;marketplace,Read-only public curated list/search
Moderation queue & provenance,Story,EPIC-MC-MKT,mc;marketplace,Approve/reject + show SBOM/signatures
Install fast-path TTI<30s,Story,EPIC-MC-MKT,mc;marketplace,Pre-pull & cache hints for curated set
Correlator hints & paging,Story,EPIC-MC-INC,mc;sre,Root-cause hints + summarized paging
Run windows per tenant,Story,EPIC-MC-LIM,mc;limits,Allowed windows with retryAfter advice
Per-package caps,Story,EPIC-MC-LIM,mc;limits,Concurrent caps with explain denies
Edge quarantine & delta updates,Story,EPIC-MC-EDGE,mc;policy,Stale bundle handling & deltas
CDC→Lakehouse merges,Story,EPIC-MC-SPN,mc;data,Incremental upserts with freshness SLA
Schema versioning & audit,Story,EPIC-MC-SPN,mc;data,Contracts registry and logs
Queue partition auto-tune,Story,EPIC-MC-PERF,mc;perf,Adaptive partitions maintain fairness
Runner image diet & cache,Story,EPIC-MC-PERF,mc;perf,Smaller images and higher cache hit
```

---

## 11) DoR / DoD (adds)
**Adds**: moderation playbook; incident hint precision report; window/cap deny explain tests; freshness SLA evidence; edge quarantine drill; cost reduction analysis.

---

## 12) Risks & Mitigations
| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Public marketplace exposure | M | H | Curated allowlist; strict provenance; read‑only for unauth |
| Edge quarantine flaps | L | M | Hysteresis + last‑good pinning; rapid refresh |
| Freshness SLA misses | M | M | Autoscale sinks; micro‑batch tuning; backpressure |

---

## 13) Evidence Links (populate during sprint)
- ADRs: `/docs/adr/ADR-11xx-*`  
- Edge GA drill: `/docs/evidence/edge-ga-2026-04-08/*`  
- Lakehouse freshness: `/docs/evidence/freshness-2026-04-09/*`  
- Release: `releases/mc-1.3.0`

---

> Reliability and growth in tandem: curated public marketplace, fewer noisy pages, strict run limits, faster edge policy, and a fresher lake.
```

