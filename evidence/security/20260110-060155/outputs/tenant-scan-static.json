[
  {
    "file": "ai/copilot/graphrag-provenance.service.ts",
    "line": 381,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:Entity)-[:HAS_EVIDENCE]->(ev:Evidence)           WHERE e.id IN $entityIds       "
  },
  {
    "file": "ai/copilot/graphrag-provenance.service.ts",
    "line": 430,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:Entity)-[:SUPPORTS]->(c:Claim)           WHERE e.id IN $entityIds             AN"
  },
  {
    "file": "analytics/adoption/AdoptionAnalyticsService.ts",
    "line": 542,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT         feature_id,         COUNT(DISTINCT user_hash) as users       FROM adoption_events    "
  },
  {
    "file": "auth-sso/SSOService.ts",
    "line": 163,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE email = $1"
  },
  {
    "file": "autonomous/orchestrator.enhanced.ts",
    "line": 601,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM runs WHERE id = $1"
  },
  {
    "file": "autonomous/orchestrator.enhanced.ts",
    "line": 608,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "UPDATE runs SET status = $2, started_at = COALESCE(started_at, NOW()) WHERE id = $1"
  },
  {
    "file": "backup/BackupService.ts",
    "line": 172,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n) RETURN n"
  },
  {
    "file": "backup/BackupService.ts",
    "line": 179,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r]->() RETURN r"
  },
  {
    "file": "cases/workflow/StateMachine.ts",
    "line": 395,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE maestro.cases          SET current_stage = $1,              updated_at = NOW()          WHERE"
  },
  {
    "file": "cases/workflow/StateMachine.ts",
    "line": 410,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE maestro.cases            SET status = "
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 104,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WHERE c.firstObservedAt >= datetime() - duration({millisecond"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 180,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c1:CogSecClaim), (c2:CogSecClaim)         WHERE c1.id < c2.id           AND c1.actor"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 308,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecActor)-[:MADE_CLAIM]->(c:CogSecClaim)-[:APPEARED_IN]->(ch:CogSecChannel)    "
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 439,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WITH c, size(c.actorIds) AS shares         WHERE c.firstObser"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 499,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         UNWIND $channelIds AS channelId         MATCH (ch:CogSecChannel {id: channelId})         SE"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 735,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         UNWIND $claimIds AS claimId         MATCH (c:CogSecClaim {id: claimId})         OPTIONAL MA"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 778,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (camp:CogSecCampaign {id: $campaignId}) RETURN camp"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 800,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (camp:CogSecCampaign {id: $campaignId})         SET camp.status = $status,           "
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 826,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (camp:CogSecCampaign)         WHERE camp.status IN ["
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 851,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (s:CogSecCoordinationSignal {campaignId: $campaignId})         RETURN s         ORDER"
  },
  {
    "file": "cognitive-security/campaign-detection.service.ts",
    "line": 945,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (s:CogSecCoordinationSignal {id: $signalId})         SET s.campaignId = $campaignId  "
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 141,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WHERE c.id <> $claimId         WITH c, gds.similarity.cosine("
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 177,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WITH c,              1.0 - (toFloat(apoc.text.levenshteinDist"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 212,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim {id: $claimId})         SET c.verdict = $verdict,             c.verdic"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 255,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c1:CogSecClaim {id: $claimId1})         MATCH (c2:CogSecClaim {id: $claimId2})      "
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 278,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:CogSecClaim {id: $claimId}) RETURN c"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 398,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:CogSecEvidence {id: $evidenceId})         UNWIND $claimIds AS claimId         MATC"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 423,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:CogSecEvidence {id: $evidenceId})         SET e.verified = true,             e.ver"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 483,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:CogSecNarrative {id: $narrativeId})         UNWIND $claimIds AS claimId         MA"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 508,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:CogSecNarrative {id: $narrativeId})         SET n.status = $status,             n."
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 535,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:CogSecNarrative {id: $narrativeId})<-[:PART_OF]-(c:CogSecClaim)         WITH n, co"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 637,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecActor {id: $actorId})         MATCH (c:CogSecClaim {id: $claimId})         M"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 704,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (ch:CogSecChannel {id: $channelId})         MATCH (c:CogSecClaim {id: $claimId})     "
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 735,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:CogSecNarrative {id: $narrativeId})         OPTIONAL MATCH (c:CogSecClaim)-[:PART_"
  },
  {
    "file": "cognitive-security/claims.service.ts",
    "line": 784,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim {id: $claimId})-[r:APPEARED_IN]->(ch:CogSecChannel)         RETURN ch,"
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 109,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (camp:CogSecCampaign)         WHERE camp.firstDetectedAt >= datetime($startDate)     "
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 138,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (s:CogSecCoordinationSignal)         WHERE s.detectedAt >= datetime($startDate)      "
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 214,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WHERE c.updatedAt >= datetime($startDate)           AND c.upd"
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 301,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WHERE c.updatedAt >= datetime($startDate)           AND c.upd"
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 364,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:CogSecNarrative)         WHERE n.createdAt >= datetime($startDate)           AND n"
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 385,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (p:CogSecPlaybook)         WHERE p.createdAt >= datetime($startDate)           AND p."
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 398,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecArtifact {type: "
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 485,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:CogSecIncident)         WHERE i.createdAt >= datetime($startDate)           AND i."
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 501,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecAuditLog)         WHERE a.action = "
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 517,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:CogSecIncident)         WHERE i.createdAt >= datetime($startDate)           AND i."
  },
  {
    "file": "cognitive-security/evaluation.service.ts",
    "line": 745,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (m:CogSecMetricsSnapshot)         WHERE m.generatedAt >= datetime($startDate)        "
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 515,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecAppeal {id: $appealId})         SET a.status = $status,             a.review"
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 567,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim {id: $claimId})         SET c.verdict = $requestedVerdict,            "
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 602,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecAppeal {status: "
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 624,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:CogSecAppeal {id: $appealId}) RETURN a"
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 642,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecAppeal {appellantId: $userId})         RETURN a         ORDER BY a.createdAt"
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 942,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecClaim)         WHERE c.createdAt >= datetime($startDate) AND c.createdAt <= "
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 957,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:CogSecAppeal)         WHERE a.createdAt >= datetime($startDate) AND a.createdAt <="
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 971,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (art:CogSecArtifact)         WHERE art.generatedAt >= datetime($startDate) AND art.ge"
  },
  {
    "file": "cognitive-security/governance.service.ts",
    "line": 1026,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CREATE (a:CogSecAppeal {           id: $id,           claimId: $claimId,           currentV"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 705,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:CogSecIncident {id: $incidentId})         SET i.timeline = i.timeline + [$event], "
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 730,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:CogSecIncident {id: $incidentId})         SET i.status = $status,             i.up"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 774,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (p:CogSecPlaybook {id: $playbookId}) RETURN p"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 837,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (p:CogSecPlaybook {id: $playbookId})         SET p.status = $status,             p.up"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 864,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:CogSecCampaign {id: $campaignId}) RETURN c"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 889,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (camp:CogSecCampaign {id: $campaignId})         OPTIONAL MATCH (c:CogSecClaim) WHERE "
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 1242,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (p:CogSecPlaybook {id: $playbookId})         SET p.actions = $actions,             p."
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 1261,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (p:CogSecPlaybook {id: $playbookId})         MATCH (c:CogSecCampaign {id: $campaignId"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 1281,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CREATE (a:CogSecArtifact {           id: $id,           type: $type,           title: $titl"
  },
  {
    "file": "cognitive-security/response-ops.service.ts",
    "line": 1346,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:CogSecCampaign {id: $campaignId})         MATCH (i:CogSecIncident {id: $incidentId"
  },
  {
    "file": "coherence/intelligence/activityFingerprintIndex.ts",
    "line": 666,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (af:ActivityFingerprint {fingerprint_id: $fingerprintId})               MERGE ("
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 293,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             SET m.current_phase = $phase, m."
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 305,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_OBJECTIVE]->(obj:Objective {objectiv"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 322,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_MILESTONE]->(ms:Milestone {milestone"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 339,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_RISK]->(rf:RiskFactor {risk_id: $ris"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 355,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             SET m.metadata = $metadata, m.la"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 518,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (m:Mission {mission_id: $missionId})           MERGE (m)-[:INFORMED_BY]->(ci:Cohere"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 592,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (obj:Objective {objective_"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 609,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (sh:Stakeholder {stakehold"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 626,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (res:Resource {resource_id"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 643,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (ms:Milestone {milestone_i"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 660,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (rf:RiskFactor {risk_id: $"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 677,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (sc:SuccessCriteria {crite"
  },
  {
    "file": "coherence/intelligence/narrativeImpactModel.ts",
    "line": 673,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (ni:NarrativeImpact {impact_id: $impactId})               MERGE (e:Entity {enti"
  },
  {
    "file": "data/UserRepository.ts",
    "line": 15,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) FROM users WHERE is_active = TRUE"
  },
  {
    "file": "data/UserRepository.ts",
    "line": 23,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) FROM users WHERE is_active = TRUE AND mfa_enabled = TRUE"
  },
  {
    "file": "db/compensationLog.ts",
    "line": 215,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})         SET ${setClause}, log.updatedAt = "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 239,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})         UNWIND $compensators AS comp      "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 275,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})-[:HAS_COMPENSATOR]->(c:Compensator)       "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 348,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (n:${entityType} {id: $entityId})           DELETE n         "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 371,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (n:${entityType} {id: $entityId})           SET n = $originalProperties         "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 384,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH ()-[r:${compensationData.type} {id: $relationshipId}]->()           DELETE r       "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 394,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (from {id: $fromId}), (to {id: $toId})           CREATE (from)-[r:${compensationDat"
  },
  {
    "file": "db/compensationLog.ts",
    "line": 463,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog)         ${whereClause}         OPTIONAL MATCH (log)-[:HAS_COMPE"
  },
  {
    "file": "db/online-migrations/exampleUserDisplayNameMigration.ts",
    "line": 21,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET display_name = $1 WHERE id = $2"
  },
  {
    "file": "db/online-migrations/exampleUserDisplayNameMigration.ts",
    "line": 27,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET display_name_canonical = $1 WHERE id = $2"
  },
  {
    "file": "db/online-migrations/exampleUserDisplayNameMigration.ts",
    "line": 45,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, display_name FROM users ORDER BY created_at, id LIMIT $1 OFFSET $2"
  },
  {
    "file": "db/online-migrations/exampleUserDisplayNameMigration.ts",
    "line": 50,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT count(*)::int AS count FROM users"
  },
  {
    "file": "db/online-migrations/exampleUserDisplayNameMigration.ts",
    "line": 64,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET display_name_canonical = $1 WHERE id = $2"
  },
  {
    "file": "entities/comments/EntityCommentService.ts",
    "line": 347,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "         SELECT id, username         FROM users         WHERE username = ANY($1)       "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 114,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (e:Entity {id: $id})               OPTIONAL MATCH (e)-[:FROM_SOURCE]->(s:Source"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 819,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                  UNWIND $evidenceIds as evidenceId             "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 829,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                  UNWIND $claimIds as claimId                  M"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 876,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim {id: $id})              SET c.claimType = $claimType,                  c.statement = "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 929,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence {id: $id})              SET e.title = $title,                  e.description = $de"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 987,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $id})              SET d.title = $title,                  d.description = $de"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1038,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                UNWIND $evidenceIds as evidenceId               "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1048,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                UNWIND $claimIds as claimId                MATCH"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1091,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim {id: $id}) WHERE c.tenant = $tenant RETURN c"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1129,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence {id: $id}) WHERE e.tenant = $tenant RETURN e"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1181,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $id}) WHERE d.tenant = $tenant          OPTIONAL MATCH (d)-[:SUPPORTED_BY]->("
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1226,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim)          WHERE c.tenant = $tenant          AND (toLower(c.statement) CONTAINS toLowe"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1269,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence)          WHERE e.tenant = $tenant          AND (toLower(e.title) CONTAINS toLower"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1316,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision)          WHERE d.tenant = $tenant          AND (toLower(d.title) CONTAINS toLower"
  },
  {
    "file": "graphql/loaders.ts",
    "line": 35,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (n) WHERE elementId(n) IN $ids OR n.id IN $ids             RETURN n             "
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 921,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[:EXTRACTED_FROM]->(m:MediaSource)           R"
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 940,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[:HAS_CROSS_MODAL_MATCH]->(c:CrossModalMatch) "
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 959,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[r:MultimodalRelationship]-(other:MultimodalEn"
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 986,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (j:ExtractionJob {id: $jobId})-[:EXTRACTED]->(e:MultimodalEntity)           OPTIONA"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 165,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})${permClause}            MATCH (creator:User {id: e.createdBy})           "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 305,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity)-[r:RELATIONSHIP {id: $id}]->(to:Entity)${permClause}            RETURN r, from, "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 440,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (i:Investigation {id: $id})            MATCH (creator:User {id: i.createdBy})            OPTIO"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 578,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {investigationId: $investigationId}) RETURN e"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 583,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {investigationId: $investigationId})-[r:RELATIONSHIP]->(to:Entity {investigationI"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 662,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r]->(related:Entity)            RETURN related, type(r) as relatio"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 923,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) RETURN e.investigationId as invId"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 966,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1007,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            OPTIONAL MATCH (e)-[r:RELATIONSHIP]-()            DELETE r, e "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1071,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {id: $fromEntityId})            MATCH (to:Entity {id: $toEntityId})            CR"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1173,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {id: $fromEntityId})              MATCH (to:Entity {id: $toEntityId})            "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1298,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (:Entity)-[r:RELATIONSHIP {id: $id}]->(:Entity) RETURN r.investigationId as invId"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1345,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity)-[r:RELATIONSHIP {id: $id}]->(to:Entity)            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1395,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:Entity)-[r:RELATIONSHIP {id: $id}]-(b:Entity)            WITH a, b, r            DELETE r  "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1533,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (i:Investigation {id: $id})            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1742,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r:RELATIONSHIP]-(other:Entity)            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1765,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (other:Entity)-[r:RELATIONSHIP]->(e:Entity {id: $entityId})            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1788,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r:RELATIONSHIP]->(other:Entity)            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1822,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {investigationId: $investigationId}) RETURN e"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1840,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {investigationId: $investigationId})-[r:RELATIONSHIP]->(to:Entity {investigationI"
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 98,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, username, first_name, last_name, role, is_active,                   last_login, pr"
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 145,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, username, first_name, last_name, role, is_active,                   last_login, pr"
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 192,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM users WHERE email = $1 OR username = $2"
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 267,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM users WHERE id = $1"
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 294,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users            SET ${updates.join("
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 343,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users            SET is_active = false, updated_at = NOW()            WHERE id = $1          "
  },
  {
    "file": "graphql/resolvers/user.ts",
    "line": 405,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users            SET preferences = COALESCE(preferences, "
  },
  {
    "file": "graphql/resolvers.canonical.ts",
    "line": 41,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n {id: $id}) RETURN n"
  },
  {
    "file": "graphql/resolvers.canonical.ts",
    "line": 79,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n:Person {id: $id}) RETURN n"
  },
  {
    "file": "graphql/resolvers.canonical.ts",
    "line": 114,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "                        MATCH (n)                        WHERE n.id CONTAINS $query OR n.name CONTAI"
  },
  {
    "file": "graphql/resolvers.er.ts",
    "line": 369,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (a:Entity) WHERE a.id = $entityA OR a.uuid = $entityA             MATCH (b:Entity"
  },
  {
    "file": "intel/cti/bundle-serializer.ts",
    "line": 182,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (source:Entity)-[r]->(target:Entity)           WHERE source.id IN $entityIds AND ta"
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 41,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $runId})         SET r += $props         "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 57,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $props.runId})         MERGE (t:MaestroTask {id: $props.id})      "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 81,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (t:MaestroTask {id: $taskId})         SET t += $props         "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 96,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (t:MaestroTask {id: $artifact.taskId})         MERGE (a:MaestroArtifact {id: $artifac"
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 115,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $sample.runId})         CREATE (c:MaestroCostSample)         SET c"
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 132,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $runId})-[:HAS_COST]->(c:MaestroCostSample)         RETURN        "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 182,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $runId})         RETURN r         "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 203,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $runId})-[:HAS_TASK]->(t:MaestroTask)         RETURN t         ORD"
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 226,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (t:MaestroTask {id: $taskId})         RETURN t         "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 247,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (r:MaestroRun {id: $runId})-[:HAS_ARTIFACT]->(a:MaestroArtifact)         RETURN a    "
  },
  {
    "file": "intelgraph/client-impl.ts",
    "line": 264,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (t:MaestroTask {id: $taskId})-[:HAS_ARTIFACT]->(a:MaestroArtifact)         RETURN a  "
  },
  {
    "file": "lib/auth.ts",
    "line": 113,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, username, role, token_version FROM users WHERE id = $1"
  },
  {
    "file": "maestro/mcp/audit-api.ts",
    "line": 10,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, user_id, action, resource_type, resource_id, details, created_at        FROM audit_logs  "
  },
  {
    "file": "maestro/pipelines/pipelines-repo.ts",
    "line": 89,
    "type": "SQL",
    "message": "Query accessing 'pipelines' likely missing 'tenant_id' filter",
    "snippet": "UPDATE pipelines SET ${sets.join("
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 57,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE NOT EXISTS(n.policy_sensitivity)     SET n.policy_origin = $policy_origin, "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 87,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH ()-[r]->()     WHERE NOT EXISTS(r.policy_sensitivity)     SET r.policy_sensitivity = $pol"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 167,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n:Entity)     WHERE ANY(prop IN keys(n) WHERE n[prop] =~ $pattern)     AND NOT n.policy_"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 187,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n:Entity)     WHERE ANY(prop IN keys(n) WHERE toString(n[prop]) =~ $pattern)     AND NOT"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 216,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE NOT EXISTS(n.policy_owner)     SET n.policy_owner = CASE       WHEN n:Inves"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 241,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE n.policy_retention_days IS NOT NULL     AND n.policy_collection_date IS NOT"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 348,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (n)       WHERE EXISTS(n.policy_sensitivity)       REMOVE n.policy_origin,             "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 371,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH ()-[r]->()       WHERE EXISTS(r.policy_sensitivity)       REMOVE r.policy_sensitivity, "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 419,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (n)       WHERE EXISTS(n.policy_sensitivity)       RETURN count(n) > 0 as migrated     "
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 161,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 168,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users"
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 209,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "predictive/PredictiveService.ts",
    "line": 144,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (n)             WHERE n.investigation_id = $invId             OPTIONAL MATCH (n)-"
  },
  {
    "file": "products/fusion/FusionService.ts",
    "line": 147,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:Entity {id: $idA}), (b:Entity {id: $idB})                  MERGE (a)-[r:RELATED_TO {type: $"
  },
  {
    "file": "provenance/CanonicalGraphService.ts",
    "line": 85,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n:CanonicalNode {id: $id}) RETURN n.nodeType as type"
  },
  {
    "file": "repos/CaseRepo.ts",
    "line": 176,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE maestro.cases SET ${updateFields.join("
  },
  {
    "file": "repos/CaseRepo.ts",
    "line": 217,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "DELETE FROM maestro.cases WHERE id = $1"
  },
  {
    "file": "repos/EntityRepo.ts",
    "line": 403,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            DETACH DELETE e"
  },
  {
    "file": "repos/RelationshipRepo.ts",
    "line": 383,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:REL {id: $id}]-()            DELETE r"
  },
  {
    "file": "resolvers/WargameResolver.ts",
    "line": 218,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (s:CrisisScenario {id: $id})          SET s.crisisType = $crisisType,              s.updatedAt"
  },
  {
    "file": "resolvers/WargameResolver.ts",
    "line": 249,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (s:CrisisScenario {id: $id}) DETACH DELETE s"
  },
  {
    "file": "resolvers/ai.ts",
    "line": 133,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a)-[r]->(b) WHERE r.snapshotId = $snapshotId RETURN a.id as u, b.id as v"
  },
  {
    "file": "resolvers/entities.ts",
    "line": 34,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n {id: $id, tenant_id: $tenant}) RETURN n"
  },
  {
    "file": "resolvers/entities.ts",
    "line": 76,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (startNode {id: $id, tenant_id: $tenant})-[*1..${maxHops}]-(neighbor)            WHERE neighbo"
  },
  {
    "file": "routes/admin.ts",
    "line": 103,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) FROM users"
  },
  {
    "file": "scripts/generate_retention_report.ts",
    "line": 17,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM audit_logs        WHERE action LIKE "
  },
  {
    "file": "search/search.ts",
    "line": 127,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Case) WHERE c.id IN $ids         OPTIONAL MATCH (c)-[:MENTIONS]->(i:IOC)         RETURN c.i"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 342,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) as total FROM users WHERE ${whereClause}"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 350,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE ${whereClause} ORDER BY created_at DESC LIMIT $${paramCount + 1} OFFSET $$"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 364,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 485,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET ${updates.join("
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 567,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET is_active = false, updated_at = NOW() WHERE id = $1"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 592,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET password_hash = $1, updated_at = NOW() WHERE id = $2"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 727,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) as total FROM audit_logs WHERE ${whereClause}"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 735,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM audit_logs WHERE ${whereClause} ORDER BY timestamp DESC LIMIT $${paramCount + 1} OFFSE"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 1090,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "       SELECT action, COUNT(*) as count       FROM audit_logs       WHERE timestamp > NOW() - INTERV"
  },
  {
    "file": "services/AuthService.ts",
    "line": 326,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM users WHERE email = $1 OR username = $2"
  },
  {
    "file": "services/AuthService.ts",
    "line": 402,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE email = $1 AND is_active = true"
  },
  {
    "file": "services/AuthService.ts",
    "line": 414,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = $1"
  },
  {
    "file": "services/AuthService.ts",
    "line": 472,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE email = $1 AND is_active = true"
  },
  {
    "file": "services/AuthService.ts",
    "line": 489,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = $1"
  },
  {
    "file": "services/AuthService.ts",
    "line": 592,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1 AND is_active = true"
  },
  {
    "file": "services/AuthService.ts",
    "line": 658,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1 AND is_active = true"
  },
  {
    "file": "services/BackupService.ts",
    "line": 198,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n) RETURN n"
  },
  {
    "file": "services/BackupService.ts",
    "line": 214,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r]->() RETURN r"
  },
  {
    "file": "services/CacheWarmingService.ts",
    "line": 430,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:Investigation)         WHERE i.lastAccessedAt > datetime() - duration("
  },
  {
    "file": "services/DatabaseService.ts",
    "line": 25,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users"
  },
  {
    "file": "services/GACoremetricsService.ts",
    "line": 344,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         WITH COUNT(e) as total,              COUNT(CASE WHEN e.name IS NOT"
  },
  {
    "file": "services/GAEnrollmentService.ts",
    "line": 170,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) as count FROM users"
  },
  {
    "file": "services/GraphConsistencyService.ts",
    "line": 44,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n) WHERE NOT (n)--() RETURN n LIMIT 1000"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 75,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity) WHERE $type IS NULL OR e.type = $type RETURN e LIMIT $limit"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 88,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (:Entity {id: $id})-[r:RELATIONSHIP]-(:Entity) RETURN r"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 173,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:Entity {id: $fromId}), (b:Entity {id: $toId})              MERGE (a)-[rel:RELATIONSHIP {id:"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 192,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n:Entity {id: $id}) DETACH DELETE n"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 203,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:RELATIONSHIP {id: $id}]-() DELETE r"
  },
  {
    "file": "services/GraphXAIService.ts",
    "line": 31,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n {id: $nodeId})-[r*1..2]-(m)         RETURN n.id as source, m.id as target, labels("
  },
  {
    "file": "services/GraphXAIService.ts",
    "line": 47,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n {id: $nodeId})         OPTIONAL MATCH (n)-[]-(m)         RETURN n.id as u, m.id as"
  },
  {
    "file": "services/GraphXAIService.ts",
    "line": 95,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "              MATCH (n {id: $nodeId})-->(m)              RETURN n.id as nid, labels(n) as nlabels, m"
  },
  {
    "file": "services/OIDCAuthService.ts",
    "line": 645,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET is_active = false, updated_at = NOW() WHERE email = $1"
  },
  {
    "file": "services/PasswordResetService.ts",
    "line": 73,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, first_name FROM users WHERE email = $1 AND is_active = true"
  },
  {
    "file": "services/PasswordResetService.ts",
    "line": 159,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT prt.id, prt.user_id, prt.expires_at, prt.used_at, u.email          FROM password_reset_tokens"
  },
  {
    "file": "services/PasswordResetService.ts",
    "line": 187,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users          SET password_hash = $1, updated_at = NOW(), failed_login_attempts = 0, locked_"
  },
  {
    "file": "services/PasswordResetService.ts",
    "line": 251,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, password_hash FROM users WHERE id = $1 AND is_active = true"
  },
  {
    "file": "services/PasswordResetService.ts",
    "line": 279,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET password_hash = $1, updated_at = NOW() WHERE id = $2"
  },
  {
    "file": "services/PredictiveRelationshipService.ts",
    "line": 65,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) RETURN e"
  },
  {
    "file": "services/PredictiveRelationshipService.ts",
    "line": 197,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) SET e.embedding = $embedding"
  },
  {
    "file": "services/QueryPreviewService.ts",
    "line": 699,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         WITH DISTINCT labels(e) as ent"
  },
  {
    "file": "services/SSOService.ts",
    "line": 71,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE email = $1"
  },
  {
    "file": "services/SemanticSearchService.ts",
    "line": 140,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE cases SET embedding = $1::vector WHERE id = $2"
  },
  {
    "file": "services/SupernodeQueryOptimizer.ts",
    "line": 137,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {id: $entityId})         OPTIONAL MATCH (e)-[r_out]->()         WITH e, cou"
  },
  {
    "file": "services/SupernodeQueryOptimizer.ts",
    "line": 540,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         WITH e, size((e)--()) AS connectionCount         WHERE connectionC"
  },
  {
    "file": "services/ThreatIntelligenceFusionService.ts",
    "line": 66,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a {id: $sourceId}), (b {id: $targetId})         MERGE (a)-[r:${type}]->(b)         S"
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 206,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) FROM users WHERE ${whereClause}"
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 213,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE ${whereClause}          ORDER BY ${sortColumn} ${sortOrder.toUpperCase()} "
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 373,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM users WHERE email = $1"
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 564,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET ${updates.join("
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 698,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "DELETE FROM users WHERE id = $1"
  },
  {
    "file": "services/UserManagementService.ts",
    "line": 701,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET is_active = false, updated_at = NOW() WHERE id = $1"
  },
  {
    "file": "services/VeracityScoringService.ts",
    "line": 83,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity {id: $id})         SET n.veracityScore = $score,             n.veracityConf"
  },
  {
    "file": "services/consistency/GraphConsistencyService.ts",
    "line": 62,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n:Entity)          WHERE n.investigationId = $investigationId          RETURN n.id as id"
  },
  {
    "file": "services/consistency/GraphConsistencyService.ts",
    "line": 72,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:RELATIONSHIP]->()          WHERE r.investigationId = $investigationId          RETURN r."
  },
  {
    "file": "services/consistency/GraphConsistencyService.ts",
    "line": 232,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "                 MATCH (e:Entity)                 WHERE e.id IN $ids                 DETACH DELETE e"
  },
  {
    "file": "services/consistency/GraphConsistencyService.ts",
    "line": 243,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "                 MATCH ()-[r:RELATIONSHIP]->()                 WHERE r.id IN $ids                 DE"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 531,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n) WHERE n.id IN $ids RETURN n"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 652,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "          MATCH (source)-[r]->(target)          WHERE (source.id IN $mergeIds OR target.id IN $merge"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 685,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (d:ERDecision {id: $decisionId})           MATCH (m {id: $masterId})           MERG"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 710,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m {id: $masterId})               MATCH (t {id: $targetId})               // Us"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 731,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (s {id: $sourceId})               MATCH (m {id: $masterId})               MERGE"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 766,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (d:ERDecision {id: $decisionId})         SET d.archivedRelationships = $blob       "
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 771,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n)-[r]-()         WHERE n.id IN $mergeIds AND NOT n:ERDecision         SET r.merged "
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 780,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (n {id: $id})             SET n:MergedEntity             SET n.mergedInto = $mast"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 810,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "        MATCH (d:ERDecision {id: $decisionId})        RETURN d      "
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 827,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "            MATCH (n {id: $id})            SET n:Entity            REMOVE n:MergedEntity            "
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 836,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "          MATCH ()-[r {mergedByDecision: $decisionId}]-()          REMOVE r.merged          REMOVE r"
  },
  {
    "file": "services/er/EntityResolutionV2Service.ts",
    "line": 850,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "          MATCH (d:ERDecision {id: $decisionId})          SET d:RevertedDecision          SET d.reve"
  },
  {
    "file": "services/safety/ModelAbuseWatch.ts",
    "line": 42,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET status = "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 119,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CALL gds.pageRank.stream($graphName, {           maxIterations: 20,           dampingFactor"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 142,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 188,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         ${pathPattern}        "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 211,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 302,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 340,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.spannin"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 381,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 423,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity)         WHERE n.investigationId = $investigationId AND n.embedding IS NOT "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 446,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusIds         CALL apoc.path.subgraphNod"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 481,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 515,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.subgrap"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 541,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 573,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.subgrap"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 599,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 635,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (start:Entity), (end:Entity)       WHERE start.id IN $focusNodeIds AND end.id IN $targe"
  },
  {
    "file": "services/semantic-rag/HybridSemanticRetriever.ts",
    "line": 490,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity)         WHERE n.id IN $nodeIds         OPTIONAL MATCH (n)-[r]-(m)         "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 418,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (a:Entity {stixId: $sourceRef}), (b:Entity {stixId: $targetRef})       MERGE (a)-[r:${r"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 459,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       WHERE e.stixId IS NULL         ${investigationId ? "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 517,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (stix:Entity {stixId: $stixId}), (target:Entity {id: $nodeId})           MERGE (sti"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 550,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity {id: $nodeId})         CALL apoc.path.subgraphNodes(start, {           "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 640,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-(ioc:Entity:In"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 652,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-()-[:ATTRIBUTE"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 665,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-()-[:ATTRIBUTE"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 678,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         WITH COALESCE(e.threatScore, 0) + COALESCE("
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 705,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         WHERE e.killChainPhases IS NOT"
  },
  {
    "file": "services/ticket-links.ts",
    "line": 36,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM runs WHERE id = $1"
  },
  {
    "file": "sigint/persistence/SigIntRepository.ts",
    "line": 168,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "          MATCH (e:Emitter {id: $emitterId})          CREATE (s:Signal {            id: $id,        "
  },
  {
    "file": "utils/sampleData.ts",
    "line": 134,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity) RETURN e LIMIT 5"
  },
  {
    "file": "utils/sampleData.ts",
    "line": 164,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (from:Entity {id: $from}), (to:Entity {id: $to})           MERGE (from)-[r:${rel.ty"
  },
  {
    "file": "workers/OutboxNeo4jSync.ts",
    "line": 246,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            DETACH DELETE e"
  },
  {
    "file": "workers/OutboxNeo4jSync.ts",
    "line": 322,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:REL {id: $id}]-()            DELETE r"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 22,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a {id:$u}), (b {id:$v})                  MERGE (a)-[r:RELATED {source:"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 33,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (x {id:$a}),(y {id:$b})                  MERGE (x)-[r:SAME_AS {source:"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 43,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "UNWIND $members as m                  MATCH (n {id:m}) SET n.community=$cid"
  }
]