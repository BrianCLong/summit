# Defense Simulation Apparatus Dependent Claims (v1)

This document contains dependent claims for the Defense Simulation Apparatus family, focusing on lineage-aware simulation, adversarial red-teaming, formal verification, policy simulation, and federated defense.

## Independent Claim S1

S1. A simulation apparatus for evaluating adversarial misinformation defense actions, comprising:
- a memory storing instructions and a narrative operating graph representing narrative states derived from source records;
- one or more processors configured to execute the instructions to:
  - receive a plurality of candidate defense actions;
  - execute a counterfactual simulation of each candidate defense action within a simulated environment to predict a trust impact metric;
  - rank the plurality of candidate defense actions based on the predicted trust impact metric and a set of governance policies;
  - record a replay manifest for the counterfactual simulation, the replay manifest being bound to a snapshot hash of the narrative operating graph; and
  - output a permitted defense action based on the ranking for execution by an execution interface.

## Cluster 1: Lineage-aware simulation inputs (S91–S100)

S91. The apparatus of claim S1, wherein the apparatus receives a lineage manifest for each candidate defense action, the lineage manifest referencing source records and transformation identifiers contributing to the candidate defense action.
S92. The apparatus of claim S91, wherein the apparatus computes a lineage hash over the lineage manifest and includes the lineage hash in the replay manifest.
S93. The apparatus of claim S91, wherein the apparatus denies ranking a candidate defense action above monitoring-only actions when the lineage manifest lacks required source records.
S94. The apparatus of claim S1, wherein the apparatus conditions predicted trust impact on a reliability score stored in source records referenced by the lineage manifest.
S95. The apparatus of claim S1, wherein the apparatus increases predicted uncertainty for impact metrics when a fraction of sources referenced by the lineage manifest are below a reliability threshold.
S96. The apparatus of claim S1, wherein the apparatus outputs, for each ranked action, a structured explanation identifying at least one source category contributing to the ranking.
S97. The apparatus of claim S1, wherein the apparatus stores transformation identifiers and tool/model version identifiers used for simulation in the replay manifest.
S98. The apparatus of claim S1, wherein the apparatus supports selecting among multiple snapshots and selects a snapshot set whose sources satisfy a minimum reliability constraint.
S99. The apparatus of claim S1, wherein the apparatus records a redaction manifest associated with simulation inputs in an audit log excluding never-log fields.
S100. The apparatus of claim S1, wherein the apparatus outputs a “lineage completeness score” and uses the score as a ranking constraint.

## Cluster 2: Adversarial red-team simulation + robustness scoring (S101–S110)

S101. The apparatus of claim S1, wherein executing the counterfactual simulation comprises simulating one or more adversarial counter-narrative scenarios generated by a red-team agent.
S102. The apparatus of claim S101, wherein the red-team agent is restricted to generating scenarios for simulation and is denied access to the execution interface absent an approval token.
S103. The apparatus of claim S101, wherein the apparatus computes a robustness score for each candidate defense action based on simulated outcomes across the plurality of adversarial counter-narrative scenarios.
S104. The apparatus of claim S103, wherein the apparatus excludes from ranking any candidate defense action having a robustness score below a threshold.
S105. The apparatus of claim S1, wherein the apparatus performs a differential simulation across at least two different narrative graph snapshots and records the results in the replay manifest.
S106. The apparatus of claim S1, wherein the apparatus identifies sensitive narrative states and applies stricter ranking constraints for defense actions affecting the sensitive narrative states.
S107. The apparatus of claim S1, wherein the apparatus re-simulates defense actions when the set of governance policies is updated and records a policy-change simulation artifact.
S108. The apparatus of claim S1, wherein the apparatus includes adversarial scenario identifiers and evaluation parameters in the replay manifest.
S109. The apparatus of claim S1, wherein the apparatus outputs a robustness explanation artifact identifying specific adversarial scenarios that contributed to a low robustness score.
S110. The apparatus of claim S1, wherein the apparatus verifies that simulation outputs are reproducible by re-executing a portion of the counterfactual simulation using the replay manifest.

## Cluster 3: Formal verification / model checking for simulation outputs (S151–S160)

S151. The apparatus of claim S1, wherein the apparatus verifies a replay manifest by checking presence and consistency of at least a snapshot hash, a policy bundle hash, and version identifiers used in counterfactual simulation.
S152. The apparatus of claim S151, wherein the apparatus generates a verification proof artifact indicating that ranked outputs are reproducible under the replay manifest and records the proof artifact in an audit log.
S153. The apparatus of claim S1, wherein the apparatus performs a satisfiability check over governance policies and candidate defense action schemas prior to producing ranked outputs.
S154. The apparatus of claim S153, wherein the apparatus enters a safe mode that excludes external publishing actions from ranking when the satisfiability check fails.
S155. The apparatus of claim S1, wherein the apparatus checks that modify decisions preserve required attribution and uncertainty fields and generates a counterexample artifact when a modified action violates a required-field constraint.
S156. The apparatus of claim S155, wherein the apparatus records the counterexample artifact and a policy bundle hash in an append-only audit log.
S157. The apparatus of claim S1, wherein the apparatus performs a policy constraint compliance check confirming that each output permitted defense action satisfies all applicable hard constraints derived from governance policies.
S158. The apparatus of claim S157, wherein the apparatus denies producing an output permitted defense action when the compliance check yields an unsatisfied constraint and records an unsatisfied-constraint explanation.
S159. The apparatus of claim S1, wherein the apparatus validates determinism by re-running counterfactual simulations using canonical ordering and fixed seeds specified in a replay manifest and confirming byte-identical ranked outputs.
S160. The apparatus of claim S1, wherein the apparatus digitally signs a replay manifest or proof artifact and stores a signature identifier linked to snapshot hash and policy bundle hash.

## Cluster 4: Policy simulation (“what-if” governance changes) in ranking (S161–S170)

S161. The apparatus of claim S1, wherein the apparatus executes a policy what-if simulation by evaluating a same set of candidate defense actions under at least two different policy bundle hashes.
S162. The apparatus of claim S161, wherein the apparatus generates a policy delta report comprising differences in allow, deny, and modify decisions between the at least two different policy bundle hashes.
S163. The apparatus of claim S162, wherein the policy delta report comprises differential risk deltas for at least one metric comprising policy risk, legal risk, or trust impact.
S164. The apparatus of claim S1, wherein the apparatus denies enabling production ranking under a new policy bundle hash when the policy delta report indicates an increase in externally publishable actions above a threshold absent approval.
S165. The apparatus of claim S1, wherein the apparatus re-ranks candidate defense actions under each policy bundle hash and outputs a ranking delta summary.
S166. The apparatus of claim S165, wherein the apparatus identifies defense action types that change permission status between policy bundles and records the changes in an audit log linked to the policy bundle hashes.
S167. The apparatus of claim S1, wherein the apparatus includes in a replay manifest the policy bundle hashes compared in the policy what-if simulation and the snapshot hash used for the comparison.
S168. The apparatus of claim S1, wherein the apparatus gates rollout of a new policy bundle hash via staged rollout criteria and reverts to a prior policy bundle hash when validation metrics degrade.
S169. The apparatus of claim S1, wherein the apparatus computes a policy coverage metric and excludes from ranking any candidate defense action whose required fields are not governed by at least one applicable rule.
S170. The apparatus of claim S1, wherein the apparatus stores policy delta reports as redacted artifacts excluding never-log fields.

## Cluster 5: Cross-org federated defense in simulation (S171–S180)

S171. The apparatus of claim S1, wherein the apparatus operates in a multi-tenant configuration and maintains tenant-isolated simulation inputs comprising tenant-specific snapshots and tenant-specific governance policies.
S172. The apparatus of claim S171, wherein the apparatus receives federated aggregates comprising technique indicator rates computed across tenants without receiving raw artifacts.
S173. The apparatus of claim S172, wherein the apparatus conditions transition function parameters on the federated aggregates to adjust simulated adversarial response likelihood.
S174. The apparatus of claim S171, wherein the apparatus applies thresholding rules that exclude federated aggregates that do not satisfy minimum aggregation criteria.
S175. The apparatus of claim S171, wherein the apparatus applies a privacy budget to the use of federated aggregates and restricts further use when the privacy budget is exceeded.
S176. The apparatus of claim S171, wherein the apparatus performs secure aggregation such that a coordinator cannot access individual tenant contributions to a federated aggregate.
S177. The apparatus of claim S171, wherein the apparatus outputs tenant-specific rankings that incorporate federated robustness regression alerts while respecting tenant-specific governance constraints.
S178. The apparatus of claim S171, wherein the apparatus denies applying a federated recommendation when inconsistent with a tenant’s governance policies and records the denial reason.
S179. The apparatus of claim S171, wherein the replay manifest includes identifiers of federated aggregates used and privacy parameters associated with the federated aggregates.
S180. The apparatus of claim S171, wherein the apparatus records federated aggregate usage events in an audit log without recording raw tenant contributions.

... [S181–S360 intentionally omitted for brevity] ...

## CONTINUATION MOAT CLUSTERS (Independent Claims)

### Moat Cluster A: Jurisdiction & Geofence (S360.1)
S360.1 A simulation apparatus for multi-jurisdictional governance of AI defense actions, comprising:
- a memory and one or more processors configured to:
  - associate candidate defense actions with jurisdiction tags derived from at least one of target audience location, channel availability region, or applicable legal scope;
  - enforce geofence rules that restrict outputting external publishing actions to those permitted in jurisdictions supported by an execution connector;
  - evaluate jurisdiction-specific constraints based on the jurisdiction tags and deny outputting an external publishing action when a required constraint set is unavailable or when a geofence rule violation is detected; and
  - record a geofence violation event in an audit log linked to a policy bundle hash and a connector identifier.

### Moat Cluster B: Forecasting & Drift (S360.2)
S360.2 A simulation apparatus for evidence-backed forecasting and drift detection, comprising:
- a memory and one or more processors configured to:
  - compute forecast trajectories for narrative states using evidence-weighted inputs derived from lineage manifests and source reliability scores;
  - output a forecast explanation artifact identifying input features and forecast evidence weights contributing to a forecast;
  - detect a forecast drift event when observed outcomes deviate from predicted trajectories beyond a threshold; and
  - exclude external publishing actions from ranking when forecast drift events exceed a threshold frequency within a rolling time window.

### Moat Cluster C: Partner Overlay & Brand Safety (S360.3)
S360.3 A simulation apparatus for multi-party policy enforcement in ranking, comprising:
- a memory and one or more processors configured to:
  - apply partner overlay policy bundles representing contractual or brand safety constraints for at least one channel, platform, or partner, wherein the partner overlay policy bundles are restrictive-only and cannot increase permissions relative to governance policies;
  - compute an effective policy decision by combining governance policies with partner overlay policy bundles;
  - deny outputting an external publishing action when a partner overlay policy bundle conflicts with governance policies and a conflict resolution rule is not satisfied; and
  - record partner overlay hashes and partner identifiers in a replay manifest for each ranked external publishing action.

## Cluster 6: Jurisdiction/time-zone-aware constraints + geofenced ranking/output (S361–S370)

S361. The apparatus of claim S1, wherein candidate defense actions include jurisdiction tags derived from at least one of target audience location, channel availability region, or applicable legal scope.
S362. The apparatus of claim S361, wherein the policy engine evaluates jurisdiction-specific constraints based on the jurisdiction tags and denies outputting an external publishing action when a required constraint set is unavailable.
S363. The apparatus of claim S361, wherein the apparatus applies time-zone-aware deployment windows by converting a requested deployment time window into one or more local time windows per jurisdiction tag.
S364. The apparatus of claim S1, wherein the apparatus enforces geofence rules that restrict outputting external publishing actions to those permitted in jurisdictions supported by an execution connector.
S365. The apparatus of claim S364, wherein the apparatus excludes from ranking any external publishing action that would publish outside a permitted jurisdiction and records a geofence violation event.
S366. The apparatus of claim S364, wherein geofence rules are stored as machine-readable policies referenced by geofence rule identifiers and versions.
S367. The apparatus of claim S365, wherein the apparatus records the geofence violation event in an audit log linked to a policy bundle hash and connector identifier.
S368. The apparatus of claim S361, wherein the apparatus requires approval for actions spanning more than a threshold number of jurisdictions and records the requirement in a replay manifest.
S369. The apparatus of claim S361, wherein the apparatus outputs monitoring-only actions when jurisdiction tags are ambiguous or below a confidence threshold.
S370. The apparatus of claim S361, wherein the apparatus outputs a jurisdiction rationale artifact describing how jurisdiction tags were derived, excluding never-log fields.

## Cluster 7: Evidence-weighted forecasting + forecast drift in simulation (S371–S380)

S371. The apparatus of claim S1, wherein the apparatus computes forecast trajectories for narrative states using evidence-weighted inputs derived from lineage manifests and source reliability scores.
S372. The apparatus of claim S371, wherein forecast evidence weights increase for sources having verified provenance status and decrease for sources having unknown provenance status.
S373. The apparatus of claim S371, wherein the apparatus computes a forecast confidence score and includes the forecast confidence score in ranking explanations.
S374. The apparatus of claim S371, wherein the apparatus detects a forecast drift event when observed outcomes deviate from predicted trajectories beyond a threshold.
S375. The apparatus of claim S374, wherein the apparatus records the forecast drift event as a drift artifact linked to a snapshot hash and a forecast model version identifier.
S376. The apparatus of claim S374, wherein the apparatus excludes external publishing actions from ranking when forecast drift events exceed a threshold frequency within a rolling time window.
S377. The apparatus of claim S371, wherein the apparatus performs backtesting of forecast trajectories on historical snapshots and records backtesting results as evidence artifacts.
S378. The apparatus of claim S371, wherein the apparatus calibrates forecast parameters using observed outcomes only when a data quality policy indicates sufficient reliability.
S379. The apparatus of claim S371, wherein the apparatus outputs a forecast explanation artifact identifying input features and forecast evidence weights contributing to a forecast, excluding never-log fields.
S380. The apparatus of claim S371, wherein the replay manifest includes forecast model version identifiers and identifiers of forecast explanation artifacts used in ranking.

## Cluster 8: Partner policy overlays + brand safety constraints in ranking (S381–S390)

S381. The apparatus of claim S1, wherein the apparatus applies partner overlay policy bundles representing contractual or brand safety constraints for at least one channel, platform, or partner.
S382. The apparatus of claim S381, wherein partner overlay policy bundles are stored as versioned partner policy bundles each having a partner overlay hash.
S383. The apparatus of claim S382, wherein the apparatus computes an effective policy bundle hash by combining a governance policy bundle hash with a partner overlay hash for a given channel.
S384. The apparatus of claim S381, wherein the policy engine denies outputting an external publishing action when a partner overlay policy bundle conflicts with governance policies and a conflict resolution rule is not satisfied.
S385. The apparatus of claim S381, wherein partner overlay policy bundles are restrictive-only and cannot increase permissions relative to governance policies.
S386. The apparatus of claim S381, wherein the replay manifest includes partner overlay hashes and partner identifiers for each ranked external publishing action.
S387. The apparatus of claim S381, wherein the apparatus enforces brand safety constraints that restrict references to protected topics or sensitive categories in candidate defense actions.
S388. The apparatus of claim S387, wherein the policy engine modifies a candidate defense action by redacting or rewriting content to satisfy brand safety constraints and the apparatus re-simulates modified actions.
S389. The apparatus of claim S381, wherein the apparatus denies outputting an external publishing action when a required partner overlay policy bundle is unavailable or not attested.
S390. The apparatus of claim S381, wherein the apparatus generates a partner compliance report comprising counts of allowed, denied, and modified actions under partner overlay policy bundles.

---

## CONVERGENCE PROTOCOL

1. **Geofence is a hard constraint:** violations deny; log the geofence rule ID.
2. **Forecast drift is conservative:** drift triggers monitoring-only and/or requires re-calibration approval.
3. **Partner overlays only restrict:** never expand permissions; conflicts default deny.
4. **Audit binding:** record jurisdiction tags, forecast drift events, partner overlay hashes with snapshot hash + policy bundle hash.

---

## CI VERIFIER SPEC

### Geofence Tests
- **forbidden jurisdiction** → deny; log geofence rule IDs.
- **permitted jurisdiction** → allow; log geofence rule IDs.

### Forecast Drift Tests
- **drift detected** → triggers monitoring-only mode; log drift artifact.
- **no drift** → allow simulation output (subject to other policies).

### Partner Overlay Tests
- **overlay conflict** → deny; log conflict resolution failure.
- **overlay permission expansion** → block (overlays never increase permissions).
- **valid overlay** → allow; log partner overlay hashes.
