# MVP‑3 Production Grade — Go‑Live & Validation Pack

---

## 0) Pre‑flight (15 min)

- [ ] Branch: `feature/mvp3-autopilot` merged → `main`
- [ ] SemVer: bump to **v3.0.0** (breaking architectural additions)
- [ ] ENV: `REDIS_URL`, `TEMPO_ENDPOINT`, `SLACK_WEBHOOK_URL`, `PAGERDUTY_ROUTING_KEY` verified in prod secrets
- [ ] Feature flags: `LEARNER_ENABLED=true`, `TRAFFIC_SPLIT=0.05`, `CHAOS_IN_CI=true`, `EVIDENCE_BUNDLES=true`

---

## 1) Acceptance 1 — Learner Promotion (≥10% utility × 2 days, no SLO breach)

**Commands**

```bash
just learner-metrics   # prints IPS/DR report with utility deltas by task/model
just learner-promote --dry-run
```

**Evidence**

- Report shows challenger utility ≥10% vs. champion on **two consecutive 24h windows**
- `runs/learner-metrics.jsonl` contains `promotion_candidate=true`
- No active alerts for p95/error during windows
- `git log` shows auto‑PR merged updating policy weights

---

## 2) Acceptance 2 — Quotas & Live Caps (Redis ETA + Model Matrix ETAs)

**Commands**

```bash
just quotas-matrix      # dumps per‑provider caps, remaining, ETA
redis-cli keys quota:*  # ensure rolling buckets exist (minute/day/week)
```

**UI**

- Model Matrix shows **ETA** clocks for Perplexity/Venice/Grok/DeepSeek
- Reconciler logs: `policy_vs_observed=diff` followed by `runtime_cap_adjustment`

---

## 3) Acceptance 3 — Window+Budget Maximizer (≥90% utilization, ≥30% overflow reduction)

**Commands**

```bash
just scheduler-plan --horizon 12h --dry-run
just scheduler-report --baseline last_week --compare this_week
```

**Evidence**

- Utilization ≥90% across OpenAI(3h)/Anthropic(5h)/Gemini(daily)
- Off‑window overflow reduction ≥30% vs. baseline

---

## 4) Acceptance 4 — OTEL + Tempo (95% trace coverage + decision context)

**Checks**

- Tempo search for `service="symphony-proxy"` over 1h: **coverage ≥95%**
- Random SLO alert in Alertmanager contains **trace link**
- Span attributes include: `symphony.decision_id`, `policy_version`, `quota_remaining`, `overrides`

---

## 5) Acceptance 5 — k6 + Chaos CI Gates + Evidence Bundles

**Commands**

```bash
just perf-run           # runs tests/k6/route_execute.js locally
just chaos-run          # triggers provider 429/5xx/slow TTFB scenarios
just mvp3-validate      # aggregates gates and prints PASS/FAIL table
```

**Evidence**

- CI artifacts: p95 under SLO thresholds; chaos scenarios PASS
- GH/Jira tickets auto‑opened with **evidence bundle** attachments:
  - WARC/HTML snapshot + Readability text
  - SHA‑256 hashes + timestamps
  - Decision metadata (decision_id, quota snapshot, rate‑limit headers, token/cost)
  - Trace ID/link; redacted I/O excerpts; provenance manifest (JSON)

---

## 6) Acceptance 6 — Design System Unified (tokens + a11y ≥95 + visual reg)

**Commands**

```bash
just tokens-build       # regenerates MUI theme + Tailwind from tokens.json
just a11y-audit         # Lighthouse CI; target ≥95 on console views
just visual-baseline    # Playwright snapshot/update with approval workflow
```

**Evidence**

- Tokens drive both MUI & shadcn
- Lighthouse ≥95 on /console and primary panels
- Playwright diffs require explicit approval in PR

---

## 7) Release Checklist (Go/No‑Go)

- [ ] All 6 acceptance sections show PASS with artifacts attached
- [ ] PagerDuty maintenance window ended; no new SLO alerts
- [ ] `CHANGELOG.md` updated; `SESSION_SUMMARY.md` linked
- [ ] Tag `v3.0.0` pushed and GitHub Release drafted with artifacts

---

## 8) Rollback Plan (5 min)

- `LEARNER_ENABLED=false` (env) → redeploy
- Set `TRAFFIC_SPLIT=0` (champion‑only)
- Disable Scheduler (`SCHEDULER_ENABLED=false`)
- Revert to previous policy tag (PR auto‑generated by promotion pipeline)

---

## 9) Post‑Launch (72h)

- Hourly: check learner uplift and SLO dashboard
- Daily: run `just scheduler-report` vs. baseline
- Incident drill: run `just chaos-run` in staging and verify ticket with bundle
- Design tokens: monitor visual diffs on any console PR

---

## 10) Appendices

- **Evidence Bundle Spec** — fields & redaction rules
- **Policy Diff Template** — human‑readable before/after with rationale
- **Tempo Query Snippets** — saved searches for decision/span correlation
