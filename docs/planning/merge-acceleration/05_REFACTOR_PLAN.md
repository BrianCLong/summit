# Tech-Debt Hygiene & Refactor Plan

**Generated by Jules | Date: 2025-05-20 (Simulated)**

## Top 10 Architectural Liabilities

| Priority | Liability | Description | Risk | Remediation |
| :--- | :--- | :--- | :--- | :--- |
| **P0** | **Duplicate Frontends** | `client/` vs `apps/web` split resources and confuses build. | High | **Kill `client/`.** Migrate critical views to `apps/web`. |
| **P0** | **Duplicate Backends** | `apps/server` exists alongside `server/`. | Medium | **Delete `apps/server`.** |
| **P1** | **Server Root Pollution** | 10+ feature folders at `server/` root. | Medium | **Move to `server/src/modules/`.** |
| **P1** | **Lockfile Drift** | `package-lock.json` & `pnpm-lock.yaml` coexist. | High | **Force `pnpm`.** Add `.npmrc` to ban npm. |
| **P2** | **Zod Version Skew** | Frontend on v4 (beta?), Backend mixed. | Med | **Pin Zod v3.22** (Stable) across repo unless v4 is mandated. |
| **P2** | **Tailwind v4** | `apps/web` uses v4 (new). `client/` uses v3. | Low | **Standardize on v4** if stable, or rollback to v3. |
| **P3** | **Python Isolation** | Python scripts called via `python-shell` from Node. | Med | **Containerize Python services** and use HTTP/gRPC instead of shell exec. |
| **P3** | **Test Runner Split** | Jest (Server) vs Vitest (Client). | Low | Acceptable, but ensure `npm test` runs both. |
| **P4** | **Config Sprawl** | `tsconfig` files are everywhere and inconsistent. | Low | Create a `packages/tsconfig` base. |
| **P5** | **Dead Code** | `ab/`, `degrade/` folders might be unused. | Low | Audit and delete. |

---

## Sequencing (The "Refactor Train")

### Phase 1: The Cleanup (Week 1)
*   Delete `apps/server`.
*   Delete `package-lock.json` everywhere.
*   Enforce `pnpm install`.

### Phase 2: The Unification (Week 2-3)
*   Analyze `client/` vs `apps/web`.
*   Port 1-2 key screens.
*   Mark `client/` as deprecated.

### Phase 3: The Restructure (Week 4)
*   Create `server/src/modules/`.
*   Move `server/billing`, `server/ai`, etc. into it.
*   Fix import paths.
