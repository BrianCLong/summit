# Runbook: CVE-2026-25145 Melange Remediation

## Alert: SBOM Gate Failure

### Symptoms
*   CI job `SBOM & Vulnerability Gate` fails.
*   Error message: "Blocked: melange <VERSION> vulnerable to CVE-2026-25145".
*   Error message: "Config Lint Failed: Found restricted patterns in license-path".

### Diagnosis

#### Version Gate Failure
1.  Check the logs for the detected melange version.
2.  If version < 0.40.3, the environment needs updating.
3.  **Action:** Update the builder image or toolchain installation to use melange >= 0.40.3.

#### Config Lint Failure
1.  Identify the failing configuration file from logs.
2.  Look for `license-path` entries containing `..` or absolute paths.
3.  **Action:** Remediate the config file to use relative paths within the workspace.

#### Containment Check Failure
1.  If the containment smoke test fails, it means the runtime environment is not properly restricted.
2.  **Action:** Investigate the container runtime options (mounts, user) for the SBOM step.

## Emergency Bypass
*   **Warning:** Bypassing this gate accepts the risk of arbitrary file read exfiltration.
*   To temporarily allow a build (e.g. for emergency fix deployment), you may set `SBOM_HARDENING_ENABLED=0` in repository secrets or environment, if implemented. (Note: Currently enforcement is hard-coded in scripts).

## Maintenance
*   Periodically verify that the `melange-version-gate.ts` script lists the correct vulnerable range if new advisories are published.
