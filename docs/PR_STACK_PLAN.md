# #15381 Risk & Verification Map

| Subsystem               | Files                                                                                                                                             | Primary Risks                                                                                   | Deterministic Validation                                                                                                                                   |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Redis query caching     | `server/src/services/queryResultCache.ts`, `server/src/services/QueryPreviewService.ts`, `server/src/services/__tests__/queryResultCache.test.ts` | Cross-tenant leakage, unbounded TTL, inability to disable during incidents                      | Jest unit tests cover tenant-scoped key construction, default TTL expiry, and incident-response disable flag (`pnpm test:resilience` or `pnpm test:unit`). |
| Partitioning automation | `server/scripts/partition-maintenance.ts`, `server/src/tests/partition-maintenance-plan.test.ts`                                                  | Non-idempotent runs, unbounded partition creation, operations on missing tables                 | Plan-mode JSON generation capped to 12 months and table-existence guard validated via Jest plan test (`pnpm test:resilience`).                             |
| DR restore verification | `scripts/backup-restore-validation.sh`, `server/src/tests/backup-restore-validation.test.ts`                                                      | Accidental production namespace targeting, restore cleanup failures, unverified artifact naming | Dry-run plan emits safe namespace and artifact names; Jest dry-run test asserts safety without cluster access (`pnpm test:resilience`).                    |

Run the verification subset locally with `pnpm test:resilience` to exercise all safeguards together.
