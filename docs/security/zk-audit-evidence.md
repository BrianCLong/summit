# ZK Audit Evidence Bundle

**Version:** 1.0
**Status:** DRAFT
**Scope:** Artifacts generated by a ZK Deconfliction Session

---

## 1. Evidence Principles
To prove "Non-Exfiltration," we must generate an audit trail that proves *what* was asked and *that* the protocol was followed, without recording the *data* itself.

## 2. The Bundle Structure (JSON)

Every ZK session produces a `zk_proof_bundle.json` stored in WORM storage (S3 Object Lock / Ledger).

```json
{
  "sessionId": "uuid-v4",
  "timestamp": "ISO-8601",
  "protocol": "ECDH-PSI-v1",
  "participants": {
    "initiator": "tenant-A-hash",
    "responder": "tenant-B-hash"
  },
  "intent": {
    "purpose": "Investigation-123",
    "policyId": "policy-coalition-alpha"
  },
  "parameters": {
    "curve": "secp256k1",
    "hashAlgo": "SHA-256",
    "setSizeInitiator": 150,
    "setSizeResponder": 4500
  },
  "commitments": {
    "initiatorSetHash": "sha256(sort(initiator_public_points))",
    "responderSetHash": "sha256(sort(responder_public_points))",
    "intersectionHash": "sha256(sort(intersection_result_indices))" // NOT values
  },
  "outcome": {
    "matchCount": 3,
    "status": "SUCCESS"
  },
  "signature": "system-signature-over-above-fields"
}
```

## 3. Explanation of Fields

*   **participants:** Hashed tenant IDs (or cleartext if internal policy allows) to identify who spoke to whom.
*   **commitments:** We do **not** log the points themselves (which could be brute-forced). We log a *hash of the set of points*. This proves that the set sent at time $T$ is the same set claimed later during a dispute, without revealing the set content.
*   **intersectionHash:** A commitment to the *result*. If Alice claims "I found 5 matches" but the log implies 3, this hash mismatch proves lying.

## 4. Verification Process
1.  **Dispute:** Tenant B suspects Tenant A is mining data.
2.  **Audit:** Auditor pulls `zk_proof_bundle.json`.
3.  **Check:**
    *   Was `setSizeInitiator` within policy limits?
    *   Does `matchCount` align with expected probability? (Statistical anomaly detection).
4.  **Deep Verify (Optional):** If Tenant A and B cooperate during an audit, they can reproduce the `initiatorSetHash` from their private logs to prove they didn't modify inputs.
