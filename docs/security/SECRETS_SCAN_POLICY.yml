schema_version: "1"
scan:
  include_globs:
    - "**/*"
  exclude_globs:
    - "node_modules/**"
    - "dist/**"
    - ".git/**"
    - "artifacts/**/cache/**"
  max_file_size_bytes: 2000000
rules:
  - id: "github_pat"
    description: "GitHub PAT"
    pattern: "(github_pat_[A-Za-z0-9_]+)"
    severity: "high"
  - id: "ghp"
    pattern: "(ghp_[A-Za-z0-9]{30,})"
    severity: "high"
  - id: "aws_access_key"
    pattern: "(AKIA[0-9A-Z]{16})"
    severity: "high"
  - id: "private_key_block"
    pattern: "-----BEGIN (RSA |EC |OPENSSH |PGP )?PRIVATE KEY-----"
    severity: "critical"
  - id: "generic_jwt"
    pattern: "eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+"
    severity: "medium"
allowlist:
  - id: "example-fixture"
    rule_id: "generic_jwt"
    path: "server/tests/fixtures/**"
    match_hash: "<sha256 of exact matched string>"
    expires: "2026-03-01"
    rationale: "Test fixture; not live secret."
output:
  out_dir: "artifacts/governance/secrets-scan/${sha}"
