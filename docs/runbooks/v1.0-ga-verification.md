# v1.0 GA Verification Runbook

## Zero-Trust mTLS + Identity

- Enable Istio mTLS:
  - `helm upgrade -n maestro charts/maestro -f charts/maestro/values-staging.yaml`
- Verify:
  - mTLS % panel green in Grafana (dashboard UID `mtls-overview`).
  - Intentionally curl a service without sidecar or SPIFFE -> request denied.

## Policy Supply Chain + Tests

- CI gates:
  - `policy-bundle-sign` must pass; OPA tests required for policy changes.
  - `helm-conftest` must pass (STRICT mTLS, ISTIO_MUTUAL, Rollout, signed annotation).
- Runtime gate:
  - Ensure `ALLOW_UNSIGNED_POLICY=false`; load unsigned bundle -> rejected.

## Blue/Green Rollouts

- Enable rollouts:
  - `helm upgrade -n maestro charts/maestro --set argoRollouts.enabled=true`
- Deploy via CD; promotion step runs `tools/ci/slo_gate.js`.
- Force SLO breach -> rollout auto-rollback; Healthy path = zero downtime.

## Immutable Audit + WORM

- Bucket:
  - `tools/s3/enable_object_lock.sh <bucket>` (one-time).
- App env:
  - Set `AUDIT_WORM_ENABLED=true`, `AUDIT_WORM_BUCKET`, `AUDIT_RETENTION_DAYS`.
- Verify:
  - Attempt to mutate locked object -> denied.
  - `GET /api/compliance/export/signed` returns pack + Merkle; verify cosign if available.

## HA + DR (Postgres + Object Store)

- Enable WAL-G:
  - `helm upgrade -n db charts/backup -f charts/backup/values-staging.yaml`
- Drill:
  - Run `drill-restore` workflow or `tools/db/pitr.sh` with `ISO_TS`.
  - Confirm restore to requested timestamp.

## SSO/SCIM + Least-Privilege RBAC

- Gateway deploy:
  - `helm upgrade -n gateway charts/gateway -f charts/gateway/values-staging.yaml`
  - Provide `oidc` and `scim` secrets.
- Verify:
  - SCIM sync job populates groups -> roles; change in IdP propagates <5m.
  - `requireReason` middleware prompts (403) without `x-rfa` for restricted labels.

## Compliance Dashboard & Controls

- UI:
  - Place `ComplianceBoard` in operator page.
- Verify:
  - `/api/compliance/controls` returns controls; export JSON/PDF works.

---

All checks green â†’ tag release and promote to production.
