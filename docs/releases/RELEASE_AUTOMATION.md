# Release Automation (MVP-4+)

This guide describes the deterministic one-command release workflow.

## How to cut a release

### Dry run (no repo mutations)

```bash
pnpm ga:verify
pnpm release:cut --bump patch --dry-run
```

### Real release

```bash
pnpm ga:verify
pnpm release:cut --bump patch
```

## Required inputs

- GA verification stamp is required (generated by `pnpm ga:verify`).
- Clean working tree (or pass `--force`).

## Dry run mode

`--dry-run` writes outputs to `artifacts/release/<tag>/` without modifying files, committing, or tagging.

## Git range selection

- Default: last semver tag (`vX.Y.Z` or `vX.Y.Z-rc.N`) to `HEAD`.
- Override: `--notes-from <git range>`.

## RC vs GA

- GA tag: `vX.Y.Z`
- RC tag: `vX.Y.Z-rc.N` (use `--version` to set explicitly)

Example:

```bash
pnpm release:cut --version 4.1.1-rc.1 --skip-gh-release
```

## Outputs

- Release notes: `docs/releases/<RELEASELINE>_RELEASE_NOTES.md`
- Evidence pack: `docs/releases/<RELEASELINE>_EVIDENCE_PACK.md`
- GitHub release payload: `artifacts/release/<tag>/github_release.md`

## Recovery

If a tag or commit was created in error:

```bash
git tag -d <tag>
git push origin :refs/tags/<tag>
git revert HEAD
```

Use `git revert` to keep history intact while undoing the release commit.
