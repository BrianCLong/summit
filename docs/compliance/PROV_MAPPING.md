# Provenance Mapping (Summit -> PROV)

This document defines the canonical mapping between Summit's internal data model and the W3C PROV-DM standard.

## 1. Core Mappings

| Summit Entity | PROV Entity | Description |
| :--- | :--- | :--- |
| **User** | **prov:Agent** | A human user who initiates an action. |
| **Service** | **prov:Agent** | A software service or system component. |
| **Agent (AI)** | **prov:Agent** | An AI agent acting on behalf of a user or system. |
| **Policy** | **prov:Agent** | A policy definition acting as a controlling agent. |
| **Job / Run** | **prov:Activity** | A process that generates or uses entities. |
| **Dataset** | **prov:Entity** | A data artifact. |
| **Model** | **prov:Entity** | A machine learning model artifact. |
| **Evidence Bundle** | **prov:Entity** | A collection of evidence. |
| **Governance Verdict** | **prov:Entity** | The result of a governance check. |

## 2. Relationships

| Summit Relationship | PROV Relationship | Description |
| :--- | :--- | :--- |
| **Dataset produced by Job** | **prov:wasGeneratedBy** | Entity generated by Activity. |
| **Job used Dataset** | **prov:used** | Activity used Entity. |
| **Job executed by Agent** | **prov:wasAssociatedWith** | Activity associated with Agent. |
| **Dataset owned by User** | **prov:wasAttributedTo** | Entity attributed to Agent. |
| **Dataset derived from Dataset** | **prov:wasDerivedFrom** | Entity derived from Entity. |

## 3. Implementation

The `@intelgraph/provenance-exporter` package provides a deterministic `ProvExporter` class to generate PROV-JSON documents adhering to this mapping.

### Example Usage

```typescript
import { ProvExporter } from "@intelgraph/provenance-exporter";

const exporter = new ProvExporter();

// Define entities
exporter.addEntity("dataset:123", { "summit:type": "Dataset", "summit:owner": "user:456" });
exporter.addAgent("user:456", { "prov:type": "Person" });

// Define activity
exporter.addActivity("job:789", new Date("2023-10-27T10:00:00Z"), new Date("2023-10-27T10:05:00Z"));

// Link them
exporter.addWasAttributedTo("dataset:123", "user:456");
exporter.addWasGeneratedBy("dataset:123", "job:789");

console.log(JSON.stringify(exporter.getJson(), null, 2));
```
