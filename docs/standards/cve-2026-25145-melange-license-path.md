# Standard: CVE-2026-25145 Mitigation (Melange Path Traversal)

## Overview
This standard defines the requirements to mitigate CVE-2026-25145, a path traversal vulnerability in Chainguard melange that allows arbitrary file read via the `license-path` field.

## Requirements

### 1. Tool Versioning
*   **Requirement:** All instances of `melange` used in Summit pipelines MUST be version **0.40.3** or higher.
*   **Enforcement:** CI Version Gate (`sbom:melange-version-gate`).
*   **Evidence:** `gate.json` containing tool version and verification status.

### 2. Configuration Safety
*   **Requirement:** Melange configuration files used in pipelines MUST NOT contain `license-path` values that:
    *   Are absolute paths.
    *   Contain traversal sequences (`..`).
    *   Resolve to paths outside the workspace root.
*   **Enforcement:** CI Config Lint (`sbom:config-lint`).

### 3. Untrusted Input Handling
*   **Requirement:** SBOM generation triggered by untrusted inputs (e.g., PRs from forks) MUST NOT publish or sign artifacts.
*   **Requirement:** `license-path` resolution should be restricted or disabled in untrusted contexts.

### 4. Containment
*   **Requirement:** SBOM generation steps should run in a contained environment (e.g., containerized with limited mounts) to minimize the impact of any potential file read vulnerabilities.

## References
*   [CVE-2026-25145 GitHub Advisory](https://github.com/advisories/GHSA-2w4f-9fgg-q2v9)
