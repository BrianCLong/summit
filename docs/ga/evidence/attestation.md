# Evidence: Deterministic Build Attestation

**ID:** `EV_ATTESTATION_V1_<sha>`

## 1. Description
This evidence proves that a build for a specific Git SHA was generated from a known set of inputs (source code and dependencies) and that the resulting artifacts match the expected manifest. It ensures the supply chain integrity of the Summit platform.

## 2. Mechanics
The attestation is generated by a CI script that:
1.  Enumerates all tracked files using `git ls-files`.
2.  Filters for relevant source directories and dependency lockfiles.
3.  Computes SHA256 digests for each file.
4.  Creates a manifest of `(path, digest)` pairs.
5.  Computes a master manifest hash over the sorted manifest content.
6.  Emits a JSON payload containing the master hash and toolchain versions (Node, pnpm).

## 3. Determinism
To satisfy Summit's strict GA readiness requirements, the `attestation.json` artifact is **100% deterministic**.
- No timestamps are included in the primary payload.
- File enumeration is sorted.
- Toolchain versions are pinned in CI.

## 4. Verification
Verification is performed by re-running the same hashing logic in a clean room environment and asserting that the resulting manifest hash matches the one in the attestation.

## 5. Artifacts
Every mainline build produces an evidence folder containing:
- `attestation.json`: The deterministic payload.
- `report.json`: Validation status and artifact list.
- `metrics.json`: Counts of files hashed and manifest digests.
- `stamp.json`: Evidence ID and toolchain metadata (using deterministic commit time).

## 6. Acceptance Criteria
- [ ] `attestation.json` exists for the target SHA.
- [ ] Manifest SHA256 in `attestation.json` matches the recomputed value.
- [ ] No non-deterministic fields (timestamps) are present in `attestation.json`.
- [ ] Evidence is published to the artifacts bucket or GitHub artifacts.
