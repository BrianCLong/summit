# Media Authenticity & Provenance (Governance Module)

**Summit Readiness Assertion:** This control is asserted as mandatory under the Summit Readiness Assertion and therefore inherits the governance authority chain defined in `docs/SUMMIT_READINESS_ASSERTION.md`. The present state is enforceable and future work is explicitly sequenced.

## Policy Statement

Summit treats media authenticity as a governed control surface. AI detectors are not authoritative. **Media authenticity must be established through provenance signals and deterministic evidence artifacts.** Any asset intended for public, marketing, or trust-facing use is invalid without an evidence bundle generated by the Summit media provenance tooling.

## Threat Model

**Primary threats**:

- AI-generated or tampered media being presented as real without provenance signals.
- Watermarks stripped or bypassed, creating false confidence in authenticity.
- Non-deterministic evidence outputs that cannot be audited or reproduced.

**Adversary assumptions**:

- Attackers can remove visible watermarks.
- Attackers can fabricate plausible metadata without cryptographic provenance.

**Impact**:

- Loss of trust, auditability gaps, and regulatory exposure.

## Controls (Media Provenance)

**Control ID: AUD-003 — Media Authenticity & Provenance**

1. **Evidence-First Requirement**: Every marketing/public media asset must include a deterministic evidence bundle: `report.json`, `metrics.json`, and `stamp.json`.
2. **Deterministic Outputs**: `report.json` and `metrics.json` must be stable across runs; timestamps are only allowed in `stamp.json`.
3. **C2PA Detection (v0)**: C2PA/Content Credentials signals are **detected and recorded**. Cryptographic verification is **Intentionally constrained** until v1 validation is implemented. This detection-only stage is a **Governed Exception**.
4. **No Detector Reliance**: AI detection heuristics are insufficient and cannot override provenance evidence.

## Required Metadata Fields

Each `report.json` must contain, at minimum:

- `media.sha256` (content hash)
- `media.sizeBytes`
- `media.mime`
- `media.container`
- `media.codec` (or `null` when unknown)
- `provenance.c2pa.present`
- `provenance.c2pa.status` (`absent` or `unverified`)

Each `metrics.json` must contain, at minimum:

- `counts.files`
- `counts.c2paPresent`
- `counts.c2paUnverified`

Each `stamp.json` must contain, at minimum:

- `generatedAt`
- `fileTimestamps.mtimeMs`
- `fileTimestamps.ctimeMs`

## Acceptance Criteria

- Evidence bundle exists at the deterministic path for every marketing/public media asset.
- `report.json` and `metrics.json` are timestamp-free and stable across runs.
- `report.json` hash matches the media file’s SHA-256.
- C2PA signals are recorded as `unverified` until cryptographic verification is implemented.
- Assets without evidence bundles are rejected from release and marketing surfaces.

## Evidence Structure (Deterministic)

For any media asset located at `<repo-relative-path>`, the evidence bundle **must** exist at:

```
evidence/media/<repo-relative-path>/report.json
evidence/media/<repo-relative-path>/metrics.json
evidence/media/<repo-relative-path>/stamp.json
```

Example for `public/marketing/hero.mp4`:

```
evidence/media/public/marketing/hero.mp4/report.json
evidence/media/public/marketing/hero.mp4/metrics.json
evidence/media/public/marketing/hero.mp4/stamp.json
```

## Covered Asset Paths

The CI gate enforces media provenance for the following asset roots:

- `public/`
- `apps/web/public/`
- `client/public/`
- `web/public/`
- `website/public/`
- `docs/marketing/`
- `website/src/app/(marketing)/`

## Review Checklist

- [ ] Evidence bundle exists for every new/changed marketing/public media asset.
- [ ] `report.json` and `metrics.json` contain no timestamps.
- [ ] `report.json` `sha256` matches the asset hash.
- [ ] C2PA signals are recorded as **unverified** unless cryptographic verification is implemented.
- [ ] The asset is rejected if provenance is missing or mismatched.

## CLI Usage

Generate evidence for a media asset:

```
summit media verify <path>
summit media attest <path>
```

Both commands emit `report.json`, `metrics.json`, and `stamp.json` into the deterministic evidence directory.

## CI Enforcement

The media provenance gate (`scripts/ci/verify_media_provenance.ts`) blocks PRs that modify marketing/public media assets without a matching evidence bundle.

## Follow-on Work (v1 Cryptographic Verification)

- **Deferred pending C2PA cryptographic verification**: verify signature chain, certificate trust anchors, and claim hashes.
- **Deterministic verification receipts**: include cryptographic verification proofs in evidence bundles.
- **Policy-as-code integration**: enforce C2PA verification results via OPA policy checks.
