{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "FactCert Credential",
  "type": "object",
  "required": [
    "id",
    "type",
    "issuer",
    "holder",
    "policy",
    "validity",
    "status",
    "public_keys",
    "issued_at"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^CERT_[A-Z0-9]+$",
      "description": "Unique identifier for the credential."
    },
    "type": {
      "type": "string",
      "const": "FactCertCredentialV1"
    },
    "issuer": {
      "type": "string",
      "description": "The entity issuing the credential."
    },
    "holder": {
      "type": "object",
      "required": ["id", "role"],
      "properties": {
        "id": {"type": "string"},
        "role": {"type": "string"},
        "attributes": {"type": "object"}
      }
    },
    "policy": {
      "type": "object",
      "required": ["id", "version", "uri"],
      "properties": {
        "id": {"type": "string"},
        "version": {"type": "string"},
        "uri": {"type": "string"}
      }
    },
    "validity": {
      "type": "object",
      "required": ["not_before", "not_after"],
      "properties": {
        "not_before": {"type": "string", "format": "date-time"},
        "not_after": {"type": "string", "format": "date-time"}
      }
    },
    "status": {
      "type": "string",
      "enum": ["active", "suspended", "revoked"],
      "default": "active"
    },
    "public_keys": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["kid", "type", "publicKeyHex"],
        "properties": {
          "kid": {"type": "string"},
          "type": {"type": "string", "const": "ed25519"},
          "publicKeyHex": {"type": "string", "pattern": "^[0-9a-fA-F]{64}$"}
        }
      }
    },
    "issued_at": {
      "type": "string",
      "format": "date-time"
    },
    "signature": {
      "type": "string",
      "description": "Hex-encoded Ed25519 signature of the stable JSON representation of the credential (excluding the signature field)."
    }
  }
}
