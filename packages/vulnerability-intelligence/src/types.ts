/**
 * CVSS Severity
 */
export enum CVSSSeverity {
  NONE = 'none',
  LOW = 'low',
  MEDIUM = 'medium',
  HIGH = 'high',
  CRITICAL = 'critical'
}

/**
 * Exploit Availability
 */
export enum ExploitAvailability {
  NOT_AVAILABLE = 'not-available',
  POC_AVAILABLE = 'poc-available',
  FUNCTIONAL_EXPLOIT = 'functional-exploit',
  WEAPONIZED = 'weaponized',
  IN_THE_WILD = 'in-the-wild'
}

/**
 * CVE Entry
 */
export interface CVE {
  id: string;
  description: string;
  publishedDate: Date;
  modifiedDate: Date;
  cvssV3Score?: number;
  cvssV3Vector?: string;
  severity: CVSSSeverity;
  cwe?: string[];
  references?: string[];
  affectedProducts?: Array<{
    vendor: string;
    product: string;
    versions: string[];
  }>;
}

/**
 * Vulnerability
 */
export interface Vulnerability {
  id: string;
  cveId?: string;
  title: string;
  description: string;
  severity: CVSSSeverity;
  cvssScore: number;
  cvssVector?: string;
  exploitAvailability: ExploitAvailability;
  affectedProducts: AffectedProduct[];
  references: VulnerabilityReference[];
  advisories: Advisory[];
  patches: Patch[];
  mitigations: Mitigation[];
  timeline: VulnerabilityTimeline;
  tags: string[];
  metadata: Record<string, unknown>;
  createdAt: Date;
  updatedAt: Date;
}

export interface AffectedProduct {
  vendor: string;
  product: string;
  versions: string[];
  cpe?: string;
  patchedVersions?: string[];
}

export interface VulnerabilityReference {
  type: 'advisory' | 'exploit' | 'patch' | 'article' | 'vendor';
  url: string;
  title: string;
}

export interface Advisory {
  id: string;
  source: string;
  url: string;
  publishedDate: Date;
  severity?: CVSSSeverity;
}

export interface Patch {
  id: string;
  product: string;
  version: string;
  releaseDate: Date;
  url?: string;
  notes?: string;
}

export interface Mitigation {
  type: 'workaround' | 'configuration' | 'detection';
  description: string;
  effectiveness: 'high' | 'medium' | 'low';
  complexity: 'high' | 'medium' | 'low';
}

export interface VulnerabilityTimeline {
  discoveredDate?: Date;
  disclosedDate?: Date;
  exploitPublishedDate?: Date;
  patchedDate?: Date;
  inTheWildDate?: Date;
}

/**
 * Exploit
 */
export interface Exploit {
  id: string;
  vulnerabilityId: string;
  name: string;
  description: string;
  type: 'poc' | 'functional' | 'weaponized';
  platform: string[];
  author?: string;
  source?: string;
  url?: string;
  reliability: 'high' | 'medium' | 'low';
  publishedDate: Date;
  lastUpdated: Date;
}

/**
 * Risk Assessment
 */
export interface VulnerabilityRiskAssessment {
  vulnerabilityId: string;
  baseScore: number;
  temporalScore: number;
  environmentalScore: number;
  overallRiskScore: number;
  exploitabilityScore: number;
  impactScore: number;
  factors: RiskFactor[];
  recommendations: string[];
  priority: 'critical' | 'high' | 'medium' | 'low';
  estimatedRemediation: number; // hours
}

export interface RiskFactor {
  name: string;
  weight: number;
  value: number;
  description: string;
}

/**
 * Vulnerability Intelligence Feed
 */
export interface VulnerabilityFeed {
  id: string;
  name: string;
  source: string;
  lastUpdated: Date;
  vulnerabilities: Vulnerability[];
  statistics: FeedStatistics;
}

export interface FeedStatistics {
  total: number;
  bySeverity: Record<CVSSSeverity, number>;
  byExploitAvailability: Record<ExploitAvailability, number>;
  newThisWeek: number;
  patchedThisWeek: number;
}

/**
 * Asset Vulnerability Mapping
 */
export interface AssetVulnerabilityMapping {
  assetId: string;
  assetName: string;
  vulnerabilities: AssetVulnerability[];
  overallRiskScore: number;
  lastScanned: Date;
}

export interface AssetVulnerability {
  vulnerabilityId: string;
  cveId?: string;
  severity: CVSSSeverity;
  status: 'open' | 'in-progress' | 'mitigated' | 'resolved' | 'accepted';
  firstDetected: Date;
  lastSeen: Date;
  remediation?: string;
}
