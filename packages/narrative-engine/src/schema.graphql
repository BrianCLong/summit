
type IdentityCluster {
  id: ID!
  name: String!
  values: [String!]!
  size: Float!
}

type NarrativeMarket {
  id: ID!
  topic: String!
  narrativeIds: [ID!]!
  audienceSegments: [IdentityCluster!]!
}

type NarrativeAlignment {
  narrativeId: ID!
  clusterId: ID!
  score: Float!
}

type MarketSnapshot {
  timestamp: Float!
  marketId: ID!
  narrativeShares: JSON! # Map<String, Float>
  clusterSaturation: JSON! # Map<String, Float>
}

scalar JSON

extend type Query {
  getMarketState(id: ID!): MarketSnapshot
  listMarkets: [NarrativeMarket!]!
}

extend type Mutation {
  simulateMarket(id: ID!, steps: Int!): MarketSnapshot!
  createMarket(topic: String!, narratives: [ID!]!, clusters: [ID!]!): NarrativeMarket!
  updateAlignment(narrativeId: ID!, clusterId: ID!, score: Float!): NarrativeAlignment!
}
