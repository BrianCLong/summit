apiVersion: batch/v1
kind: CronJob
metadata:
  name: { { include "mc-runner.fullname" . } }
spec:
  schedule: '{{ .Values.schedule }}'
  jobTemplate:
    spec:
      template:
        spec:
          serviceAccountName: { { include "mc-runner.serviceAccountName" . } }
          restartPolicy: OnFailure
          containers:
            - name: mc
              image: '{{ .Values.image.repository }}{{ if .Values.image.digest }}@{{ .Values.image.digest }}{{ else }}:{{ .Values.image.tag }}{{ end }}'
              imagePullPolicy: { { .Values.image.pullPolicy } }
              args: ['{{ .Values.planFile }}']
