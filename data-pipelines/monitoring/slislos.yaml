version: v1
service: intelgraph-data-pipelines
envs: [dev, stage, prod]

sli_definitions:
  - name: availability
    description: Pipeline uptime ratio over time window
    metric: pipeline_uptime_ratio
    labels: [source, pipeline, env]
    unit: ratio
    promql: |
      avg by (source, pipeline, env) (pipeline_uptime_ratio)

  - name: freshness
    description: Source-to-load freshness in seconds
    metric: pipeline_freshness_seconds
    labels: [source, pipeline, env]
    unit: seconds
    promql: |
      avg by (source, pipeline, env) (pipeline_freshness_seconds)

  - name: completeness
    description: Data completeness ratio (actual/expected)
    metric: pipeline_completeness_ratio
    labels: [source, pipeline, env]
    unit: ratio
    promql: |
      avg by (source, pipeline, env) (pipeline_completeness_ratio)

  - name: correctness
    description: Validation pass rate ratio
    metric: pipeline_correctness_ratio
    labels: [source, pipeline, env]
    unit: ratio
    promql: |
      avg by (source, pipeline, env) (pipeline_correctness_ratio)

  - name: latency
    description: End-to-end processing latency seconds
    metric: pipeline_latency_seconds
    labels: [source, pipeline, env]
    unit: seconds
    promql: |
      histogram_quantile(0.95, sum(rate(pipeline_latency_seconds_bucket[5m])) by (le, source, pipeline, env))

slo_targets:
  - sli: availability
    target: 0.995             # 99.5%
    window: 30d
  - sli: freshness
    target: 0.95              # 95% of batches
    objective: freshness < 300   # 5 minutes
    window: 7d
  - sli: completeness
    target: 0.99
    window: 7d
  - sli: correctness
    target: 0.995
    window: 30d
  - sli: latency
    objective: p95 < 120      # 2 minutes
    window: 7d

burn_rates:
  # Multi-window multi-burn alerts (fast + slow)
  - description: Fast burn (page on-call)
    windows:
      - 5m
      - 30m
    factor: 14
  - description: Slow burn (ticket)
    windows:
      - 2h
      - 6h
    factor: 2

