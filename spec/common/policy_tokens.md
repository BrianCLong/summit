# Policy Decision Tokens

**Purpose:** Bind data access and transformations to explicit policy decisions that can be audited
and validated downstream.

## Token Structure

```json
{
  "decision_id": "pdt_...",
  "subject": {
    "user_id": "usr_...",
    "roles": ["analyst"]
  },
  "purpose": "threat-intel-investigation",
  "effects": ["read", "export"],
  "constraints": {
    "egress_bytes": 500000,
    "retention_days": 30
  },
  "issued_at": "2025-12-30T23:59:00Z",
  "policy_version": "policy://v3.4.2",
  "signature": "sig_..."
}
```

## Required Checks

1. Validate signature and issuer.
2. Ensure purpose and effect align with requested action.
3. Enforce constraints before executing any export or egress.
4. Persist `decision_id` in witness chain entries.

## Policy-as-Code Guidance

- Policy decisions must be generated by policy engine rules (OPA or equivalent).
- Store decision logs in compliance ledger for review and audit.
