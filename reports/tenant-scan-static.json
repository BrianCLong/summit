[
  {
    "file": "autonomous/orchestrator.enhanced.ts",
    "line": 603,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM runs WHERE id = $1"
  },
  {
    "file": "autonomous/orchestrator.enhanced.ts",
    "line": 610,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "UPDATE runs SET status = $2, started_at = COALESCE(started_at, NOW()) WHERE id = $1"
  },
  {
    "file": "coherence/intelligence/activityFingerprintIndex.ts",
    "line": 665,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (af:ActivityFingerprint {fingerprint_id: $fingerprintId})               MERGE ("
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 292,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             SET m.current_phase = $phase, m."
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 304,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_OBJECTIVE]->(obj:Objective {objectiv"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 321,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_MILESTONE]->(ms:Milestone {milestone"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 338,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (m:Mission {mission_id: $missionId})-[:HAS_RISK]->(rf:RiskFactor {risk_id: $ris"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 354,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             SET m.metadata = $metadata, m.la"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 517,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (m:Mission {mission_id: $missionId})           MERGE (m)-[:INFORMED_BY]->(ci:Cohere"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 591,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (obj:Objective {objective_"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 608,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (sh:Stakeholder {stakehold"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 625,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (res:Resource {resource_id"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 642,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (ms:Milestone {milestone_i"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 659,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (rf:RiskFactor {risk_id: $"
  },
  {
    "file": "coherence/intelligence/missionVault.ts",
    "line": 676,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (m:Mission {mission_id: $missionId})             MERGE (sc:SuccessCriteria {crite"
  },
  {
    "file": "coherence/intelligence/narrativeImpactModel.ts",
    "line": 672,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (ni:NarrativeImpact {impact_id: $impactId})               MERGE (e:Entity {enti"
  },
  {
    "file": "config/database.ts",
    "line": 230,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "       CREATE TABLE IF NOT EXISTS user_sessions (         id UUID PRIMARY KEY DEFAULT gen_random_uui"
  },
  {
    "file": "db/compensationLog.ts",
    "line": 215,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})         SET ${setClause}, log.updatedAt = "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 239,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})         UNWIND $compensators AS comp      "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 275,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog {id: $correlationId})-[:HAS_COMPENSATOR]->(c:Compensator)       "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 348,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (n:${entityType} {id: $entityId})           DELETE n         "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 371,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (n:${entityType} {id: $entityId})           SET n = $originalProperties         "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 384,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH ()-[r:${compensationData.type} {id: $relationshipId}]->()           DELETE r       "
  },
  {
    "file": "db/compensationLog.ts",
    "line": 394,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (from {id: $fromId}), (to {id: $toId})           CREATE (from)-[r:${compensationDat"
  },
  {
    "file": "db/compensationLog.ts",
    "line": 463,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (log:CompensationLog)         ${whereClause}         OPTIONAL MATCH (log)-[:HAS_COMPE"
  },
  {
    "file": "db/migrations/neo4j/20250816_014619_add_canonical_id_to_entity.js",
    "line": 17,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       WHERE NOT EXISTS(e.canonicalId)       SET e.canonicalId = e.id     "
  },
  {
    "file": "db/migrations/neo4j/20250816_014619_add_canonical_id_to_entity.js",
    "line": 31,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       REMOVE e.canonicalId     "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 112,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "               MATCH (e:Entity {id: $id})               OPTIONAL MATCH (e)-[:FROM_SOURCE]->(s:Source"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 807,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                  UNWIND $evidenceIds as evidenceId             "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 817,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                  UNWIND $claimIds as claimId                  M"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 864,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim {id: $id})              SET c.claimType = $claimType,                  c.statement = "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 917,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence {id: $id})              SET e.title = $title,                  e.description = $de"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 975,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $id})              SET d.title = $title,                  d.description = $de"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1026,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                UNWIND $evidenceIds as evidenceId               "
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1036,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $decisionId})                UNWIND $claimIds as claimId                MATCH"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1079,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim {id: $id}) WHERE c.tenant = $tenant RETURN c"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1117,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence {id: $id}) WHERE e.tenant = $tenant RETURN e"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1169,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision {id: $id}) WHERE d.tenant = $tenant          OPTIONAL MATCH (d)-[:SUPPORTED_BY]->("
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1214,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Claim)          WHERE c.tenant = $tenant          AND (toLower(c.statement) CONTAINS toLowe"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1257,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Evidence)          WHERE e.tenant = $tenant          AND (toLower(e.title) CONTAINS toLower"
  },
  {
    "file": "graphql/intelgraph/resolvers.ts",
    "line": 1304,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (d:Decision)          WHERE d.tenant = $tenant          AND (toLower(d.title) CONTAINS toLower"
  },
  {
    "file": "graphql/loaders.ts",
    "line": 34,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (n) WHERE elementId(n) IN $ids OR n.id IN $ids             RETURN n             "
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 920,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[:EXTRACTED_FROM]->(m:MediaSource)           R"
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 939,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[:HAS_CROSS_MODAL_MATCH]->(c:CrossModalMatch) "
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 958,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:MultimodalEntity {id: $entityId})-[r:MultimodalRelationship]-(other:MultimodalEn"
  },
  {
    "file": "graphql/multimodalResolvers.ts",
    "line": 985,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (j:ExtractionJob {id: $jobId})-[:EXTRACTED]->(e:MultimodalEntity)           OPTIONA"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 107,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})${permClause}            MATCH (creator:User {id: e.createdBy})           "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 247,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity)-[r:RELATIONSHIP {id: $id}]->(to:Entity)${permClause}            RETURN r, from, "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 382,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (i:Investigation {id: $id})            MATCH (creator:User {id: i.createdBy})            OPTIO"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 520,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {investigationId: $investigationId}) RETURN e"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 525,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {investigationId: $investigationId})-[r:RELATIONSHIP]->(to:Entity {investigationI"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 604,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r]->(related:Entity)            RETURN related, type(r) as relatio"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 849,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) RETURN e.investigationId as invId"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 890,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 923,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            OPTIONAL MATCH (e)-[r:RELATIONSHIP]-()            DELETE r, e "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 979,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {id: $fromEntityId})            MATCH (to:Entity {id: $toEntityId})            CR"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1074,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {id: $fromEntityId})              MATCH (to:Entity {id: $toEntityId})            "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1194,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (:Entity)-[r:RELATIONSHIP {id: $id}]->(:Entity) RETURN r.investigationId as invId"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1239,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity)-[r:RELATIONSHIP {id: $id}]->(to:Entity)            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1285,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:Entity)-[r:RELATIONSHIP {id: $id}]-(b:Entity)            WITH a, b, r            DELETE r  "
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1418,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (i:Investigation {id: $id})            SET ${updateFields.join("
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1562,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r:RELATIONSHIP]-(other:Entity)            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1585,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (other:Entity)-[r:RELATIONSHIP]->(e:Entity {id: $entityId})            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1608,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[r:RELATIONSHIP]->(other:Entity)            RETURN r, other"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1642,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {investigationId: $investigationId}) RETURN e"
  },
  {
    "file": "graphql/resolvers/crudResolvers.ts",
    "line": 1660,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (from:Entity {investigationId: $investigationId})-[r:RELATIONSHIP]->(to:Entity {investigationI"
  },
  {
    "file": "graphql/resolvers/graphragResolvers.js",
    "line": 253,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) SET e.embedding = $embedding, e.embeddingModel = $model, e.embeddingGener"
  },
  {
    "file": "graphql/resolvers.ai.js",
    "line": 19,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity)        WHERE e.id IN $ids        OPTIONAL MATCH (e)-[:BELONGS_TO]->(i:Investigation"
  },
  {
    "file": "graphql/resolvers.ai.js",
    "line": 67,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})-[]-(n:Entity)            RETURN collect(distinct n.id) AS nbs"
  },
  {
    "file": "graphql/resolvers.ai.js",
    "line": 78,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (seed:Entity {id: $entityId})            MATCH (cand:Entity)-[]-(n:Entity)            WHERE ca"
  },
  {
    "file": "graphql/resolvers.ai.js",
    "line": 144,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "${whereInv}            OPTIONAL MATCH (e)-[r]-()            WITH e, count(r) AS deg            WITH "
  },
  {
    "file": "graphql/resolvers.ai.js",
    "line": 318,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})            CREATE (a:Annotation {              id: randomUUID(),   "
  },
  {
    "file": "graphql/resolvers.document.js",
    "line": 7,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (d:Document {id: $id})-[r:RELATED]->(other:Document)         RETURN r, other       "
  },
  {
    "file": "graphql/resolvers.document.js",
    "line": 31,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (c:DocumentCategory)-[:HAS_DOCUMENT]->(d:Document {id: $id})         RETURN c.name as"
  },
  {
    "file": "graphql/resolvers.er.ts",
    "line": 324,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (a:Entity) WHERE a.id = $entityA OR a.uuid = $entityA           MATCH (b:Entity) WH"
  },
  {
    "file": "lib/auth.ts",
    "line": 77,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, username, role FROM users WHERE id = $1"
  },
  {
    "file": "maestro/mcp/audit-api.ts",
    "line": 10,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, user_id, action, resource_type, resource_id, details, created_at        FROM audit_logs  "
  },
  {
    "file": "maestro/pipelines/pipelines-repo.ts",
    "line": 89,
    "type": "SQL",
    "message": "Query accessing 'pipelines' likely missing 'tenant_id' filter",
    "snippet": "UPDATE pipelines SET ${sets.join("
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 57,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE NOT EXISTS(n.policy_sensitivity)     SET n.policy_origin = $policy_origin, "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 87,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH ()-[r]->()     WHERE NOT EXISTS(r.policy_sensitivity)     SET r.policy_sensitivity = $pol"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 167,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n:Entity)     WHERE ANY(prop IN keys(n) WHERE n[prop] =~ $pattern)     AND NOT n.policy_"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 187,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n:Entity)     WHERE ANY(prop IN keys(n) WHERE toString(n[prop]) =~ $pattern)     AND NOT"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 216,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE NOT EXISTS(n.policy_owner)     SET n.policy_owner = CASE       WHEN n:Inves"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 241,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "     MATCH (n)     WHERE n.policy_retention_days IS NOT NULL     AND n.policy_collection_date IS NOT"
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 348,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (n)       WHERE EXISTS(n.policy_sensitivity)       REMOVE n.policy_origin,             "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 371,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH ()-[r]->()       WHERE EXISTS(r.policy_sensitivity)       REMOVE r.policy_sensitivity, "
  },
  {
    "file": "migrations/002_neo4j_policy_tags.ts",
    "line": 419,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (n)       WHERE EXISTS(n.policy_sensitivity)       RETURN count(n) > 0 as migrated     "
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 160,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 167,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users"
  },
  {
    "file": "pii/examples/fullIntegration.ts",
    "line": 208,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "repos/CaseRepo.ts",
    "line": 167,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE maestro.cases SET ${updateFields.join("
  },
  {
    "file": "repos/CaseRepo.ts",
    "line": 208,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "DELETE FROM maestro.cases WHERE id = $1"
  },
  {
    "file": "repos/EntityRepo.ts",
    "line": 368,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            DETACH DELETE e"
  },
  {
    "file": "repos/RelationshipRepo.ts",
    "line": 380,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:REL {id: $id}]-()            DELETE r"
  },
  {
    "file": "resolvers/WargameResolver.ts",
    "line": 218,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (s:CrisisScenario {id: $id})          SET s.crisisType = $crisisType,              s.updatedAt"
  },
  {
    "file": "resolvers/WargameResolver.ts",
    "line": 249,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (s:CrisisScenario {id: $id}) DETACH DELETE s"
  },
  {
    "file": "resolvers/ai.ts",
    "line": 133,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a)-[r]->(b) WHERE r.snapshotId = $snapshotId RETURN a.id as u, b.id as v"
  },
  {
    "file": "routes/admin.js",
    "line": 17,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id, email, username, first_name, last_name, role, is_active, last_login FROM users ORDER BY c"
  },
  {
    "file": "routes/admin.js",
    "line": 45,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET role = $1 WHERE id = $2"
  },
  {
    "file": "routes/entities.js",
    "line": 74,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {uuid: $id}) RETURN e LIMIT 1"
  },
  {
    "file": "routes/entities.js",
    "line": 136,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {uuid: $id})        SET e.label = coalesce($label, e.label),            e.descriptio"
  },
  {
    "file": "routes/entities.js",
    "line": 164,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {uuid: $id}) DETACH DELETE e RETURN count(*) AS c"
  },
  {
    "file": "routes/graphragRoutes.js",
    "line": 229,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) SET e.embedding = $embedding, e.embeddingModel = $model, e.embeddingGener"
  },
  {
    "file": "routes/usage.ts",
    "line": 12,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "SELECT tenant, month, cpu_sec, gb_sec, egress_gb, runs FROM usage_counters WHERE month=$1 ORDER BY t"
  },
  {
    "file": "search/search.ts",
    "line": 107,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (c:Case) WHERE c.id IN $ids         OPTIONAL MATCH (c)-[:MENTIONS]->(i:IOC)         RETURN c.i"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 331,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) as total FROM users WHERE ${whereClause}"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 339,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE ${whereClause} ORDER BY created_at DESC LIMIT $${paramCount + 1} OFFSET $$"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 353,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 474,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET ${updates.join("
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 556,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET is_active = false, updated_at = NOW() WHERE id = $1"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 581,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET password_hash = $1, updated_at = NOW() WHERE id = $2"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 716,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT COUNT(*) as total FROM audit_logs WHERE ${whereClause}"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 724,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM audit_logs WHERE ${whereClause} ORDER BY timestamp DESC LIMIT $${paramCount + 1} OFFSE"
  },
  {
    "file": "services/AdminPanelService.ts",
    "line": 1079,
    "type": "SQL",
    "message": "Query accessing 'audit_logs' likely missing 'tenant_id' filter",
    "snippet": "       SELECT action, COUNT(*) as count       FROM audit_logs       WHERE timestamp > NOW() - INTERV"
  },
  {
    "file": "services/AdvancedAnalyticsService.js",
    "line": 1188,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:MultimodalEntity)         RETURN DISTINCT e.investigationId as investigationId    "
  },
  {
    "file": "services/AuthService.ts",
    "line": 269,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM users WHERE email = $1 OR username = $2"
  },
  {
    "file": "services/AuthService.ts",
    "line": 351,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE email = $1 AND is_active = true"
  },
  {
    "file": "services/AuthService.ts",
    "line": 367,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET last_login = CURRENT_TIMESTAMP WHERE id = $1"
  },
  {
    "file": "services/AuthService.ts",
    "line": 466,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1 AND is_active = true"
  },
  {
    "file": "services/AuthService.ts",
    "line": 525,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE id = $1 AND is_active = true"
  },
  {
    "file": "services/CacheWarmingService.ts",
    "line": 283,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:Investigation)         WHERE i.lastAccessedAt > datetime() - duration("
  },
  {
    "file": "services/EnterpriseSecurityService.js",
    "line": 1249,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "SELECT * FROM users WHERE username = $1"
  },
  {
    "file": "services/EntityLinkingService.js",
    "line": 25,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})          WHERE exists(e.embedding)          OPTIONAL MATCH (e)-[r]-"
  },
  {
    "file": "services/EntityLinkingService.js",
    "line": 40,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $entityId})          WHERE exists(e.embedding)          MATCH (candidate:Entity"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 31,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         OPTIONAL MATCH (e)-[r:RELATION"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 82,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e1:Entity {investigationId: $investigationId})         MATCH (e2:Entity {investigati"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 129,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         MATCH (e)-[r:RELATIONSHIP]-(ot"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 171,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity {id: $fromEntityId})         MATCH (end:Entity {id: $toEntityId})      "
  },
  {
    "file": "services/EntityModelService.js",
    "line": 212,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         MATCH (e)-[r:RELATIONSHIP]-(ot"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 258,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         OPTIONAL MATCH (e)-[r:RELATION"
  },
  {
    "file": "services/EntityModelService.js",
    "line": 305,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         // Check for orphaned relationships         OPTIONAL MATCH ()-[r:RELATIONSHIP]-()         W"
  },
  {
    "file": "services/EntityResolutionService.ts",
    "line": 72,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       WHERE e.name IS NOT NULL OR e.email IS NOT NULL OR e.url IS NOT NULL  "
  },
  {
    "file": "services/EntityResolutionService.ts",
    "line": 129,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       WHERE e.id IN $allEntityIds       SET e.canonicalId = $masterEntityId "
  },
  {
    "file": "services/EntityResolutionService.ts",
    "line": 139,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (n)-[r]->(d:Entity)       WHERE d.id IN $duplicateEntityIds       MATCH (m:Entity {id: "
  },
  {
    "file": "services/EntityResolutionService.ts",
    "line": 152,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (d:Entity)-[r]->(n)       WHERE d.id IN $duplicateEntityIds       MATCH (m:Entity {id: "
  },
  {
    "file": "services/EntityResolutionService.ts",
    "line": 165,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (d:Entity)       WHERE d.id IN $duplicateEntityIds       DETACH DELETE d     "
  },
  {
    "file": "services/GACoremetricsService.ts",
    "line": 337,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         WITH COUNT(e) as total,              COUNT(CASE WHEN e.name IS NOT"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 68,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity) WHERE $type IS NULL OR e.type = $type RETURN e LIMIT $limit"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 81,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (:Entity {id: $id})-[r:RELATIONSHIP]-(:Entity) RETURN r"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 113,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a:Entity {id: $fromId}), (b:Entity {id: $toId})              MERGE (a)-[rel:RELATIONSHIP {id:"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 132,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n:Entity {id: $id}) DETACH DELETE n"
  },
  {
    "file": "services/GraphStore.ts",
    "line": 143,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:RELATIONSHIP {id: $id}]-() DELETE r"
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 180,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CREATE (e:MultimodalEntity:Entity {           id: $id,           uuid: $uuid,           typ"
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 276,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (source:MultimodalEntity {id: $sourceId})         MATCH (target:MultimodalEntity {id:"
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 419,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (j:ExtractionJob {id: $jobId})         SET j.status = "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 430,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (j:ExtractionJob {id: $jobId})-[:PROCESSES]->(m:MediaSource)         MATCH (j)-[:FOR_"
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 475,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "             MATCH (j:ExtractionJob {id: $jobId})             SET j.progress = $progress           "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 494,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (j:ExtractionJob {id: $jobId})         SET j.status = "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 516,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (j:ExtractionJob {id: $jobId})         SET j.status = "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 595,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:MultimodalEntity {id: $entityId})         RETURN e       "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 619,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e1:MultimodalEntity {id: $entityId})         MATCH (e2:MultimodalEntity)         WHE"
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 817,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (i:Investigation {id: $investigationId})<-[:BELONGS_TO]-(e:MultimodalEntity)         "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 888,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (m:MediaSource)       WHERE m.id IN $mediaSourceIds       RETURN m     "
  },
  {
    "file": "services/MultimodalDataService.js",
    "line": 1011,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CREATE (p:ExtractionProvenance {           id: $id,           extractorName: $extractorName"
  },
  {
    "file": "services/OIDCAuthService.ts",
    "line": 645,
    "type": "SQL",
    "message": "Query accessing 'users' likely missing 'tenant_id' filter",
    "snippet": "UPDATE users SET is_active = false, updated_at = NOW() WHERE email = $1"
  },
  {
    "file": "services/PredictiveRelationshipService.ts",
    "line": 66,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) RETURN e"
  },
  {
    "file": "services/PredictiveRelationshipService.ts",
    "line": 198,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) SET e.embedding = $embedding"
  },
  {
    "file": "services/QueryPreviewService.ts",
    "line": 584,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         WITH DISTINCT labels(e) as ent"
  },
  {
    "file": "services/ReportingService.js",
    "line": 538,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (n) RETURN n LIMIT 1"
  },
  {
    "file": "services/ReportingService.js",
    "line": 539,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r]-() RETURN r LIMIT 1"
  },
  {
    "file": "services/SemanticSearchService.ts",
    "line": 77,
    "type": "SQL",
    "message": "Query accessing 'cases' likely missing 'tenant_id' filter",
    "snippet": "UPDATE cases SET embedding = $1::vector WHERE id = $2"
  },
  {
    "file": "services/SimulationEngineService.js",
    "line": 1158,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity)         WHERE n.investigation_id = $investigationId OR $investigationId IS"
  },
  {
    "file": "services/SimulationEngineService.js",
    "line": 1169,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a:Entity)-[r]->(b:Entity)         WHERE (a.investigation_id = $investigationId OR $i"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 119,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         CALL gds.pageRank.stream($graphName, {           maxIterations: 20,           dampingFactor"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 142,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 188,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         ${pathPattern}        "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 211,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 302,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 340,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.spannin"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 381,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 423,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity)         WHERE n.investigationId = $investigationId AND n.embedding IS NOT "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 446,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusIds         CALL apoc.path.subgraphNod"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 481,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 515,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.subgrap"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 541,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 573,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity)         WHERE start.id IN $focusNodeIds         CALL apoc.path.subgrap"
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 599,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (a)-[r]->(b)         WHERE a.id IN $nodeIds AND b.id IN $nodeIds         RETURN r.id "
  },
  {
    "file": "services/semantic-rag/GraphTraversalAlgorithms.ts",
    "line": 635,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (start:Entity), (end:Entity)       WHERE start.id IN $focusNodeIds AND end.id IN $targe"
  },
  {
    "file": "services/semantic-rag/HybridSemanticRetriever.ts",
    "line": 489,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (n:Entity)         WHERE n.id IN $nodeIds         OPTIONAL MATCH (n)-[r]-(m)         "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 417,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (a:Entity {stixId: $sourceRef}), (b:Entity {stixId: $targetRef})       MERGE (a)-[r:${r"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 458,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "       MATCH (e:Entity)       WHERE e.stixId IS NULL         ${investigationId ? "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 516,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (stix:Entity {stixId: $stixId}), (target:Entity {id: $nodeId})           MERGE (sti"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 549,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (start:Entity {id: $nodeId})         CALL apoc.path.subgraphNodes(start, {           "
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 639,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-(ioc:Entity:In"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 651,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-()-[:ATTRIBUTE"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 664,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         MATCH (e)<-[:IOC_CORRELATES]-()-[:ATTRIBUTE"
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 677,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity)         ${whereClause}         WITH COALESCE(e.threatScore, 0) + COALESCE("
  },
  {
    "file": "services/semantic-rag/STIXTAXIIFusionService.ts",
    "line": 704,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "         MATCH (e:Entity {investigationId: $investigationId})         WHERE e.killChainPhases IS NOT"
  },
  {
    "file": "services/ticket-links.ts",
    "line": 36,
    "type": "SQL",
    "message": "Query accessing 'runs' likely missing 'tenant_id' filter",
    "snippet": "SELECT id FROM runs WHERE id = $1"
  },
  {
    "file": "tests/entityModel.test.js",
    "line": 105,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id}) DELETE e"
  },
  {
    "file": "tests/entityModel.test.js",
    "line": 187,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e1:Entity {investigationId: $investigationId})           MATCH (e2:Entity {investi"
  },
  {
    "file": "tests/entityModel.test.js",
    "line": 215,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:Entity {investigationId: $investigationId})           OPTIONAL MATCH (e)-[r:RELA"
  },
  {
    "file": "tests/entityModel.test.js",
    "line": 295,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:Entity)           WHERE e.type = "
  },
  {
    "file": "tests/entityModel.test.js",
    "line": 315,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (e:Entity)           WHERE e.investigationId = "
  },
  {
    "file": "utils/sampleData.ts",
    "line": 108,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity) RETURN e LIMIT 5"
  },
  {
    "file": "utils/sampleData.ts",
    "line": 138,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "           MATCH (from:Entity {id: $from}), (to:Entity {id: $to})           MERGE (from)-[r:${rel.ty"
  },
  {
    "file": "workers/OutboxNeo4jSync.ts",
    "line": 245,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (e:Entity {id: $id})            DETACH DELETE e"
  },
  {
    "file": "workers/OutboxNeo4jSync.ts",
    "line": 321,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH ()-[r:REL {id: $id}]-()            DELETE r"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 22,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (a {id:$u}), (b {id:$v})                  MERGE (a)-[r:RELATED {source:"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 33,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "MATCH (x {id:$a}),(y {id:$b})                  MERGE (x)-[r:SAME_AS {source:"
  },
  {
    "file": "workers/approvedWriter.ts",
    "line": 43,
    "type": "Cypher",
    "message": "Cypher query likely missing 'tenantId' filter",
    "snippet": "UNWIND $members as m                  MATCH (n {id:m}) SET n.community=$cid"
  }
]