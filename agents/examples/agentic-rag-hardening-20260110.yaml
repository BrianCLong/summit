task_id: AGENTIC_RAG_HARDENING_20260110
agent_id: codex
prompt_ref:
  id: agent-native-loop-n4
  version: v1
  sha256: 2fcf3ef5535a5dd116439d1fc8a665e03945e1c6981373895fd9344bd486b658
  path: prompts/governance/agent-native-loop-n4.md
declared_scope:
  paths:
    - .lintstagedrc.json
    - packages/agentic-rag/
    - server/src/graphql/
    - server/db/migrations/
    - services/agentic-rag-worker/
    - docs/agentic-rag/
    - docs/roadmap/STATUS.json
    - agents/examples/
  domains:
    - rag
    - retrieval
    - observability
    - governance
allowed_operations:
  - create
  - edit
verification_requirements:
  tier: B
  artifacts:
    - tests:agentic-rag
    - checks:boundaries
    - smoke:golden-path
debt_budget:
  permitted: 0
  retirement_target: 0
success_criteria:
  - Agentic RAG retrieval uses pgvector with workspace and corpus version filters.
  - Cache keys incorporate normalized query and corpus version.
  - Worker queue uses BullMQ with retries, DLQ handling, and idempotency support.
  - Observability emits stage spans and job metrics.
stop_conditions:
  - Prompt hash mismatch detected.
  - Smoke tests fail in the golden path.
  - Governance scope violation detected.
dependencies:
  - prompts/registry.yaml
  - docs/SUMMIT_READINESS_ASSERTION.md
approvals:
  - governance-council
