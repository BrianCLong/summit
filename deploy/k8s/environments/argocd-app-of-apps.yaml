apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: intelgraph-environments
  namespace: argocd # Assuming ArgoCD is installed in 'argocd' namespace
spec:
  project: default
  source:
    repoURL: 'https://github.com/BrianCLong/intelgraph'
    path: deploy/k8s/environments # Path to your environment-specific Helm charts or K8s manifests
    targetRevision: HEAD
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: intelgraph # Target namespace for IntelGraph deployments
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true # Automatically create target namespace if it doesn't exist