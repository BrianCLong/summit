apiVersion: policy.sigstore.dev/v1beta1
kind: ClusterImagePolicy
metadata:
  name: summit-images-policy
spec:
  images:
    - glob: "ghcr.io/brianclong/summit*"
    - glob: "ghcr.io/brianclong/summit/*"
  authorities:
    - keyless:
        url: https://token.actions.githubusercontent.com
        identities:
          - issuer: https://token.actions.githubusercontent.com
            subjectRegExp: "^https://github.com/BrianCLong/summit/.+"
      attestations:
        - name: must-have-sbom
          predicateType: https://spdx.dev/Document
          policy:
            type: cue
            data: |
              predicateType: "https://spdx.dev/Document"
        - name: must-have-provenance
          predicateType: https://slsa.dev/provenance/v0.2
          policy:
            type: cue
            data: |
              predicateType: "https://slsa.dev/provenance/v0.2"
